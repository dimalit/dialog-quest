<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Proton: PPlotInteraction.cpp Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />



</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">Proton
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="dir_b4959094aa2649f063000bebf8111065.html">shared</a>      </li>
      <li class="navelem"><a class="el" href="dir_521b21c7babd0cdaa1da3fe32dcb0745.html">addons</a>      </li>
      <li class="navelem"><a class="el" href="dir_0667aa7f888c7ac6ad07a7319170dad7.html">pplot</a>      </li>
      <li class="navelem"><a class="el" href="dir_fafd7a5df67d865c852e0b24a10a40da.html">generic</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">PPlotInteraction.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="PPlotInteraction_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/***************************************************************************</span>
<a name="l00002"></a>00002 <span class="comment"> *                                                                         *</span>
<a name="l00003"></a>00003 <span class="comment"> *   Copyright notice:                                                     *</span>
<a name="l00004"></a>00004 <span class="comment"> *                                                                         *</span>
<a name="l00005"></a>00005 <span class="comment"> *   This is free Pier ware. You may do whatever you want with this code.  *</span>
<a name="l00006"></a>00006 <span class="comment"> *   You may cont(r)act me by email: pierphil@xs4all.nl                    *</span>
<a name="l00007"></a>00007 <span class="comment"> *                                                                         *</span>
<a name="l00008"></a>00008 <span class="comment"> ***************************************************************************/</span>
<a name="l00009"></a>00009 
<a name="l00010"></a>00010 <span class="preprocessor">#include &quot;<a class="code" href="PPlotInteraction_8h.html">PPlotInteraction.h</a>&quot;</span>
<a name="l00011"></a>00011 
<a name="l00012"></a>00012 <span class="preprocessor">#include &lt;stdio.h&gt;</span>
<a name="l00013"></a>00013 <span class="preprocessor">#include &lt;math.h&gt;</span>
<a name="l00014"></a>00014 
<a name="l00015"></a>00015 <span class="keyword">using namespace </span>std;
<a name="l00016"></a>00016 
<a name="l00017"></a><a class="code" href="PPlotInteraction_8cpp.html#ac840ed98914a9c3d2aa205a4c310778c">00017</a> <span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code" href="PPlotInteraction_8cpp.html#ac840ed98914a9c3d2aa205a4c310778c">kHitDistance</a> = (float)10.0;<span class="comment">//pixels</span>
<a name="l00018"></a>00018 
<a name="l00019"></a><a class="code" href="PPlotInteraction_8cpp.html#a33aee66444a9ef4d33fad8ab77633681">00019</a> <span class="keywordtype">float</span> <a class="code" href="PPlotInteraction_8cpp.html#a33aee66444a9ef4d33fad8ab77633681">pmax</a> (<span class="keywordtype">float</span> inX1, <span class="keywordtype">float</span> inX2) {
<a name="l00020"></a>00020   <span class="keywordflow">if</span> (inX1&gt;inX2) {
<a name="l00021"></a>00021     <span class="keywordflow">return</span> inX1;
<a name="l00022"></a>00022   }
<a name="l00023"></a>00023   <span class="keywordflow">return</span> inX2;
<a name="l00024"></a>00024 }
<a name="l00025"></a><a class="code" href="PPlotInteraction_8cpp.html#a8070faed4abaf4e68869559d2f74e234">00025</a> <span class="keywordtype">float</span> <a class="code" href="PPlotInteraction_8cpp.html#a8070faed4abaf4e68869559d2f74e234">pmin</a> (<span class="keywordtype">float</span> inX1, <span class="keywordtype">float</span> inX2) {
<a name="l00026"></a>00026   <span class="keywordflow">if</span> (inX1&lt;inX2) {
<a name="l00027"></a>00027     <span class="keywordflow">return</span> inX1;
<a name="l00028"></a>00028   }
<a name="l00029"></a>00029   <span class="keywordflow">return</span> inX2;
<a name="l00030"></a>00030 }
<a name="l00031"></a>00031 
<a name="l00032"></a><a class="code" href="classPMouseEvent.html#ade6bc6957d9dda26bd62ba73fb94698d">00032</a> <a class="code" href="classPMouseEvent.html#ade6bc6957d9dda26bd62ba73fb94698d">PMouseEvent::PMouseEvent</a> (<span class="keywordtype">int</span> inX, <span class="keywordtype">int</span> inY, <a class="code" href="classPMouseEvent.html#ae9d49b1b4c20987a855348f4525cb54a">EType</a> inType, <span class="keywordtype">int</span> inModifierKeys):
<a name="l00033"></a>00033   <a class="code" href="classPModifierKeys.html">PModifierKeys</a>(inModifierKeys),
<a name="l00034"></a>00034   mX(inX),
<a name="l00035"></a>00035   mY(inY),
<a name="l00036"></a>00036   mType(inType)
<a name="l00037"></a>00037 {
<a name="l00038"></a>00038 }
<a name="l00039"></a>00039 
<a name="l00040"></a><a class="code" href="classPKeyEvent.html#aa9b50a988aeb47ead50fd20d4f1b1775">00040</a> <a class="code" href="classPKeyEvent.html#aa9b50a988aeb47ead50fd20d4f1b1775">PKeyEvent::PKeyEvent</a> (<a class="code" href="classPKeyEvent.html#a611b83401235224853c16c811c38e744">EKey</a> inKey, <span class="keywordtype">int</span> inRepeatCount, <span class="keywordtype">int</span> inModifierKeys, <span class="keywordtype">char</span> inChar):
<a name="l00041"></a>00041   <a class="code" href="classPModifierKeys.html">PModifierKeys</a> (inModifierKeys),
<a name="l00042"></a>00042   mKey (inKey),
<a name="l00043"></a>00043   mChar (inChar),
<a name="l00044"></a>00044   mRepeatCount (inRepeatCount)
<a name="l00045"></a>00045 {
<a name="l00046"></a>00046 }
<a name="l00047"></a>00047 
<a name="l00048"></a><a class="code" href="classPPlotInteraction.html#ab45ba28a8449b88cd8285b55997cf52e">00048</a> <a class="code" href="classPPlotInteraction.html#ab45ba28a8449b88cd8285b55997cf52e">PPlotInteraction::PPlotInteraction</a> (<a class="code" href="classPPlot.html">PPlot</a> &amp;inPPlot):
<a name="l00049"></a>00049   mPPlot (inPPlot),
<a name="l00050"></a>00050   mIsEnabled (true)
<a name="l00051"></a>00051 {
<a name="l00052"></a>00052 }
<a name="l00053"></a>00053 
<a name="l00054"></a>00054 
<a name="l00055"></a><a class="code" href="classPZoomInteraction.html#aeb254d5bc6151ab07d0c88d50c51a7a1">00055</a> <a class="code" href="classPZoomInteraction.html#aeb254d5bc6151ab07d0c88d50c51a7a1">PZoomInteraction::PZoomInteraction</a> (<a class="code" href="classPPlot.html">PPlot</a> &amp;inPPlot):
<a name="l00056"></a>00056   <a class="code" href="classPPlotInteraction.html">PPlotInteraction</a> (inPPlot),
<a name="l00057"></a>00057   mDragging (false),
<a name="l00058"></a>00058   mZoomMode (kZoom_Region)
<a name="l00059"></a>00059 {
<a name="l00060"></a>00060   inPPlot.<a class="code" href="classPPlot.html#a470fc35ef0b237137b23a81e002bcffe">mPostDrawerList</a>.push_back (<span class="keyword">this</span>);
<a name="l00061"></a>00061 }
<a name="l00062"></a>00062 
<a name="l00063"></a><a class="code" href="classPZoomInteraction.html#a43f5cb54af1572febef3a4b25fb0a9ea">00063</a> <span class="keywordtype">bool</span> <a class="code" href="classPZoomInteraction.html#a43f5cb54af1572febef3a4b25fb0a9ea">PZoomInteraction::HandleMouseEvent</a> (<span class="keyword">const</span> <a class="code" href="classPMouseEvent.html">PMouseEvent</a> &amp;inEvent) {
<a name="l00064"></a>00064   <span class="keywordflow">if</span> (!<a class="code" href="classPZoomInteraction.html#aa5e8ac6f864892738d1a3ed82f2193c2">mDragging</a>) {
<a name="l00065"></a>00065     <span class="keywordflow">if</span> (inEvent.<a class="code" href="classPMouseEvent.html#aeb1af37fc8f4660916492543776bac90">IsMouseDown</a> ()) {
<a name="l00066"></a>00066       <span class="comment">/*      if (inEvent.IsOnlyShiftKeyDown ()) {</span>
<a name="l00067"></a>00067 <span class="comment">        DoZoomOut ();</span>
<a name="l00068"></a>00068 <span class="comment">        return true;</span>
<a name="l00069"></a>00069 <span class="comment">        }*/</span>
<a name="l00070"></a>00070       <span class="keywordflow">if</span> (inEvent.<a class="code" href="classPModifierKeys.html#a11570134abdae453e0395fe01098f4d0">HasModifierKeys</a> ()) {
<a name="l00071"></a>00071         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00072"></a>00072       }
<a name="l00073"></a>00073       <a class="code" href="classPZoomInteraction.html#aa5e8ac6f864892738d1a3ed82f2193c2">mDragging</a> = <span class="keyword">true</span>;
<a name="l00074"></a>00074       <a class="code" href="classPZoomInteraction.html#ad92fd009280c641a26b9cff3057958d1">mX1</a> = <a class="code" href="classPZoomInteraction.html#ac5bbee60b1322a7ec2f3416fbc343946">mX2</a> = inEvent.<a class="code" href="classPMouseEvent.html#a4ee9584d0d3ae8113d5aef1da9574e2c">mX</a>;
<a name="l00075"></a>00075       <a class="code" href="classPZoomInteraction.html#ad1d3075f7f8efbc04a3bb23ff91155c8">mY1</a> = <a class="code" href="classPZoomInteraction.html#aad41424de3e154b0d163a4b7154a3aa0">mY2</a> = inEvent.<a class="code" href="classPMouseEvent.html#ad71888fe4be5d8ab131ebfa072c65f32">mY</a>;
<a name="l00076"></a>00076       <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00077"></a>00077     }
<a name="l00078"></a>00078   }
<a name="l00079"></a>00079   <span class="keywordflow">else</span> {
<a name="l00080"></a>00080     <span class="keywordflow">if</span> (inEvent.<a class="code" href="classPMouseEvent.html#ad8054f212def7cd1c6d5392d943cffa7">IsMouseUp</a> ()) {
<a name="l00081"></a>00081       <span class="comment">// here we should zoom</span>
<a name="l00082"></a>00082 
<a name="l00083"></a>00083       <span class="keywordflow">if</span> (<a class="code" href="classPZoomInteraction.html#ad92fd009280c641a26b9cff3057958d1">mX1</a> == <a class="code" href="classPZoomInteraction.html#ac5bbee60b1322a7ec2f3416fbc343946">mX2</a> &amp;&amp; <a class="code" href="classPZoomInteraction.html#ad1d3075f7f8efbc04a3bb23ff91155c8">mY1</a> == <a class="code" href="classPZoomInteraction.html#aad41424de3e154b0d163a4b7154a3aa0">mY2</a>) {
<a name="l00084"></a>00084         <a class="code" href="classPZoomInteraction.html#aa5e8ac6f864892738d1a3ed82f2193c2">mDragging</a> = <span class="keyword">false</span>;
<a name="l00085"></a>00085         <a class="code" href="classPZoomInteraction.html#ab006f7305a9aace7d925b1eae926f607">DoZoomOut</a> ();
<a name="l00086"></a>00086         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00087"></a>00087         <span class="comment">//      return false;// emtpy area                                 </span>
<a name="l00088"></a>00088       }
<a name="l00089"></a>00089 
<a name="l00090"></a>00090       <a class="code" href="classPZoomInteraction.html#aaa35dea67cbe7669af5b03b2b0b95bea">DoZoomIn</a> ();
<a name="l00091"></a>00091       <a class="code" href="classPZoomInteraction.html#aa5e8ac6f864892738d1a3ed82f2193c2">mDragging</a> = <span class="keyword">false</span>;
<a name="l00092"></a>00092       <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00093"></a>00093     }
<a name="l00094"></a>00094     <span class="keywordflow">if</span> (inEvent.<a class="code" href="classPMouseEvent.html#a7c6436306dca220fdb41cf915aac4353">IsMouseMove</a> ()) {
<a name="l00095"></a>00095       <a class="code" href="classPZoomInteraction.html#ac5bbee60b1322a7ec2f3416fbc343946">mX2</a> = inEvent.<a class="code" href="classPMouseEvent.html#a4ee9584d0d3ae8113d5aef1da9574e2c">mX</a>;
<a name="l00096"></a>00096       <a class="code" href="classPZoomInteraction.html#aad41424de3e154b0d163a4b7154a3aa0">mY2</a> = inEvent.<a class="code" href="classPMouseEvent.html#ad71888fe4be5d8ab131ebfa072c65f32">mY</a>;
<a name="l00097"></a>00097       <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00098"></a>00098     }
<a name="l00099"></a>00099   }
<a name="l00100"></a>00100   <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00101"></a>00101 }
<a name="l00102"></a>00102 
<a name="l00103"></a><a class="code" href="classPZoomInteraction.html#a8249a266fc17f1b66877a7ebf15b6a2d">00103</a> <span class="keywordtype">bool</span> <a class="code" href="classPZoomInteraction.html#a8249a266fc17f1b66877a7ebf15b6a2d">PZoomInteraction::HandleKeyEvent</a> (<span class="keyword">const</span> <a class="code" href="classPKeyEvent.html">PKeyEvent</a> &amp;inEvent) {
<a name="l00104"></a>00104 
<a name="l00105"></a>00105   <span class="keywordflow">if</span> (inEvent.<a class="code" href="classPModifierKeys.html#af46622c73b66767f0ee2d35ac57e2d78">IsOnlyControlKeyDown</a> () &amp;&amp; inEvent.<a class="code" href="classPKeyEvent.html#afbfe35bb3e2b5540896abf2496764575">IsChar</a> ()) {
<a name="l00106"></a>00106     <span class="keywordflow">switch</span> (inEvent.<a class="code" href="classPKeyEvent.html#ac6cb8a160c9d0394d8bf7a9bc5c1c818">GetChar</a> ()) {
<a name="l00107"></a>00107     <span class="keywordflow">case</span> <span class="charliteral">&#39;r&#39;</span>:
<a name="l00108"></a>00108       <a class="code" href="classPZoomInteraction.html#ace209b530a86ad115c606bb86fd82bbf">mZoomMode</a> = <a class="code" href="classPZoomInteraction.html#ab6fd8a7b7e8558cebc621c54ee8b85e4a044f9d590083ae98d98949edd2528181">kZoom_Region</a>;
<a name="l00109"></a>00109       <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00110"></a>00110       <span class="keywordflow">break</span>;
<a name="l00111"></a>00111     <span class="keywordflow">case</span> <span class="charliteral">&#39;x&#39;</span>:
<a name="l00112"></a>00112       <a class="code" href="classPZoomInteraction.html#ace209b530a86ad115c606bb86fd82bbf">mZoomMode</a> = <a class="code" href="classPZoomInteraction.html#ab6fd8a7b7e8558cebc621c54ee8b85e4abff205e3e8c94403fd3ce161e8b0437a">kZoom_X</a>;
<a name="l00113"></a>00113       <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00114"></a>00114       <span class="keywordflow">break</span>;
<a name="l00115"></a>00115     <span class="keywordflow">case</span> <span class="charliteral">&#39;y&#39;</span>:
<a name="l00116"></a>00116       <a class="code" href="classPZoomInteraction.html#ace209b530a86ad115c606bb86fd82bbf">mZoomMode</a> = <a class="code" href="classPZoomInteraction.html#ab6fd8a7b7e8558cebc621c54ee8b85e4a4145e1b99b053fdce49304e513494ab3">kZoom_Y</a>;
<a name="l00117"></a>00117       <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00118"></a>00118       <span class="keywordflow">break</span>;
<a name="l00119"></a>00119     }
<a name="l00120"></a>00120   }
<a name="l00121"></a>00121   <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00122"></a>00122 };
<a name="l00123"></a>00123 
<a name="l00124"></a><a class="code" href="classPZoomInteraction.html#a432b73bca19263564fd254690778ba5a">00124</a> <span class="keywordtype">bool</span> <a class="code" href="classPZoomInteraction.html#a432b73bca19263564fd254690778ba5a">PZoomInteraction::Draw</a> (<a class="code" href="classPainter.html">Painter</a> &amp;inPainter) {
<a name="l00125"></a>00125   <span class="keywordflow">if</span> (<a class="code" href="classPZoomInteraction.html#aa5e8ac6f864892738d1a3ed82f2193c2">mDragging</a>) {
<a name="l00126"></a>00126     inPainter.<a class="code" href="classPainter.html#aaa8881085ef774e7921c3ffbeb32248b">SetLineColor</a> (255, 0, 0);
<a name="l00127"></a>00127 
<a name="l00128"></a>00128     <span class="keywordtype">float</span> theX1 = <a class="code" href="classPZoomInteraction.html#ad92fd009280c641a26b9cff3057958d1">mX1</a>;
<a name="l00129"></a>00129     <span class="keywordtype">float</span> theX2 = <a class="code" href="classPZoomInteraction.html#ac5bbee60b1322a7ec2f3416fbc343946">mX2</a>;
<a name="l00130"></a>00130     <span class="keywordtype">float</span> theY1 = <a class="code" href="classPZoomInteraction.html#ad1d3075f7f8efbc04a3bb23ff91155c8">mY1</a>;
<a name="l00131"></a>00131     <span class="keywordtype">float</span> theY2 = <a class="code" href="classPZoomInteraction.html#aad41424de3e154b0d163a4b7154a3aa0">mY2</a>;
<a name="l00132"></a>00132 
<a name="l00133"></a>00133     <span class="keywordtype">bool</span> theDrawInverse = <span class="keyword">true</span>;
<a name="l00134"></a>00134 
<a name="l00135"></a>00135     <span class="keywordflow">switch</span> (<a class="code" href="classPZoomInteraction.html#ace209b530a86ad115c606bb86fd82bbf">mZoomMode</a>) {
<a name="l00136"></a>00136     <span class="keywordflow">case</span> <a class="code" href="classPZoomInteraction.html#ab6fd8a7b7e8558cebc621c54ee8b85e4a044f9d590083ae98d98949edd2528181">kZoom_Region</a>:
<a name="l00137"></a>00137       <span class="comment">//      theDrawInverse = false;</span>
<a name="l00138"></a>00138       <span class="keywordflow">break</span>;
<a name="l00139"></a>00139     <span class="keywordflow">case</span> <a class="code" href="classPZoomInteraction.html#ab6fd8a7b7e8558cebc621c54ee8b85e4abff205e3e8c94403fd3ce161e8b0437a">kZoom_X</a>:
<a name="l00140"></a>00140       theY1 = <a class="code" href="classPPlotInteraction.html#a4c526bbe9d1a60f1c0e2a674002cd1d1">mPPlot</a>.<a class="code" href="classPPlot.html#a5e2eb998aba1b7503ed93e247c691e3c">mMargins</a>.<a class="code" href="classPMargins.html#a403f340bcf5bb99b4088cb2fbf635fe1">mTop</a>;
<a name="l00141"></a>00141       theY2 = inPainter.<a class="code" href="classPainter.html#aacb92ddd72b057630080764e23066eb5">GetHeight</a> ()-<a class="code" href="classPPlotInteraction.html#a4c526bbe9d1a60f1c0e2a674002cd1d1">mPPlot</a>.<a class="code" href="classPPlot.html#a5e2eb998aba1b7503ed93e247c691e3c">mMargins</a>.<a class="code" href="classPMargins.html#a855bd94f4df953e133f7c09e58e098af">mBottom</a>;
<a name="l00142"></a>00142       <span class="keywordflow">break</span>;
<a name="l00143"></a>00143     <span class="keywordflow">case</span> <a class="code" href="classPZoomInteraction.html#ab6fd8a7b7e8558cebc621c54ee8b85e4a4145e1b99b053fdce49304e513494ab3">kZoom_Y</a>:
<a name="l00144"></a>00144       theX1 = <a class="code" href="classPPlotInteraction.html#a4c526bbe9d1a60f1c0e2a674002cd1d1">mPPlot</a>.<a class="code" href="classPPlot.html#a5e2eb998aba1b7503ed93e247c691e3c">mMargins</a>.<a class="code" href="classPMargins.html#aa07b1106be37d89bc5d5c339822f3a9a">mLeft</a>;
<a name="l00145"></a>00145       theX2 = inPainter.<a class="code" href="classPainter.html#a1e01c507cde81d740544abce63abf23a">GetWidth</a> ()-<a class="code" href="classPPlotInteraction.html#a4c526bbe9d1a60f1c0e2a674002cd1d1">mPPlot</a>.<a class="code" href="classPPlot.html#a5e2eb998aba1b7503ed93e247c691e3c">mMargins</a>.<a class="code" href="classPMargins.html#a326cf40b07b19a484d776de184c1de0d">mRight</a>;
<a name="l00146"></a>00146       <span class="keywordflow">break</span>;
<a name="l00147"></a>00147     }
<a name="l00148"></a>00148 
<a name="l00149"></a>00149     <span class="comment">// draw rectangle</span>
<a name="l00150"></a>00150     inPainter.<a class="code" href="classPainter.html#af0a3c8557b5f77732e0712c2723edc71">DrawLine</a> (theX1, theY1, theX2, theY1);
<a name="l00151"></a>00151     inPainter.<a class="code" href="classPainter.html#af0a3c8557b5f77732e0712c2723edc71">DrawLine</a> (theX2, theY1, theX2, theY2);
<a name="l00152"></a>00152     inPainter.<a class="code" href="classPainter.html#af0a3c8557b5f77732e0712c2723edc71">DrawLine</a> (theX2, theY2, theX1, theY2);
<a name="l00153"></a>00153     inPainter.<a class="code" href="classPainter.html#af0a3c8557b5f77732e0712c2723edc71">DrawLine</a> (theX1, theY2, theX1, theY1);
<a name="l00154"></a>00154 
<a name="l00155"></a>00155     <span class="keywordflow">if</span> (theDrawInverse) {
<a name="l00156"></a>00156       <span class="keywordtype">float</span> theX = <a class="code" href="PPlotInteraction_8cpp.html#a8070faed4abaf4e68869559d2f74e234">pmin</a> (theX1, theX2); 
<a name="l00157"></a>00157       <span class="keywordtype">float</span> theY = <a class="code" href="PPlotInteraction_8cpp.html#a8070faed4abaf4e68869559d2f74e234">pmin</a> (theY1, theY2); 
<a name="l00158"></a>00158       <span class="keywordtype">float</span> theW = fabs (theX1-theX2);
<a name="l00159"></a>00159       <span class="keywordtype">float</span> theH = fabs (theY1-theY2);
<a name="l00160"></a>00160       inPainter.<a class="code" href="classPainter.html#ae20ecb257dd533f3a396d4a6f3802f5e">InvertRect</a> (theX, theY, theW, theH);
<a name="l00161"></a>00161     }
<a name="l00162"></a>00162   }
<a name="l00163"></a>00163   <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00164"></a>00164   
<a name="l00165"></a>00165 }
<a name="l00166"></a>00166 
<a name="l00167"></a><a class="code" href="classPZoomInteraction.html#ae77f343a58597ab47af2ca5247d49d55">00167</a> <span class="keywordtype">bool</span> <a class="code" href="classPZoomInteraction.html#ae77f343a58597ab47af2ca5247d49d55">PZoomInteraction::CheckRange</a> (<span class="keywordtype">float</span> inFloat1, <span class="keywordtype">float</span> inFloat2) {
<a name="l00168"></a>00168     <span class="keywordflow">if</span> (fabs(inFloat1-inFloat2) &lt; 1e-5) {
<a name="l00169"></a>00169         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00170"></a>00170     }
<a name="l00171"></a>00171     <span class="keywordtype">int</span> abs1 = (int) log10(fabs (inFloat1));
<a name="l00172"></a>00172     <span class="keywordtype">int</span> abs2 = (int) log10(fabs (inFloat2));
<a name="l00173"></a>00173     <span class="keywordflow">if</span> ( abs1 == abs2) {
<a name="l00174"></a>00174         <span class="keywordtype">float</span> theVal1 = (inFloat1 / pow (10, (<span class="keywordtype">double</span>)abs1));
<a name="l00175"></a>00175         <span class="keywordtype">float</span> theVal2 = (inFloat2 / pow (10, (<span class="keywordtype">double</span>)abs2));
<a name="l00176"></a>00176         <span class="keywordtype">float</span> theValDif = fabs(theVal1  - theVal2);
<a name="l00177"></a>00177         <span class="keywordflow">if</span> (theValDif &lt; 1e-5) {
<a name="l00178"></a>00178             <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00179"></a>00179         }
<a name="l00180"></a>00180     }
<a name="l00181"></a>00181     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00182"></a>00182 }
<a name="l00183"></a>00183 
<a name="l00184"></a>00184 <span class="comment">// hmmm... copied from PPlot.cpp</span>
<a name="l00185"></a><a class="code" href="classPZoomInteraction.html#a0b1bfb77ca8f35d30dfd88116825c24e">00185</a> <span class="keywordtype">void</span> <a class="code" href="classPZoomInteraction.html#aaa35dea67cbe7669af5b03b2b0b95bea">PZoomInteraction::DoZoomIn</a> (<span class="keywordtype">float</span> inX1, <span class="keywordtype">float</span> inX2, <span class="keywordtype">float</span> inY1, <span class="keywordtype">float</span> inY2) {
<a name="l00186"></a>00186     <span class="keywordflow">if</span> (!<a class="code" href="classPZoomInteraction.html#ae77f343a58597ab47af2ca5247d49d55">CheckRange</a> (inX1, inX2)) {
<a name="l00187"></a>00187         <span class="keywordflow">return</span>;
<a name="l00188"></a>00188     }
<a name="l00189"></a>00189     <span class="keywordflow">if</span> (!<a class="code" href="classPZoomInteraction.html#ae77f343a58597ab47af2ca5247d49d55">CheckRange</a> (inY1, inY2)) {
<a name="l00190"></a>00190         <span class="keywordflow">return</span>;
<a name="l00191"></a>00191     }
<a name="l00192"></a>00192     <span class="comment">// also use the following criterium that is used in PPlot::CalculateTickInfo to </span>
<a name="l00193"></a>00193     <span class="comment">// avoid strange zoom in / zoom out behaviour</span>
<a name="l00194"></a>00194     <span class="keywordtype">float</span> theYRange = fabs (inY1 - inY2);
<a name="l00195"></a>00195     <span class="keywordtype">float</span> theYMax = (inY1 &gt; inY2) ? inY1 : inY2;
<a name="l00196"></a>00196     <span class="keywordflow">if</span> (fabs (theYRange / theYMax) &lt; <a class="code" href="classPPlot.html#ac1f40885cf6c56a4e0457ac560a2bc5b">PPlot::kRangeVerySmall</a>) {
<a name="l00197"></a>00197         <span class="keywordflow">return</span>;
<a name="l00198"></a>00198     }
<a name="l00199"></a>00199 
<a name="l00200"></a>00200     <a class="code" href="classPZoomInteraction.html#afe54d522ff76b1c9bcfaec72b401b656">StoreCurrentAxisSetup</a> ();
<a name="l00201"></a>00201 
<a name="l00202"></a>00202     <span class="keywordflow">if</span> (<a class="code" href="classPZoomInteraction.html#a93be771f8e8f3ebf1f7630ef7741a355">IsZoomRegion</a> () || <a class="code" href="classPZoomInteraction.html#a63f57040ddd6c038e8e3422b1548902e">IsZoomX</a> ()) {
<a name="l00203"></a>00203       <a class="code" href="classPPlotInteraction.html#a4c526bbe9d1a60f1c0e2a674002cd1d1">mPPlot</a>.<a class="code" href="classPPlot.html#a8c8e006743360c6ee72b80df851a2382">mXAxisSetup</a>.<a class="code" href="classAxisSetup.html#ac41e38235faa31a925a0d4926c116c8e">SetAutoScale</a> (<span class="keyword">false</span>);
<a name="l00204"></a>00204       <a class="code" href="classPPlotInteraction.html#a4c526bbe9d1a60f1c0e2a674002cd1d1">mPPlot</a>.<a class="code" href="classPPlot.html#a8c8e006743360c6ee72b80df851a2382">mXAxisSetup</a>.<a class="code" href="classAxisSetup.html#a4d6232493b0a03b333db3dae5f1535ec">mMin</a> = <a class="code" href="PPlotInteraction_8cpp.html#a8070faed4abaf4e68869559d2f74e234">pmin</a> (inX1, inX2);
<a name="l00205"></a>00205       <a class="code" href="classPPlotInteraction.html#a4c526bbe9d1a60f1c0e2a674002cd1d1">mPPlot</a>.<a class="code" href="classPPlot.html#a8c8e006743360c6ee72b80df851a2382">mXAxisSetup</a>.<a class="code" href="classAxisSetup.html#a7ddb04dbf49d93bca240ca29659e29cb">mMax</a> = <a class="code" href="PPlotInteraction_8cpp.html#a33aee66444a9ef4d33fad8ab77633681">pmax</a> (inX1, inX2);
<a name="l00206"></a>00206     }
<a name="l00207"></a>00207     <span class="keywordflow">if</span> (<a class="code" href="classPZoomInteraction.html#a93be771f8e8f3ebf1f7630ef7741a355">IsZoomRegion</a> () || <a class="code" href="classPZoomInteraction.html#a02f55052d99b7ca17fcda8df73d21d44">IsZoomY</a> ()) {
<a name="l00208"></a>00208       <a class="code" href="classPPlotInteraction.html#a4c526bbe9d1a60f1c0e2a674002cd1d1">mPPlot</a>.<a class="code" href="classPPlot.html#a7a0c89f134eb258ec850368b751983e5">mYAxisSetup</a>.<a class="code" href="classAxisSetup.html#ac41e38235faa31a925a0d4926c116c8e">SetAutoScale</a> (<span class="keyword">false</span>);
<a name="l00209"></a>00209       <a class="code" href="classPPlotInteraction.html#a4c526bbe9d1a60f1c0e2a674002cd1d1">mPPlot</a>.<a class="code" href="classPPlot.html#a7a0c89f134eb258ec850368b751983e5">mYAxisSetup</a>.<a class="code" href="classAxisSetup.html#a4d6232493b0a03b333db3dae5f1535ec">mMin</a> = <a class="code" href="PPlotInteraction_8cpp.html#a8070faed4abaf4e68869559d2f74e234">pmin</a> (inY1, inY2);
<a name="l00210"></a>00210       <a class="code" href="classPPlotInteraction.html#a4c526bbe9d1a60f1c0e2a674002cd1d1">mPPlot</a>.<a class="code" href="classPPlot.html#a7a0c89f134eb258ec850368b751983e5">mYAxisSetup</a>.<a class="code" href="classAxisSetup.html#a7ddb04dbf49d93bca240ca29659e29cb">mMax</a> = <a class="code" href="PPlotInteraction_8cpp.html#a33aee66444a9ef4d33fad8ab77633681">pmax</a> (inY1, inY2);
<a name="l00211"></a>00211     }
<a name="l00212"></a>00212 
<a name="l00213"></a>00213     <span class="keywordflow">return</span>;
<a name="l00214"></a>00214 }
<a name="l00215"></a>00215 
<a name="l00216"></a><a class="code" href="classPZoomInteraction.html#afe54d522ff76b1c9bcfaec72b401b656">00216</a> <span class="keywordtype">void</span> <a class="code" href="classPZoomInteraction.html#afe54d522ff76b1c9bcfaec72b401b656">PZoomInteraction::StoreCurrentAxisSetup</a> () {
<a name="l00217"></a>00217   <a class="code" href="classPAxisInfo.html">PAxisInfo</a> theInfo;<span class="comment">// store the current axis setup</span>
<a name="l00218"></a>00218 
<a name="l00219"></a>00219   theInfo.<a class="code" href="classPAxisInfo.html#a6e7ccc24a6dc712832675179493aed95">mXAxisSetup</a> = <a class="code" href="classPPlotInteraction.html#a4c526bbe9d1a60f1c0e2a674002cd1d1">mPPlot</a>.<a class="code" href="classPPlot.html#a8c8e006743360c6ee72b80df851a2382">mXAxisSetup</a>;
<a name="l00220"></a>00220   theInfo.<a class="code" href="classPAxisInfo.html#a12eeea047b9799de4f8c182a3b2fb560">mYAxisSetup</a> = <a class="code" href="classPPlotInteraction.html#a4c526bbe9d1a60f1c0e2a674002cd1d1">mPPlot</a>.<a class="code" href="classPPlot.html#a7a0c89f134eb258ec850368b751983e5">mYAxisSetup</a>;
<a name="l00221"></a>00221 
<a name="l00222"></a>00222   <a class="code" href="classPZoomInteraction.html#a7c349cc0740480584e30a07231bd19f4">mZoomHistory</a>.push (theInfo);
<a name="l00223"></a>00223 }
<a name="l00224"></a>00224 
<a name="l00225"></a><a class="code" href="classPZoomInteraction.html#aaa35dea67cbe7669af5b03b2b0b95bea">00225</a> <span class="keywordtype">void</span> <a class="code" href="classPZoomInteraction.html#aaa35dea67cbe7669af5b03b2b0b95bea">PZoomInteraction::DoZoomIn</a> () {
<a name="l00226"></a>00226   <span class="keywordtype">float</span> theX1 = <a class="code" href="classPPlotInteraction.html#a4c526bbe9d1a60f1c0e2a674002cd1d1">mPPlot</a>.<a class="code" href="classPPlot.html#a2621cb67e855d1ba8cb2e30a5660bf4b">mXTrafo</a>-&gt;<a class="code" href="classTrafo.html#a123aaa7d4f7a385b02d7184cf969197c">TransformBack</a> (<a class="code" href="classPZoomInteraction.html#ad92fd009280c641a26b9cff3057958d1">mX1</a>);
<a name="l00227"></a>00227   <span class="keywordtype">float</span> theX2 = <a class="code" href="classPPlotInteraction.html#a4c526bbe9d1a60f1c0e2a674002cd1d1">mPPlot</a>.<a class="code" href="classPPlot.html#a2621cb67e855d1ba8cb2e30a5660bf4b">mXTrafo</a>-&gt;<a class="code" href="classTrafo.html#a123aaa7d4f7a385b02d7184cf969197c">TransformBack</a> (<a class="code" href="classPZoomInteraction.html#ac5bbee60b1322a7ec2f3416fbc343946">mX2</a>);
<a name="l00228"></a>00228   <span class="keywordtype">float</span> theY1 = <a class="code" href="classPPlotInteraction.html#a4c526bbe9d1a60f1c0e2a674002cd1d1">mPPlot</a>.<a class="code" href="classPPlot.html#aa1718f3b38e95414b90edc8c56fd1942">mYTrafo</a>-&gt;<a class="code" href="classTrafo.html#a123aaa7d4f7a385b02d7184cf969197c">TransformBack</a> (<a class="code" href="classPZoomInteraction.html#ad1d3075f7f8efbc04a3bb23ff91155c8">mY1</a>);
<a name="l00229"></a>00229   <span class="keywordtype">float</span> theY2 = <a class="code" href="classPPlotInteraction.html#a4c526bbe9d1a60f1c0e2a674002cd1d1">mPPlot</a>.<a class="code" href="classPPlot.html#aa1718f3b38e95414b90edc8c56fd1942">mYTrafo</a>-&gt;<a class="code" href="classTrafo.html#a123aaa7d4f7a385b02d7184cf969197c">TransformBack</a> (<a class="code" href="classPZoomInteraction.html#aad41424de3e154b0d163a4b7154a3aa0">mY2</a>);
<a name="l00230"></a>00230 
<a name="l00231"></a>00231   <a class="code" href="classPZoomInteraction.html#aaa35dea67cbe7669af5b03b2b0b95bea">DoZoomIn</a> (theX1, theX2, theY1, theY2);
<a name="l00232"></a>00232 };
<a name="l00233"></a>00233 
<a name="l00234"></a>00234 <span class="comment">// arguments allow us to zoom out in X direction but change the Y-axis</span>
<a name="l00235"></a><a class="code" href="classPZoomInteraction.html#ab006f7305a9aace7d925b1eae926f607">00235</a> <span class="keywordtype">void</span> <a class="code" href="classPZoomInteraction.html#ab006f7305a9aace7d925b1eae926f607">PZoomInteraction::DoZoomOut</a> (<span class="keywordtype">float</span> inY1, <span class="keywordtype">float</span> inY2) {
<a name="l00236"></a>00236   <span class="keywordflow">if</span> (<a class="code" href="classPZoomInteraction.html#a7c349cc0740480584e30a07231bd19f4">mZoomHistory</a>.size () == 0) {
<a name="l00237"></a>00237     <span class="keywordflow">return</span>;
<a name="l00238"></a>00238   }
<a name="l00239"></a>00239   <a class="code" href="classPAxisInfo.html">PAxisInfo</a> theInfo = <a class="code" href="classPZoomInteraction.html#a7c349cc0740480584e30a07231bd19f4">mZoomHistory</a>.top ();
<a name="l00240"></a>00240   <a class="code" href="classPZoomInteraction.html#a7c349cc0740480584e30a07231bd19f4">mZoomHistory</a>.pop ();
<a name="l00241"></a>00241 
<a name="l00242"></a>00242   <a class="code" href="classPPlotInteraction.html#a4c526bbe9d1a60f1c0e2a674002cd1d1">mPPlot</a>.<a class="code" href="classPPlot.html#a8c8e006743360c6ee72b80df851a2382">mXAxisSetup</a> = theInfo.<a class="code" href="classPAxisInfo.html#a6e7ccc24a6dc712832675179493aed95">mXAxisSetup</a>;
<a name="l00243"></a>00243   <span class="keywordflow">if</span> (inY1 != -1) {
<a name="l00244"></a>00244     <a class="code" href="classPPlotInteraction.html#a4c526bbe9d1a60f1c0e2a674002cd1d1">mPPlot</a>.<a class="code" href="classPPlot.html#a7a0c89f134eb258ec850368b751983e5">mYAxisSetup</a>.<a class="code" href="classAxisSetup.html#a4d6232493b0a03b333db3dae5f1535ec">mMin</a> = <a class="code" href="PPlotInteraction_8cpp.html#a8070faed4abaf4e68869559d2f74e234">pmin</a> (inY1, inY2);
<a name="l00245"></a>00245     <a class="code" href="classPPlotInteraction.html#a4c526bbe9d1a60f1c0e2a674002cd1d1">mPPlot</a>.<a class="code" href="classPPlot.html#a7a0c89f134eb258ec850368b751983e5">mYAxisSetup</a>.<a class="code" href="classAxisSetup.html#a7ddb04dbf49d93bca240ca29659e29cb">mMax</a> = <a class="code" href="PPlotInteraction_8cpp.html#a33aee66444a9ef4d33fad8ab77633681">pmax</a> (inY1, inY2);
<a name="l00246"></a>00246   } <span class="keywordflow">else</span> {
<a name="l00247"></a>00247     <a class="code" href="classPPlotInteraction.html#a4c526bbe9d1a60f1c0e2a674002cd1d1">mPPlot</a>.<a class="code" href="classPPlot.html#a7a0c89f134eb258ec850368b751983e5">mYAxisSetup</a> = theInfo.<a class="code" href="classPAxisInfo.html#a12eeea047b9799de4f8c182a3b2fb560">mYAxisSetup</a>;
<a name="l00248"></a>00248   }
<a name="l00249"></a>00249 }
<a name="l00250"></a>00250 
<a name="l00251"></a><a class="code" href="classPSelectionInteraction.html#ae2aa1dfe155a79f1166685f07e8d3486">00251</a> <a class="code" href="classPSelectionInteraction.html#ae2aa1dfe155a79f1166685f07e8d3486">PSelectionInteraction::PSelectionInteraction</a> (<a class="code" href="classPPlot.html">PPlot</a> &amp;inPPlot):
<a name="l00252"></a>00252   <a class="code" href="classPPlotInteraction.html">PPlotInteraction</a> (inPPlot),
<a name="l00253"></a>00253   mCommand (kNone),
<a name="l00254"></a>00254   mListener (0)
<a name="l00255"></a>00255 {
<a name="l00256"></a>00256   inPPlot.<a class="code" href="classPPlot.html#a3772f88d26cd9b18a632281836b4a4fa">mPostCalculatorList</a>.push_back (<span class="keyword">this</span>);
<a name="l00257"></a>00257 }
<a name="l00258"></a>00258 
<a name="l00259"></a>00259 
<a name="l00260"></a><a class="code" href="classPSelectionInteraction.html#a6e6cdd8db99eb2c359b4fe5b09add354">00260</a> <span class="keywordtype">bool</span> <a class="code" href="classPSelectionInteraction.html#a6e6cdd8db99eb2c359b4fe5b09add354">PSelectionInteraction::HandleKeyEvent</a> (<span class="keyword">const</span> <a class="code" href="classPKeyEvent.html">PKeyEvent</a> &amp;inEvent) {
<a name="l00261"></a>00261 
<a name="l00262"></a>00262   <a class="code" href="classPSelectionInteraction.html#ac2c3c222283f46d8b3f59c395ab8c909">mCommand</a> = <a class="code" href="classPSelectionInteraction.html#ac2b801fac83aea3216f877219b308ff0a5c0b5bfcf71da10dc296de497860aa5f">kNone</a>;
<a name="l00263"></a>00263   <span class="keywordflow">if</span> (inEvent.<a class="code" href="classPModifierKeys.html#af46622c73b66767f0ee2d35ac57e2d78">IsOnlyControlKeyDown</a> () &amp;&amp; inEvent.<a class="code" href="classPKeyEvent.html#afbfe35bb3e2b5540896abf2496764575">IsChar</a> () &amp;&amp; inEvent.<a class="code" href="classPKeyEvent.html#ac6cb8a160c9d0394d8bf7a9bc5c1c818">GetChar</a> () == <span class="charliteral">&#39;a&#39;</span>) {
<a name="l00264"></a>00264 <span class="comment">//    mCalculate = true;</span>
<a name="l00265"></a>00265     <a class="code" href="classPSelectionInteraction.html#ac2c3c222283f46d8b3f59c395ab8c909">mCommand</a> = <a class="code" href="classPSelectionInteraction.html#ac2b801fac83aea3216f877219b308ff0ad7423452d0a5bb33035cad0eb25d961d">kSelectAll</a>;
<a name="l00266"></a>00266     <a class="code" href="classPSelectionInteraction.html#aea553f40458441cc690cb7aa859f283d">mKeyEvent</a> = inEvent;
<a name="l00267"></a>00267   }
<a name="l00268"></a>00268   <span class="keywordflow">return</span> <a class="code" href="classPSelectionInteraction.html#ac2c3c222283f46d8b3f59c395ab8c909">mCommand</a> != <a class="code" href="classPSelectionInteraction.html#ac2b801fac83aea3216f877219b308ff0a5c0b5bfcf71da10dc296de497860aa5f">kNone</a>;
<a name="l00269"></a>00269 };
<a name="l00270"></a>00270 
<a name="l00271"></a><a class="code" href="classPSelectionInteraction.html#a47906714d398bd852c545a33856cf660">00271</a> <span class="keywordtype">void</span> <a class="code" href="classPSelectionInteraction.html#a47906714d398bd852c545a33856cf660">PSelectionInteraction::SelectAll</a> (<a class="code" href="classPlotDataBase.html">PlotDataBase</a> *inYData, <a class="code" href="classPlotDataSelection.html">PlotDataSelection</a> *inPlotDataSelection) {
<a name="l00272"></a>00272   <span class="keywordflow">for</span> (<span class="keywordtype">long</span> theI=0;theI&lt;inPlotDataSelection-&gt;size ();theI++) {
<a name="l00273"></a>00273     (*inPlotDataSelection)[theI] = <span class="keyword">true</span>;
<a name="l00274"></a>00274   }
<a name="l00275"></a>00275 }
<a name="l00276"></a>00276 
<a name="l00277"></a>00277 
<a name="l00278"></a><a class="code" href="classPSelectionInteraction.html#acd9240438aa05511d26e44d6dbda6c2f">00278</a> <span class="keywordtype">bool</span> <a class="code" href="classPSelectionInteraction.html#acd9240438aa05511d26e44d6dbda6c2f">PSelectionInteraction::HandleMouseEvent</a> (<span class="keyword">const</span> <a class="code" href="classPMouseEvent.html">PMouseEvent</a> &amp;inEvent) {
<a name="l00279"></a>00279 
<a name="l00280"></a>00280   <a class="code" href="classPSelectionInteraction.html#ac2c3c222283f46d8b3f59c395ab8c909">mCommand</a> = <a class="code" href="classPSelectionInteraction.html#ac2b801fac83aea3216f877219b308ff0a5c0b5bfcf71da10dc296de497860aa5f">kNone</a>;
<a name="l00281"></a>00281   <span class="keywordflow">if</span> (inEvent.<a class="code" href="classPMouseEvent.html#aeb1af37fc8f4660916492543776bac90">IsMouseDown</a> ()) {
<a name="l00282"></a>00282     <span class="keywordflow">if</span> (!(inEvent.<a class="code" href="classPModifierKeys.html#af46622c73b66767f0ee2d35ac57e2d78">IsOnlyControlKeyDown</a> () || inEvent.<a class="code" href="classPModifierKeys.html#a9529160742e62ead8c76c30c19fe5cd4">IsOnlyShiftKeyDown</a> ())) {
<a name="l00283"></a>00283       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00284"></a>00284     }
<a name="l00285"></a>00285     fprintf (stderr, <span class="stringliteral">&quot;selection\n&quot;</span>);
<a name="l00286"></a>00286 <span class="comment">//    mCalculate = true;</span>
<a name="l00287"></a>00287     <span class="keywordflow">if</span> (inEvent.<a class="code" href="classPModifierKeys.html#af46622c73b66767f0ee2d35ac57e2d78">IsOnlyControlKeyDown</a> ()) {
<a name="l00288"></a>00288       <a class="code" href="classPSelectionInteraction.html#ac2c3c222283f46d8b3f59c395ab8c909">mCommand</a> = <a class="code" href="classPSelectionInteraction.html#ac2b801fac83aea3216f877219b308ff0a8ca4ab8a95efdbd4b4365bbf20015932">kPointwiseSelection</a>;
<a name="l00289"></a>00289     }
<a name="l00290"></a>00290     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (inEvent.<a class="code" href="classPModifierKeys.html#a9529160742e62ead8c76c30c19fe5cd4">IsOnlyShiftKeyDown</a> ()) {
<a name="l00291"></a>00291       <a class="code" href="classPSelectionInteraction.html#ac2c3c222283f46d8b3f59c395ab8c909">mCommand</a> = <a class="code" href="classPSelectionInteraction.html#ac2b801fac83aea3216f877219b308ff0a8306829283721f2e4ecbf2c896d494c9">kGlobalSelection</a>;
<a name="l00292"></a>00292     }
<a name="l00293"></a>00293     <a class="code" href="classPSelectionInteraction.html#a333315ad4817bffe1ddef08334268873">mMouseEvent</a> = inEvent;
<a name="l00294"></a>00294     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00295"></a>00295   }
<a name="l00296"></a>00296   <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00297"></a>00297 }
<a name="l00298"></a>00298 
<a name="l00299"></a><a class="code" href="classPSelectionInteraction.html#a9f76c12099d2ff5e293f4b35d0abd2fa">00299</a> <span class="keywordtype">bool</span> <a class="code" href="classPSelectionInteraction.html#a9f76c12099d2ff5e293f4b35d0abd2fa">PSelectionInteraction::Calculate</a> (<a class="code" href="classPainter.html">Painter</a> &amp;inPainter, <a class="code" href="classPPlot.html">PPlot</a>&amp; inPPlot) {
<a name="l00300"></a>00300 
<a name="l00301"></a>00301   <span class="keywordflow">if</span> (<a class="code" href="classPSelectionInteraction.html#ac2c3c222283f46d8b3f59c395ab8c909">mCommand</a> == <a class="code" href="classPSelectionInteraction.html#ac2b801fac83aea3216f877219b308ff0a5c0b5bfcf71da10dc296de497860aa5f">kNone</a>) {
<a name="l00302"></a>00302     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00303"></a>00303   }
<a name="l00304"></a>00304 
<a name="l00305"></a>00305   <a class="code" href="classPlotDataContainer.html">PlotDataContainer</a> &amp;theContainer = inPPlot.<a class="code" href="classPPlot.html#ab277f0e326965064b6dcdb8874f39817">mPlotDataContainer</a>;
<a name="l00306"></a>00306   <span class="keywordtype">long</span> thePlotCount = theContainer.<a class="code" href="classPlotDataContainer.html#a9e05ff25bc9b7d3df438e69fb3d213b9">GetPlotCount</a> ();
<a name="l00307"></a>00307   <span class="keywordtype">float</span> theDist = -1;
<a name="l00308"></a>00308 
<a name="l00309"></a>00309   <span class="keywordflow">for</span> (<span class="keywordtype">long</span> theI=0;theI&lt;thePlotCount;theI++) {
<a name="l00310"></a>00310     <a class="code" href="classPlotDataBase.html">PlotDataBase</a> *theXData = theContainer.<a class="code" href="classPlotDataContainer.html#a682b8b22b7d86a294d9a3a7d61336b88">GetXData</a> (theI);
<a name="l00311"></a>00311     <a class="code" href="classPlotDataBase.html">PlotDataBase</a> *theYData = theContainer.<a class="code" href="classPlotDataContainer.html#a634f9d8edaa8a965b083a50fa79b947d">GetYData</a> (theI);
<a name="l00312"></a>00312     <a class="code" href="classDataDrawerBase.html">DataDrawerBase</a> *theDataDrawer = theContainer.<a class="code" href="classPlotDataContainer.html#a3875f1eb7846b0c2aca802824b1f1831">GetDataDrawer</a> (theI);
<a name="l00313"></a>00313     <a class="code" href="classPlotDataSelection.html">PlotDataSelection</a> *thePlotDataSelection = theContainer.<a class="code" href="classPlotDataContainer.html#ac4da7e57cbdb886c6424b766811aa0bc">GetPlotDataSelection</a> (theI);
<a name="l00314"></a>00314 
<a name="l00315"></a>00315 
<a name="l00316"></a>00316 
<a name="l00317"></a>00317     <span class="keywordtype">long</span> theNearestPointIndex;
<a name="l00318"></a>00318     <span class="keywordtype">float</span> theLocalDist = <a class="code" href="classPSelectionInteraction.html#a22750670fa8a1bfdfcd00617fc48cc0c">CalculateDistanceToPlot</a> (theXData, theYData, theNearestPointIndex);
<a name="l00319"></a>00319 
<a name="l00320"></a>00320     fprintf (stderr, <span class="stringliteral">&quot;dist %f\n&quot;</span>, theLocalDist);
<a name="l00321"></a>00321 
<a name="l00322"></a>00322     <span class="keywordtype">bool</span> theHit = theLocalDist &lt; <a class="code" href="PPlotInteraction_8cpp.html#ac840ed98914a9c3d2aa205a4c310778c">kHitDistance</a>;
<a name="l00323"></a>00323 
<a name="l00324"></a>00324     <span class="keywordflow">if</span> (<a class="code" href="classPSelectionInteraction.html#ac2c3c222283f46d8b3f59c395ab8c909">mCommand</a> == <a class="code" href="classPSelectionInteraction.html#ac2b801fac83aea3216f877219b308ff0a8ca4ab8a95efdbd4b4365bbf20015932">kPointwiseSelection</a>) {
<a name="l00325"></a>00325       <a class="code" href="classPSelectionInteraction.html#a41538c229897576436ed5b6e285201b5">HandlePointwiseInteraction</a> (theHit, theNearestPointIndex, theDataDrawer, thePlotDataSelection);
<a name="l00326"></a>00326     }
<a name="l00327"></a>00327     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classPSelectionInteraction.html#ac2c3c222283f46d8b3f59c395ab8c909">mCommand</a> == <a class="code" href="classPSelectionInteraction.html#ac2b801fac83aea3216f877219b308ff0a8306829283721f2e4ecbf2c896d494c9">kGlobalSelection</a>){
<a name="l00328"></a>00328       <a class="code" href="classPSelectionInteraction.html#ae4cd6b2372b429fc37ba12465845260f">HandleGlobalInteraction</a> (theHit, theNearestPointIndex, theDataDrawer, thePlotDataSelection);
<a name="l00329"></a>00329     }
<a name="l00330"></a>00330     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="classPSelectionInteraction.html#ac2c3c222283f46d8b3f59c395ab8c909">mCommand</a> == <a class="code" href="classPSelectionInteraction.html#ac2b801fac83aea3216f877219b308ff0ad7423452d0a5bb33035cad0eb25d961d">kSelectAll</a>) {
<a name="l00331"></a>00331       <a class="code" href="classPSelectionInteraction.html#a47906714d398bd852c545a33856cf660">SelectAll</a> (theYData, thePlotDataSelection);
<a name="l00332"></a>00332     }
<a name="l00333"></a>00333 
<a name="l00334"></a>00334     <span class="keywordflow">if</span> (theHit) {
<a name="l00335"></a>00335       fprintf (stderr, <span class="stringliteral">&quot;hit/n&quot;</span>);
<a name="l00336"></a>00336     }
<a name="l00337"></a>00337   }
<a name="l00338"></a>00338   <span class="keywordflow">if</span> (<a class="code" href="classPSelectionInteraction.html#adaba954c7a9b1e964b2ac29f87af1348">mListener</a>) {
<a name="l00339"></a>00339     <a class="code" href="classPSelectionInteraction.html#adaba954c7a9b1e964b2ac29f87af1348">mListener</a>-&gt;<a class="code" href="classPSelectionInteractionListener.html#a6570358ca396adcdec07c55c32c1ac81">HandlePSelectionInteraction</a> ();
<a name="l00340"></a>00340   }
<a name="l00341"></a>00341 
<a name="l00342"></a>00342   <a class="code" href="classPSelectionInteraction.html#ac2c3c222283f46d8b3f59c395ab8c909">mCommand</a> = <a class="code" href="classPSelectionInteraction.html#ac2b801fac83aea3216f877219b308ff0a5c0b5bfcf71da10dc296de497860aa5f">kNone</a>;
<a name="l00343"></a>00343 
<a name="l00344"></a>00344   <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00345"></a>00345 }
<a name="l00346"></a>00346 
<a name="l00347"></a><a class="code" href="classPSelectionInteraction.html#ae4cd6b2372b429fc37ba12465845260f">00347</a> <span class="keywordtype">void</span> <a class="code" href="classPSelectionInteraction.html#ae4cd6b2372b429fc37ba12465845260f">PSelectionInteraction::HandleGlobalInteraction</a> (<span class="keywordtype">bool</span> inHit, <span class="keywordtype">long</span> inNearestPointIndex, <a class="code" href="classDataDrawerBase.html">DataDrawerBase</a> *inDataDrawer, <a class="code" href="classPlotDataSelection.html">PlotDataSelection</a> *inPlotDataSelection) {
<a name="l00348"></a>00348     <a class="code" href="classLineDataDrawer.html">LineDataDrawer</a> *theLineDataDrawer = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classLineDataDrawer.html">LineDataDrawer</a> *<span class="keyword">&gt;</span>(inDataDrawer);
<a name="l00349"></a>00349     <span class="keywordflow">if</span> (theLineDataDrawer) {
<a name="l00350"></a>00350 <span class="comment">//      theLineDataDrawer-&gt;mDrawPoint = inHit;</span>
<a name="l00351"></a>00351     }
<a name="l00352"></a>00352     <span class="keywordflow">if</span> (inPlotDataSelection-&gt;size ()&gt;0) {
<a name="l00353"></a>00353       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> theI=0;theI&lt;inPlotDataSelection-&gt;size ();theI++) {
<a name="l00354"></a>00354         (*inPlotDataSelection)[theI] = inHit;
<a name="l00355"></a>00355       }
<a name="l00356"></a>00356     }
<a name="l00357"></a>00357 }
<a name="l00358"></a>00358 
<a name="l00359"></a><a class="code" href="classPSelectionInteraction.html#a41538c229897576436ed5b6e285201b5">00359</a> <span class="keywordtype">void</span> <a class="code" href="classPSelectionInteraction.html#a41538c229897576436ed5b6e285201b5">PSelectionInteraction::HandlePointwiseInteraction</a> (<span class="keywordtype">bool</span> inHit, <span class="keywordtype">long</span> inNearestPointIndex, <a class="code" href="classDataDrawerBase.html">DataDrawerBase</a> *inDataDrawer, <a class="code" href="classPlotDataSelection.html">PlotDataSelection</a> *inPlotDataSelection) {
<a name="l00360"></a>00360   <span class="keywordflow">if</span> (!inHit) {
<a name="l00361"></a>00361     <span class="keywordflow">return</span>;
<a name="l00362"></a>00362   }
<a name="l00363"></a>00363   <span class="keywordflow">if</span> (inPlotDataSelection-&gt;size ()&gt;inNearestPointIndex) {
<a name="l00364"></a>00364       <span class="keywordtype">bool</span> theWasHit = (*inPlotDataSelection)[inNearestPointIndex] !=0;
<a name="l00365"></a>00365       (*inPlotDataSelection)[inNearestPointIndex] = !theWasHit;
<a name="l00366"></a>00366       <span class="comment">/*</span>
<a name="l00367"></a>00367 <span class="comment">    for (int theI=0;theI&lt;inPlotDataSelection-&gt;size ();theI++) {</span>
<a name="l00368"></a>00368 <span class="comment">      bool theWasHit = (*inPlotDataSelection)[theI] !=0;</span>
<a name="l00369"></a>00369 <span class="comment">      bool theIsHit = false;</span>
<a name="l00370"></a>00370 <span class="comment">      if (theI==inNearestPointIndex) {</span>
<a name="l00371"></a>00371 <span class="comment">        theIsHit = !theWasHit;</span>
<a name="l00372"></a>00372 <span class="comment">      }</span>
<a name="l00373"></a>00373 <span class="comment">      (*inPlotDataSelection)[theI] = theIsHit;</span>
<a name="l00374"></a>00374 <span class="comment">      }*/</span>
<a name="l00375"></a>00375   }
<a name="l00376"></a>00376 }
<a name="l00377"></a>00377 
<a name="l00378"></a><a class="code" href="classPSelectionInteraction.html#a22750670fa8a1bfdfcd00617fc48cc0c">00378</a> <span class="keywordtype">float</span> <a class="code" href="classPSelectionInteraction.html#a22750670fa8a1bfdfcd00617fc48cc0c">PSelectionInteraction::CalculateDistanceToPlot</a> (<span class="keyword">const</span> <a class="code" href="classPlotDataBase.html">PlotDataBase</a> *inXData, <span class="keyword">const</span> <a class="code" href="classPlotDataBase.html">PlotDataBase</a> *inYData, <span class="keywordtype">long</span> &amp;outNearestPointIndex) {
<a name="l00379"></a>00379 
<a name="l00380"></a>00380 <span class="comment">//  const RealPlotData *theXData = inXData-&gt;GetRealPlotData ();</span>
<a name="l00381"></a>00381 <span class="comment">//  const RealPlotData *theYData = inYData-&gt;GetRealPlotData ();</span>
<a name="l00382"></a>00382   outNearestPointIndex = -1;
<a name="l00383"></a>00383   <span class="keywordtype">float</span> theDist = -1;
<a name="l00384"></a>00384   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> theI=0;theI&lt;inXData-&gt;<a class="code" href="classPlotDataBase.html#a74f7d59d2181ce0655baacab7d8f3626">GetSize</a> ();theI++) {
<a name="l00385"></a>00385 <span class="comment">//    float theX = (*theXData)[theI];</span>
<a name="l00386"></a>00386 <span class="comment">//    float theY = (*theYData)[theI];</span>
<a name="l00387"></a>00387     <span class="keywordtype">float</span> theX = inXData-&gt;<a class="code" href="classPlotDataBase.html#a051e797882b97aab07c8defcffc941b0">GetValue</a> (theI);
<a name="l00388"></a>00388     <span class="keywordtype">float</span> theY = inYData-&gt;<a class="code" href="classPlotDataBase.html#a051e797882b97aab07c8defcffc941b0">GetValue</a> (theI);
<a name="l00389"></a>00389     <span class="comment">// transform to pixels</span>
<a name="l00390"></a>00390     theX = <a class="code" href="classPPlotInteraction.html#a4c526bbe9d1a60f1c0e2a674002cd1d1">mPPlot</a>.<a class="code" href="classPPlot.html#a2621cb67e855d1ba8cb2e30a5660bf4b">mXTrafo</a>-&gt;<a class="code" href="classTrafo.html#a54eadaa6d336cfc5a1b1d346d5cde4dd">Transform</a> (theX)-<a class="code" href="classPSelectionInteraction.html#a333315ad4817bffe1ddef08334268873">mMouseEvent</a>.<a class="code" href="classPMouseEvent.html#a4ee9584d0d3ae8113d5aef1da9574e2c">mX</a>;
<a name="l00391"></a>00391     theY = <a class="code" href="classPPlotInteraction.html#a4c526bbe9d1a60f1c0e2a674002cd1d1">mPPlot</a>.<a class="code" href="classPPlot.html#aa1718f3b38e95414b90edc8c56fd1942">mYTrafo</a>-&gt;<a class="code" href="classTrafo.html#a54eadaa6d336cfc5a1b1d346d5cde4dd">Transform</a> (theY)-<a class="code" href="classPSelectionInteraction.html#a333315ad4817bffe1ddef08334268873">mMouseEvent</a>.<a class="code" href="classPMouseEvent.html#ad71888fe4be5d8ab131ebfa072c65f32">mY</a>;
<a name="l00392"></a>00392 
<a name="l00393"></a>00393     <span class="keywordtype">float</span> theTmp = theX*theX+theY*theY;
<a name="l00394"></a>00394 
<a name="l00395"></a>00395     <span class="keywordflow">if</span> (theTmp&lt;theDist||theDist&lt;0) {
<a name="l00396"></a>00396       theDist = theTmp;
<a name="l00397"></a>00397       outNearestPointIndex = theI;
<a name="l00398"></a>00398     }
<a name="l00399"></a>00399   }
<a name="l00400"></a>00400 
<a name="l00401"></a>00401   <span class="keywordflow">return</span> sqrt (theDist);
<a name="l00402"></a>00402 }
<a name="l00403"></a>00403 
<a name="l00404"></a>00404 
<a name="l00405"></a><a class="code" href="classPlotDataIncrementerBounds.html#af266153d8f5d9127e97322db4e226fa0">00405</a> <a class="code" href="classPlotDataIncrementerBounds.html#af266153d8f5d9127e97322db4e226fa0">PlotDataIncrementerBounds::PlotDataIncrementerBounds</a> ():
<a name="l00406"></a>00406   mLowerBoundEnabled (false),
<a name="l00407"></a>00407   mLowerBound (0),
<a name="l00408"></a>00408   mUpperBoundEnabled (false),
<a name="l00409"></a>00409   mUpperBound (0)
<a name="l00410"></a>00410 {
<a name="l00411"></a>00411 }
<a name="l00412"></a>00412 
<a name="l00413"></a><a class="code" href="classPlotDataIncrementerBounds.html#a4a898ce099ce83f1e31f59a85bf2f6e4">00413</a> <span class="keywordtype">bool</span> <a class="code" href="classPlotDataIncrementerBounds.html#a4a898ce099ce83f1e31f59a85bf2f6e4">PlotDataIncrementerBounds::CheckBounds</a> (<span class="keywordtype">float</span> inValue)<span class="keyword"> const </span>{
<a name="l00414"></a>00414   <span class="keywordflow">if</span> (<a class="code" href="classPlotDataIncrementerBounds.html#ab469dae94609377a3494bef41338a5ff">mLowerBoundEnabled</a> &amp;&amp; inValue&lt;<a class="code" href="classPlotDataIncrementerBounds.html#a36e752351ce914c960fb36ca21daf853">mLowerBound</a>) {
<a name="l00415"></a>00415     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00416"></a>00416   }
<a name="l00417"></a>00417   <span class="keywordflow">if</span> (<a class="code" href="classPlotDataIncrementerBounds.html#a0f3a0ee6742c6a759a69e3ea4a9b2323">mUpperBoundEnabled</a> &amp;&amp; inValue&gt;<a class="code" href="classPlotDataIncrementerBounds.html#acefd5154c9ba1ef4366f86ff3f1ed47c">mUpperBound</a>) {
<a name="l00418"></a>00418     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00419"></a>00419   }
<a name="l00420"></a>00420   <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00421"></a>00421 }
<a name="l00422"></a>00422 
<a name="l00423"></a>00423 
<a name="l00424"></a><a class="code" href="classPlotDataIncrementer.html#a2c42e4da3a9a6980ad4e3d20619ef89b">00424</a> <span class="keywordtype">bool</span> <a class="code" href="classPlotDataIncrementer.html#a2c42e4da3a9a6980ad4e3d20619ef89b">PlotDataIncrementer::Increment</a> (<span class="keyword">const</span> vector&lt;float&gt; &amp;inIncrementList, vector&lt;float *&gt; &amp;inData, <span class="keyword">const</span> <a class="code" href="classPlotDataIncrementerBounds.html">PlotDataIncrementerBounds</a> &amp;inGlobalBounds, <span class="keyword">const</span> vector&lt;PlotDataIncrementerBounds&gt; &amp;inBoundList)<span class="keyword"> const </span>{
<a name="l00425"></a>00425   <span class="keywordtype">bool</span> theDontChange = <span class="keyword">true</span>;
<a name="l00426"></a>00426 
<a name="l00427"></a>00427   <span class="keywordflow">if</span> (!<a class="code" href="classPlotDataIncrementer.html#aff90409bd95fe2a585a1fa418d1831bb">Impl_Increment</a> (inIncrementList, inData, inGlobalBounds, inBoundList, theDontChange)) {
<a name="l00428"></a>00428     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00429"></a>00429   }
<a name="l00430"></a>00430   theDontChange = <span class="keyword">false</span>;
<a name="l00431"></a>00431   <a class="code" href="classPlotDataIncrementer.html#aff90409bd95fe2a585a1fa418d1831bb">Impl_Increment</a> (inIncrementList, inData, inGlobalBounds, inBoundList, theDontChange);
<a name="l00432"></a>00432   <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00433"></a>00433 }
<a name="l00434"></a>00434 
<a name="l00435"></a><a class="code" href="classPlotDataIncrementer.html#aff90409bd95fe2a585a1fa418d1831bb">00435</a> <span class="keywordtype">bool</span> <a class="code" href="classPlotDataIncrementer.html#aff90409bd95fe2a585a1fa418d1831bb">PlotDataIncrementer::Impl_Increment</a> (<span class="keyword">const</span> vector&lt;float&gt; &amp;inIncrementList, vector&lt;float *&gt; &amp;inData, <span class="keyword">const</span> <a class="code" href="classPlotDataIncrementerBounds.html">PlotDataIncrementerBounds</a> &amp;inGlobalBounds, <span class="keyword">const</span> vector&lt;PlotDataIncrementerBounds&gt; &amp;inBoundList, <span class="keywordtype">bool</span> inDontChange)<span class="keyword"> const </span>{
<a name="l00436"></a>00436 
<a name="l00437"></a>00437   <span class="keywordflow">if</span> (inBoundList.size ()&gt;0 &amp;&amp; inBoundList.size () != inData.size ()) {
<a name="l00438"></a>00438     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00439"></a>00439   }
<a name="l00440"></a>00440   <span class="keywordflow">if</span> (inIncrementList.size () != inData.size ()) {
<a name="l00441"></a>00441     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00442"></a>00442   }
<a name="l00443"></a>00443 
<a name="l00444"></a>00444   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> theI=0;theI&lt;inData.size ();theI++) {
<a name="l00445"></a>00445     <span class="keywordtype">float</span> *theValue = inData[theI];
<a name="l00446"></a>00446     <span class="keywordtype">float</span> theIncrement = inIncrementList[theI];
<a name="l00447"></a>00447     <span class="keywordtype">float</span> theIncrementedValue = *theValue+theIncrement;
<a name="l00448"></a>00448     <span class="keywordflow">if</span> (!inGlobalBounds.<a class="code" href="classPlotDataIncrementerBounds.html#a4a898ce099ce83f1e31f59a85bf2f6e4">CheckBounds</a> (theIncrementedValue)) {
<a name="l00449"></a>00449       <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00450"></a>00450     }
<a name="l00451"></a>00451     <span class="keywordflow">if</span> (inBoundList.size ()&gt;0) {
<a name="l00452"></a>00452       <span class="keywordflow">if</span> (!inBoundList[theI].CheckBounds (theIncrementedValue)) {
<a name="l00453"></a>00453         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00454"></a>00454       }
<a name="l00455"></a>00455     }
<a name="l00456"></a>00456     <span class="keywordflow">if</span> (!inDontChange) {
<a name="l00457"></a>00457       *theValue = theIncrementedValue;
<a name="l00458"></a>00458     }
<a name="l00459"></a>00459   }
<a name="l00460"></a>00460   <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00461"></a>00461 }
<a name="l00462"></a>00462 
<a name="l00463"></a>00463 
<a name="l00464"></a>00464 
<a name="l00465"></a><a class="code" href="classPEditInteraction.html#aebee862eb96d6ade750051df840d5f54">00465</a> <a class="code" href="classPEditInteraction.html#aebee862eb96d6ade750051df840d5f54">PEditInteraction::PEditInteraction</a> (<a class="code" href="classPPlot.html">PPlot</a> &amp;inPPlot):
<a name="l00466"></a>00466   <a class="code" href="classPPlotInteraction.html">PPlotInteraction</a> (inPPlot),
<a name="l00467"></a>00467   mCalculate (false),
<a name="l00468"></a>00468   mListener (0)
<a name="l00469"></a>00469 {
<a name="l00470"></a>00470   inPPlot.<a class="code" href="classPPlot.html#a043302a4eb74890ffc6f1dde2eb9b76e">mModifyingCalculatorList</a>.push_back (<span class="keyword">this</span>);
<a name="l00471"></a>00471 }
<a name="l00472"></a>00472 
<a name="l00473"></a><a class="code" href="classPEditInteraction.html#a94f1ad0788ee4f931c9f07ed1d154913">00473</a> <span class="keywordtype">bool</span> <a class="code" href="classPEditInteraction.html#a94f1ad0788ee4f931c9f07ed1d154913">PEditInteraction::HandleKeyEvent</a> (<span class="keyword">const</span> <a class="code" href="classPKeyEvent.html">PKeyEvent</a> &amp;inEvent) {
<a name="l00474"></a>00474 
<a name="l00475"></a>00475   mCalculate = <a class="code" href="classPEditInteraction.html#aebb3b2d994c288fb1b6c99b388288dce">Impl_HandleKeyEvent</a> (inEvent);
<a name="l00476"></a>00476   <a class="code" href="classPEditInteraction.html#a05256a9d88d011a54cad227fd43a2675">mKeyEvent</a> = inEvent;
<a name="l00477"></a>00477   <span class="keywordflow">return</span> mCalculate;
<a name="l00478"></a>00478 };
<a name="l00479"></a>00479 
<a name="l00480"></a><a class="code" href="classPEditInteraction.html#ad44d2a948ad7ea672f6fcdf20b57f6f8">00480</a> <span class="keywordtype">bool</span> <a class="code" href="classPEditInteraction.html#ad44d2a948ad7ea672f6fcdf20b57f6f8">PEditInteraction::Calculate</a> (<a class="code" href="classPainter.html">Painter</a> &amp;inPainter, <a class="code" href="classPPlot.html">PPlot</a>&amp; inPPlot) {
<a name="l00481"></a>00481   <span class="keywordflow">if</span> (!mCalculate) {
<a name="l00482"></a>00482     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00483"></a>00483   }
<a name="l00484"></a>00484 
<a name="l00485"></a>00485   <a class="code" href="classPEditInteraction.html#a9b4f76e8d4195c0d5ab69e4ee4ae3ed0">Impl_Calculate</a> (inPainter, inPPlot);
<a name="l00486"></a>00486 
<a name="l00487"></a>00487   <span class="keywordflow">if</span> (<a class="code" href="classPEditInteraction.html#a7b0e371c7177372ca074d61c73c820ab">mListener</a>) {
<a name="l00488"></a>00488     <a class="code" href="classPEditInteraction.html#a7b0e371c7177372ca074d61c73c820ab">mListener</a>-&gt;<a class="code" href="classPEditInteractionListener.html#a1d54bdb808c53485860dfa199c48b32a">HandlePEditInteraction</a> ();
<a name="l00489"></a>00489   }
<a name="l00490"></a>00490   mCalculate = <span class="keyword">false</span>;
<a name="l00491"></a>00491   <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00492"></a>00492 }
<a name="l00493"></a>00493 
<a name="l00494"></a>00494 
<a name="l00495"></a>00495 
<a name="l00496"></a><a class="code" href="classPVerticalCursorInteraction.html#accf13a3502c1ee1b0c1cf34cccf64bf2">00496</a> <a class="code" href="classPVerticalCursorInteraction.html#accf13a3502c1ee1b0c1cf34cccf64bf2">PVerticalCursorInteraction::PVerticalCursorInteraction</a> (<a class="code" href="classPPlot.html">PPlot</a> &amp;inPPlot):
<a name="l00497"></a>00497   <a class="code" href="classPEditInteraction.html">PEditInteraction</a> (inPPlot)
<a name="l00498"></a>00498 {
<a name="l00499"></a>00499 }
<a name="l00500"></a>00500 
<a name="l00501"></a><a class="code" href="classPVerticalCursorInteraction.html#a9e112e2f255c01ab5491ee2dd25d4fc7">00501</a> <span class="keywordtype">bool</span> <a class="code" href="classPVerticalCursorInteraction.html#a9e112e2f255c01ab5491ee2dd25d4fc7">PVerticalCursorInteraction::Impl_HandleKeyEvent</a> (<span class="keyword">const</span> <a class="code" href="classPKeyEvent.html">PKeyEvent</a> &amp;inEvent) {
<a name="l00502"></a>00502 
<a name="l00503"></a>00503   <span class="keywordflow">if</span> (inEvent.<a class="code" href="classPKeyEvent.html#ace4fc5ef272469ab1c62a183b076323f">IsArrowDown</a> () || inEvent.<a class="code" href="classPKeyEvent.html#a711de85f4365d8f9ba4092d9d234bc9f">IsArrowUp</a> ()) {
<a name="l00504"></a>00504     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00505"></a>00505   }
<a name="l00506"></a>00506   <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00507"></a>00507 };
<a name="l00508"></a>00508 
<a name="l00509"></a><a class="code" href="classPVerticalCursorInteraction.html#a79e8e705ce2d16f24248b4b226fe8cdd">00509</a> <span class="keywordtype">bool</span> <a class="code" href="classPVerticalCursorInteraction.html#a79e8e705ce2d16f24248b4b226fe8cdd">PVerticalCursorInteraction::Impl_Calculate</a> (<a class="code" href="classPainter.html">Painter</a> &amp;inPainter, <a class="code" href="classPPlot.html">PPlot</a>&amp; inPPlot) {
<a name="l00510"></a>00510 
<a name="l00511"></a>00511   <a class="code" href="classPlotDataContainer.html">PlotDataContainer</a> &amp;theContainer = inPPlot.<a class="code" href="classPPlot.html#ab277f0e326965064b6dcdb8874f39817">mPlotDataContainer</a>;
<a name="l00512"></a>00512   <span class="keywordtype">long</span> thePlotCount = theContainer.<a class="code" href="classPlotDataContainer.html#a9e05ff25bc9b7d3df438e69fb3d213b9">GetPlotCount</a> ();
<a name="l00513"></a>00513   <span class="keywordflow">for</span> (<span class="keywordtype">long</span> theI=0;theI&lt;thePlotCount;theI++) {
<a name="l00514"></a>00514     <a class="code" href="classPlotDataBase.html">PlotDataBase</a> *theXData = theContainer.<a class="code" href="classPlotDataContainer.html#a682b8b22b7d86a294d9a3a7d61336b88">GetXData</a> (theI);
<a name="l00515"></a>00515     <a class="code" href="classPlotDataBase.html">PlotDataBase</a> *theYData = theContainer.<a class="code" href="classPlotDataContainer.html#a634f9d8edaa8a965b083a50fa79b947d">GetYData</a> (theI);
<a name="l00516"></a>00516     <a class="code" href="classDataDrawerBase.html">DataDrawerBase</a> *theDataDrawer = theContainer.<a class="code" href="classPlotDataContainer.html#a3875f1eb7846b0c2aca802824b1f1831">GetDataDrawer</a> (theI);
<a name="l00517"></a>00517     <a class="code" href="classPlotDataSelection.html">PlotDataSelection</a> *thePlotDataSelection = theContainer.<a class="code" href="classPlotDataContainer.html#ac4da7e57cbdb886c6424b766811aa0bc">GetPlotDataSelection</a> (theI);
<a name="l00518"></a>00518 
<a name="l00519"></a>00519     <span class="keywordflow">if</span> (<a class="code" href="classPEditInteraction.html#a05256a9d88d011a54cad227fd43a2675">mKeyEvent</a>.<a class="code" href="classPKeyEvent.html#a711de85f4365d8f9ba4092d9d234bc9f">IsArrowUp</a> () || <a class="code" href="classPEditInteraction.html#a05256a9d88d011a54cad227fd43a2675">mKeyEvent</a>.<a class="code" href="classPKeyEvent.html#ace4fc5ef272469ab1c62a183b076323f">IsArrowDown</a> () ) {
<a name="l00520"></a>00520       <a class="code" href="classPVerticalCursorInteraction.html#a6844953ec95064284368050d3cd45e97">HandleVerticalCursorKey</a> (thePlotDataSelection, theYData);
<a name="l00521"></a>00521     }
<a name="l00522"></a>00522   }
<a name="l00523"></a>00523   <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00524"></a>00524 }
<a name="l00525"></a>00525 
<a name="l00526"></a><a class="code" href="classPVerticalCursorInteraction.html#a6844953ec95064284368050d3cd45e97">00526</a> <span class="keywordtype">void</span> <a class="code" href="classPVerticalCursorInteraction.html#a6844953ec95064284368050d3cd45e97">PVerticalCursorInteraction::HandleVerticalCursorKey</a> (<span class="keyword">const</span> <a class="code" href="classPlotDataSelection.html">PlotDataSelection</a> *inPlotDataSelection, <a class="code" href="classPlotDataBase.html">PlotDataBase</a> *inYData) {
<a name="l00527"></a>00527   <span class="keyword">class </span><a class="code" href="classPlotData.html">PlotData</a> *theYData = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classPlotData.html">PlotData</a> *<span class="keyword">&gt;</span>(inYData);
<a name="l00528"></a>00528   <span class="keywordflow">if</span> (!theYData) {
<a name="l00529"></a>00529     <span class="keywordflow">return</span>;
<a name="l00530"></a>00530   }
<a name="l00531"></a>00531   vector&lt;float&gt; theIncrementList (inPlotDataSelection-&gt;<a class="code" href="classPlotDataSelection.html#a2f72c1ba66b46212350bc61d1995cfc2">GetSelectedCount</a> ());
<a name="l00532"></a>00532   vector&lt;float *&gt; theSelectedData (inPlotDataSelection-&gt;<a class="code" href="classPlotDataSelection.html#a2f72c1ba66b46212350bc61d1995cfc2">GetSelectedCount</a> ());
<a name="l00533"></a>00533   <span class="keywordtype">float</span> theDelta = 1;<span class="comment">// pixels</span>
<a name="l00534"></a>00534   <span class="keywordflow">if</span> (<a class="code" href="classPEditInteraction.html#a05256a9d88d011a54cad227fd43a2675">mKeyEvent</a>.<a class="code" href="classPKeyEvent.html#ace4fc5ef272469ab1c62a183b076323f">IsArrowDown</a> ()) {
<a name="l00535"></a>00535     theDelta *= -1;
<a name="l00536"></a>00536   }
<a name="l00537"></a>00537   <span class="keywordflow">if</span> (<a class="code" href="classPEditInteraction.html#a05256a9d88d011a54cad227fd43a2675">mKeyEvent</a>.<a class="code" href="classPModifierKeys.html#af46622c73b66767f0ee2d35ac57e2d78">IsOnlyControlKeyDown</a> ()) {
<a name="l00538"></a>00538     theDelta *= 10;
<a name="l00539"></a>00539   }
<a name="l00540"></a>00540   <span class="keywordtype">long</span> theIndex = 0;
<a name="l00541"></a>00541   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> theI=0;theI&lt;theYData-&gt;<a class="code" href="classPlotDataBase.html#a74f7d59d2181ce0655baacab7d8f3626">GetSize</a> ();theI++) {
<a name="l00542"></a>00542     <span class="keywordflow">if</span> (inPlotDataSelection-&gt;<a class="code" href="classPlotDataSelection.html#a310c537f5f57ba3852d33ebf41395339">IsSelected</a> (theI)) {
<a name="l00543"></a>00543       <span class="keywordtype">float</span> *theNow = &amp;((*theYData)[theI]);
<a name="l00544"></a>00544       <span class="keywordtype">float</span> theNowPixels = <a class="code" href="classPPlotInteraction.html#a4c526bbe9d1a60f1c0e2a674002cd1d1">mPPlot</a>.<a class="code" href="classPPlot.html#aa1718f3b38e95414b90edc8c56fd1942">mYTrafo</a>-&gt;<a class="code" href="classTrafo.html#a54eadaa6d336cfc5a1b1d346d5cde4dd">Transform</a> (*theNow);
<a name="l00545"></a>00545       <span class="keywordtype">float</span> theNow2 = <a class="code" href="classPPlotInteraction.html#a4c526bbe9d1a60f1c0e2a674002cd1d1">mPPlot</a>.<a class="code" href="classPPlot.html#aa1718f3b38e95414b90edc8c56fd1942">mYTrafo</a>-&gt;<a class="code" href="classTrafo.html#a123aaa7d4f7a385b02d7184cf969197c">TransformBack</a> (theNowPixels);
<a name="l00546"></a>00546       theNowPixels -= theDelta;
<a name="l00547"></a>00547       <span class="keywordtype">float</span> theShiftedNow = <a class="code" href="classPPlotInteraction.html#a4c526bbe9d1a60f1c0e2a674002cd1d1">mPPlot</a>.<a class="code" href="classPPlot.html#aa1718f3b38e95414b90edc8c56fd1942">mYTrafo</a>-&gt;<a class="code" href="classTrafo.html#a123aaa7d4f7a385b02d7184cf969197c">TransformBack</a> (theNowPixels);
<a name="l00548"></a>00548       <span class="keywordtype">float</span> theDeltaData = theShiftedNow-*theNow;
<a name="l00549"></a>00549       theIncrementList[theIndex] = theDeltaData;
<a name="l00550"></a>00550       theSelectedData[theIndex] = theNow;
<a name="l00551"></a>00551 <span class="comment">//      float theNew = theNow + theDelta;</span>
<a name="l00552"></a>00552 <span class="comment">//      (*theYData)[theI] = theNew;</span>
<a name="l00553"></a>00553       theIndex++;
<a name="l00554"></a>00554     }
<a name="l00555"></a>00555   }
<a name="l00556"></a>00556   <a class="code" href="classPlotDataIncrementer.html">PlotDataIncrementer</a> theIncremter;
<a name="l00557"></a>00557   vector&lt;PlotDataIncrementerBounds&gt; theDummyList;
<a name="l00558"></a>00558   theIncremter.<a class="code" href="classPlotDataIncrementer.html#a2c42e4da3a9a6980ad4e3d20619ef89b">Increment</a> (theIncrementList, theSelectedData, <a class="code" href="classPVerticalCursorInteraction.html#a66d5255ab793902e5c07b0de97e32acb">mGlobalBounds</a>, theDummyList);
<a name="l00559"></a>00559 }
<a name="l00560"></a>00560 
<a name="l00561"></a>00561 
<a name="l00562"></a><a class="code" href="classPDeleteInteraction.html#a125c88784d6f1323ffd36c4e84e91c2b">00562</a> <a class="code" href="classPDeleteInteraction.html#a125c88784d6f1323ffd36c4e84e91c2b">PDeleteInteraction::PDeleteInteraction</a> (<a class="code" href="classPPlot.html">PPlot</a> &amp;inPPlot):
<a name="l00563"></a>00563   <a class="code" href="classPEditInteraction.html">PEditInteraction</a> (inPPlot)
<a name="l00564"></a>00564 {
<a name="l00565"></a>00565 }
<a name="l00566"></a>00566 
<a name="l00567"></a><a class="code" href="classPDeleteInteraction.html#a3e220b5254212875b8952ff87d9aedd2">00567</a> <span class="keywordtype">bool</span> <a class="code" href="classPDeleteInteraction.html#a3e220b5254212875b8952ff87d9aedd2">PDeleteInteraction::Impl_HandleKeyEvent</a> (<span class="keyword">const</span> <a class="code" href="classPKeyEvent.html">PKeyEvent</a> &amp;inEvent) {
<a name="l00568"></a>00568 
<a name="l00569"></a>00569   <span class="keywordflow">if</span> (inEvent.<a class="code" href="classPKeyEvent.html#a26ae29ddff45b86a24903f775cfa45a5">IsDelete</a> ()) {
<a name="l00570"></a>00570     <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00571"></a>00571   }
<a name="l00572"></a>00572   <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00573"></a>00573 };
<a name="l00574"></a>00574 
<a name="l00575"></a><a class="code" href="classPDeleteInteraction.html#aabde25bba2f007f09c68854df7424e94">00575</a> <span class="keywordtype">bool</span> <a class="code" href="classPDeleteInteraction.html#aabde25bba2f007f09c68854df7424e94">PDeleteInteraction::Impl_Calculate</a> (<a class="code" href="classPainter.html">Painter</a> &amp;inPainter, <a class="code" href="classPPlot.html">PPlot</a>&amp; inPPlot) {
<a name="l00576"></a>00576 
<a name="l00577"></a>00577   <a class="code" href="classPlotDataContainer.html">PlotDataContainer</a> &amp;theContainer = inPPlot.<a class="code" href="classPPlot.html#ab277f0e326965064b6dcdb8874f39817">mPlotDataContainer</a>;
<a name="l00578"></a>00578   <span class="keywordtype">long</span> thePlotCount = theContainer.<a class="code" href="classPlotDataContainer.html#a9e05ff25bc9b7d3df438e69fb3d213b9">GetPlotCount</a> ();
<a name="l00579"></a>00579   <span class="keywordflow">for</span> (<span class="keywordtype">long</span> theI=0;theI&lt;thePlotCount;theI++) {
<a name="l00580"></a>00580     <a class="code" href="classPlotDataBase.html">PlotDataBase</a> *theXData = theContainer.<a class="code" href="classPlotDataContainer.html#a682b8b22b7d86a294d9a3a7d61336b88">GetXData</a> (theI);
<a name="l00581"></a>00581     <a class="code" href="classPlotDataBase.html">PlotDataBase</a> *theYData = theContainer.<a class="code" href="classPlotDataContainer.html#a634f9d8edaa8a965b083a50fa79b947d">GetYData</a> (theI);
<a name="l00582"></a>00582     <a class="code" href="classDataDrawerBase.html">DataDrawerBase</a> *theDataDrawer = theContainer.<a class="code" href="classPlotDataContainer.html#a3875f1eb7846b0c2aca802824b1f1831">GetDataDrawer</a> (theI);
<a name="l00583"></a>00583     <a class="code" href="classPlotDataSelection.html">PlotDataSelection</a> *thePlotDataSelection = theContainer.<a class="code" href="classPlotDataContainer.html#ac4da7e57cbdb886c6424b766811aa0bc">GetPlotDataSelection</a> (theI);
<a name="l00584"></a>00584 
<a name="l00585"></a>00585     <span class="keywordflow">if</span> (<a class="code" href="classPEditInteraction.html#a05256a9d88d011a54cad227fd43a2675">mKeyEvent</a>.<a class="code" href="classPKeyEvent.html#a26ae29ddff45b86a24903f775cfa45a5">IsDelete</a> () ) {
<a name="l00586"></a>00586       <a class="code" href="classPDeleteInteraction.html#a377f9ccafcc4c9e9c8824e244a0e76af">HandleDeleteKey</a> (theXData, theYData, thePlotDataSelection);
<a name="l00587"></a>00587     }
<a name="l00588"></a>00588   }
<a name="l00589"></a>00589   <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00590"></a>00590 }
<a name="l00591"></a>00591 
<a name="l00592"></a>00592 <span class="preprocessor">#include &lt;algorithm&gt;</span>
<a name="l00593"></a>00593 <span class="keyword">using namespace </span>std;
<a name="l00594"></a>00594 
<a name="l00595"></a><a class="code" href="PPlotInteraction_8cpp.html#a43ab1d3a026b636763e516b22b2d5924">00595</a> <span class="keyword">template</span>&lt;<span class="keyword">class</span> T&gt; <span class="keywordtype">bool</span> <a class="code" href="PPlotInteraction_8cpp.html#a43ab1d3a026b636763e516b22b2d5924">Erase</a> (<span class="keyword">const</span> vector&lt;int&gt; &amp;inEraseList, vector &lt;T&gt; &amp;ioVec) {
<a name="l00596"></a>00596   vector&lt;int&gt; theSortedList = inEraseList;
<a name="l00597"></a>00597   sort (theSortedList.begin (), theSortedList.end ());
<a name="l00598"></a>00598   reverse (theSortedList.begin (), theSortedList.end ());
<a name="l00599"></a>00599   unique (theSortedList.begin (), theSortedList.end ());<span class="comment">// remove duplicates</span>
<a name="l00600"></a>00600   <span class="keywordflow">for</span> (vector&lt;int&gt;::iterator theI=theSortedList.begin();theI!=theSortedList.end ();theI++) {
<a name="l00601"></a>00601     <span class="keywordtype">int</span> theEraseIndex = *theI;
<a name="l00602"></a>00602     <span class="comment">//    vector &lt;T&gt; ::iterator theX;</span>
<a name="l00603"></a>00603     <span class="comment">//    theX = ioVec[theEraseIndex];</span>
<a name="l00604"></a>00604     <span class="comment">//    T *theX = &amp;(ioVec[theEraseIndex]);</span>
<a name="l00605"></a>00605     ioVec.erase (ioVec.begin ()+theEraseIndex);
<a name="l00606"></a>00606   }
<a name="l00607"></a>00607 
<a name="l00608"></a>00608   <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00609"></a>00609 }
<a name="l00610"></a>00610 
<a name="l00611"></a>00611 
<a name="l00612"></a><a class="code" href="classPDeleteInteraction.html#a377f9ccafcc4c9e9c8824e244a0e76af">00612</a> <span class="keywordtype">void</span> <a class="code" href="classPDeleteInteraction.html#a377f9ccafcc4c9e9c8824e244a0e76af">PDeleteInteraction::HandleDeleteKey</a> (<a class="code" href="classPlotDataBase.html">PlotDataBase</a> *inXData, <a class="code" href="classPlotDataBase.html">PlotDataBase</a> *inYData, <a class="code" href="classPlotDataSelection.html">PlotDataSelection</a> *inPlotDataSelection) {
<a name="l00613"></a>00613   <span class="keyword">class </span><a class="code" href="classPlotData.html">PlotData</a> *theXData = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classPlotData.html">PlotData</a> *<span class="keyword">&gt;</span>(inXData);
<a name="l00614"></a>00614   <span class="keywordflow">if</span> (!theXData) {
<a name="l00615"></a>00615     <span class="keywordflow">return</span>;
<a name="l00616"></a>00616   }
<a name="l00617"></a>00617   <span class="keyword">class </span><a class="code" href="classPlotData.html">PlotData</a> *theYData = <span class="keyword">dynamic_cast&lt;</span><a class="code" href="classPlotData.html">PlotData</a> *<span class="keyword">&gt;</span>(inYData);
<a name="l00618"></a>00618   <span class="keywordflow">if</span> (!theYData) {
<a name="l00619"></a>00619     <span class="keywordflow">return</span>;
<a name="l00620"></a>00620   }
<a name="l00621"></a>00621   vector&lt;int&gt; theDeleteList (inPlotDataSelection-&gt;<a class="code" href="classPlotDataSelection.html#a2f72c1ba66b46212350bc61d1995cfc2">GetSelectedCount</a> ());
<a name="l00622"></a>00622   <span class="keywordtype">long</span> theIndex = 0;
<a name="l00623"></a>00623   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> theI=0;theI&lt;theYData-&gt;<a class="code" href="classPlotDataBase.html#a74f7d59d2181ce0655baacab7d8f3626">GetSize</a> ();theI++) {
<a name="l00624"></a>00624     <span class="keywordflow">if</span> (inPlotDataSelection-&gt;<a class="code" href="classPlotDataSelection.html#a310c537f5f57ba3852d33ebf41395339">IsSelected</a> (theI)) {
<a name="l00625"></a>00625       theDeleteList[theIndex] = theI;
<a name="l00626"></a>00626       theIndex++;
<a name="l00627"></a>00627     }
<a name="l00628"></a>00628   }
<a name="l00629"></a>00629   <a class="code" href="PPlotInteraction_8cpp.html#a43ab1d3a026b636763e516b22b2d5924">Erase</a> (theDeleteList, *theXData);
<a name="l00630"></a>00630   <a class="code" href="PPlotInteraction_8cpp.html#a43ab1d3a026b636763e516b22b2d5924">Erase</a> (theDeleteList, *theYData);
<a name="l00631"></a>00631   <a class="code" href="PPlotInteraction_8cpp.html#a43ab1d3a026b636763e516b22b2d5924">Erase</a> (theDeleteList, *inPlotDataSelection);
<a name="l00632"></a>00632 }
<a name="l00633"></a>00633 
<a name="l00634"></a><a class="code" href="classPCrosshairInteraction.html#a0ca38ec8bf775a665ab7f1e9beed3008">00634</a> <a class="code" href="classPCrosshairInteraction.html#a0ca38ec8bf775a665ab7f1e9beed3008">PCrosshairInteraction::PCrosshairInteraction</a> (<a class="code" href="classPPlot.html">PPlot</a> &amp;inPPlot):
<a name="l00635"></a>00635   <a class="code" href="classPPlotInteraction.html">PPlotInteraction</a> (inPPlot),
<a name="l00636"></a>00636   mActive (false),
<a name="l00637"></a>00637   mX (0),
<a name="l00638"></a>00638   mListener (0)
<a name="l00639"></a>00639 {
<a name="l00640"></a>00640   inPPlot.<a class="code" href="classPPlot.html#a470fc35ef0b237137b23a81e002bcffe">mPostDrawerList</a>.push_back (<span class="keyword">this</span>);
<a name="l00641"></a>00641 }
<a name="l00642"></a>00642 
<a name="l00643"></a><a class="code" href="classPCrosshairInteraction.html#a405885dfa3e58db49a2760bf36fa3cc2">00643</a> <span class="keywordtype">bool</span> <a class="code" href="classPCrosshairInteraction.html#a405885dfa3e58db49a2760bf36fa3cc2">PCrosshairInteraction::HandleMouseEvent</a> (<span class="keyword">const</span> <a class="code" href="classPMouseEvent.html">PMouseEvent</a> &amp;inEvent) {
<a name="l00644"></a>00644   <span class="keywordflow">if</span> (!<a class="code" href="classPCrosshairInteraction.html#a35fbd141c4f7fe88360b9685d85134b9">mActive</a>) {
<a name="l00645"></a>00645     <span class="keywordflow">if</span> (inEvent.<a class="code" href="classPMouseEvent.html#aeb1af37fc8f4660916492543776bac90">IsMouseDown</a> ()) {
<a name="l00646"></a>00646       <span class="keywordflow">if</span> (inEvent.<a class="code" href="classPModifierKeys.html#ae5f2eb8eaa7691b141d22a92fe7586de">IsShiftKeyDown</a> () &amp;&amp; inEvent.<a class="code" href="classPModifierKeys.html#a973da2d33d3bcceec185952c2c4fe610">IsControlKeyDown</a> ()) {
<a name="l00647"></a>00647         <a class="code" href="classPCrosshairInteraction.html#a35fbd141c4f7fe88360b9685d85134b9">mActive</a> = <span class="keyword">true</span>;
<a name="l00648"></a>00648         <a class="code" href="classPCrosshairInteraction.html#a0994573a1d2da98a7baadef7faf8a461">mX</a> = inEvent.<a class="code" href="classPMouseEvent.html#a4ee9584d0d3ae8113d5aef1da9574e2c">mX</a>;
<a name="l00649"></a>00649         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00650"></a>00650       }
<a name="l00651"></a>00651     }
<a name="l00652"></a>00652   }
<a name="l00653"></a>00653   <span class="keywordflow">else</span> {
<a name="l00654"></a>00654     <span class="keywordflow">if</span> (inEvent.<a class="code" href="classPMouseEvent.html#ad8054f212def7cd1c6d5392d943cffa7">IsMouseUp</a> ()) {
<a name="l00655"></a>00655       <a class="code" href="classPCrosshairInteraction.html#a35fbd141c4f7fe88360b9685d85134b9">mActive</a> = <span class="keyword">false</span>;
<a name="l00656"></a>00656       <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00657"></a>00657     }
<a name="l00658"></a>00658     <span class="keywordflow">if</span> (inEvent.<a class="code" href="classPMouseEvent.html#a7c6436306dca220fdb41cf915aac4353">IsMouseMove</a> ()) {
<a name="l00659"></a>00659       <a class="code" href="classPCrosshairInteraction.html#a0994573a1d2da98a7baadef7faf8a461">mX</a> = inEvent.<a class="code" href="classPMouseEvent.html#a4ee9584d0d3ae8113d5aef1da9574e2c">mX</a>;
<a name="l00660"></a>00660       <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00661"></a>00661     }
<a name="l00662"></a>00662   }
<a name="l00663"></a>00663   <span class="keywordflow">return</span> <span class="keyword">false</span>;  
<a name="l00664"></a>00664 }
<a name="l00665"></a>00665 
<a name="l00666"></a><a class="code" href="classPCrosshairInteraction.html#aee424bfeb9147230e194636a36747630">00666</a> <span class="keywordtype">bool</span> <a class="code" href="classPCrosshairInteraction.html#aee424bfeb9147230e194636a36747630">PCrosshairInteraction::Draw</a> (<a class="code" href="classPainter.html">Painter</a> &amp;inPainter) {
<a name="l00667"></a>00667   <span class="keywordflow">if</span> (<a class="code" href="classPCrosshairInteraction.html#a35fbd141c4f7fe88360b9685d85134b9">mActive</a>) {
<a name="l00668"></a>00668     <span class="keywordtype">float</span> theX1 = <a class="code" href="classPCrosshairInteraction.html#a0994573a1d2da98a7baadef7faf8a461">mX</a>;
<a name="l00669"></a>00669     <span class="keywordtype">float</span> theY1 = <a class="code" href="classPPlotInteraction.html#a4c526bbe9d1a60f1c0e2a674002cd1d1">mPPlot</a>.<a class="code" href="classPPlot.html#a5e2eb998aba1b7503ed93e247c691e3c">mMargins</a>.<a class="code" href="classPMargins.html#a403f340bcf5bb99b4088cb2fbf635fe1">mTop</a>;
<a name="l00670"></a>00670     <span class="keywordtype">float</span> theX2 = <a class="code" href="classPCrosshairInteraction.html#a0994573a1d2da98a7baadef7faf8a461">mX</a>;
<a name="l00671"></a>00671     <span class="keywordtype">float</span> theY2 = inPainter.<a class="code" href="classPainter.html#aacb92ddd72b057630080764e23066eb5">GetHeight</a> () - <a class="code" href="classPPlotInteraction.html#a4c526bbe9d1a60f1c0e2a674002cd1d1">mPPlot</a>.<a class="code" href="classPPlot.html#a5e2eb998aba1b7503ed93e247c691e3c">mMargins</a>.<a class="code" href="classPMargins.html#a855bd94f4df953e133f7c09e58e098af">mBottom</a>;
<a name="l00672"></a>00672 
<a name="l00673"></a>00673     inPainter.<a class="code" href="classPainter.html#aaa8881085ef774e7921c3ffbeb32248b">SetLineColor</a> (0, 0, 0);
<a name="l00674"></a>00674     inPainter.<a class="code" href="classPainter.html#af0a3c8557b5f77732e0712c2723edc71">DrawLine</a> (theX1, theY1, theX2, theY2);
<a name="l00675"></a>00675 
<a name="l00676"></a>00676     <a class="code" href="classPlotDataContainer.html">PlotDataContainer</a> &amp;theContainer = <a class="code" href="classPPlotInteraction.html#a4c526bbe9d1a60f1c0e2a674002cd1d1">mPPlot</a>.<a class="code" href="classPPlot.html#ab277f0e326965064b6dcdb8874f39817">mPlotDataContainer</a>;
<a name="l00677"></a>00677     <span class="keywordtype">long</span> thePlotCount = theContainer.<a class="code" href="classPlotDataContainer.html#a9e05ff25bc9b7d3df438e69fb3d213b9">GetPlotCount</a> ();
<a name="l00678"></a>00678 
<a name="l00679"></a>00679     <span class="keywordflow">for</span> (<span class="keywordtype">long</span> theI=0;theI&lt;thePlotCount;theI++) {
<a name="l00680"></a>00680       <a class="code" href="classPlotDataBase.html">PlotDataBase</a> *theXData = theContainer.<a class="code" href="classPlotDataContainer.html#a682b8b22b7d86a294d9a3a7d61336b88">GetXData</a> (theI);
<a name="l00681"></a>00681       <a class="code" href="classPlotDataBase.html">PlotDataBase</a> *theYData = theContainer.<a class="code" href="classPlotDataContainer.html#a634f9d8edaa8a965b083a50fa79b947d">GetYData</a> (theI);
<a name="l00682"></a>00682       <a class="code" href="classLegendData.html">LegendData</a> *theLegendData = theContainer.<a class="code" href="classPlotDataContainer.html#a677e4e30f435486c26f1f4a3fb279784">GetLegendData</a> (theI);
<a name="l00683"></a>00683 
<a name="l00684"></a>00684       <span class="keywordtype">float</span> theY;
<a name="l00685"></a>00685       <span class="keywordflow">if</span> (<a class="code" href="classPCrosshairInteraction.html#a1debc0cb884f3f08d4ad288f9ee83541">GetCrossPoint</a> (theXData, theYData, theY)) {
<a name="l00686"></a>00686         <span class="keywordflow">if</span> (<a class="code" href="classPCrosshairInteraction.html#ada8212869d151b2bb00c265faf7b637e">mListener</a>) {
<a name="l00687"></a>00687           <span class="keywordtype">float</span> theXTarget = <a class="code" href="classPPlotInteraction.html#a4c526bbe9d1a60f1c0e2a674002cd1d1">mPPlot</a>.<a class="code" href="classPPlot.html#a2621cb67e855d1ba8cb2e30a5660bf4b">mXTrafo</a>-&gt;<a class="code" href="classTrafo.html#a123aaa7d4f7a385b02d7184cf969197c">TransformBack</a> (<a class="code" href="classPCrosshairInteraction.html#a0994573a1d2da98a7baadef7faf8a461">mX</a>);
<a name="l00688"></a>00688           <span class="keywordtype">float</span> theYTarget = <a class="code" href="classPPlotInteraction.html#a4c526bbe9d1a60f1c0e2a674002cd1d1">mPPlot</a>.<a class="code" href="classPPlot.html#aa1718f3b38e95414b90edc8c56fd1942">mYTrafo</a>-&gt;<a class="code" href="classTrafo.html#a123aaa7d4f7a385b02d7184cf969197c">TransformBack</a> (theY);
<a name="l00689"></a>00689           <a class="code" href="classPCrosshairInteraction.html#ada8212869d151b2bb00c265faf7b637e">mListener</a>-&gt;<a class="code" href="classPCrosshairInteractionListener.html#a059dca76bab7723e943c6f481efe80a9">HandleCrosshair</a> (theI, thePlotCount, theXTarget, theYTarget);
<a name="l00690"></a>00690         }
<a name="l00691"></a>00691         theX1 = <a class="code" href="classPPlotInteraction.html#a4c526bbe9d1a60f1c0e2a674002cd1d1">mPPlot</a>.<a class="code" href="classPPlot.html#a5e2eb998aba1b7503ed93e247c691e3c">mMargins</a>.<a class="code" href="classPMargins.html#aa07b1106be37d89bc5d5c339822f3a9a">mLeft</a>;
<a name="l00692"></a>00692         theX2 = inPainter.<a class="code" href="classPainter.html#a1e01c507cde81d740544abce63abf23a">GetWidth</a> ()-<a class="code" href="classPPlotInteraction.html#a4c526bbe9d1a60f1c0e2a674002cd1d1">mPPlot</a>.<a class="code" href="classPPlot.html#a5e2eb998aba1b7503ed93e247c691e3c">mMargins</a>.<a class="code" href="classPMargins.html#aa07b1106be37d89bc5d5c339822f3a9a">mLeft</a>;
<a name="l00693"></a>00693         theY1 = theY2 = theY;
<a name="l00694"></a>00694         <a class="code" href="classPColor.html">PColor</a> theC = theLegendData-&gt;<a class="code" href="classLegendData.html#ab2b738729eae77d7abe55d7b86287c07">mColor</a>;
<a name="l00695"></a>00695         inPainter.<a class="code" href="classPainter.html#aaa8881085ef774e7921c3ffbeb32248b">SetLineColor</a> (theC.<a class="code" href="classPColor.html#a763867a28e89c0638b87c94c5f3a65e6">mR</a>, theC.<a class="code" href="classPColor.html#aa51509537ca14f7ff7c96b252fb5e530">mG</a>, theC.<a class="code" href="classPColor.html#a199e1622cceeb7db6af41bc0835950c8">mB</a>);
<a name="l00696"></a>00696         inPainter.<a class="code" href="classPainter.html#af0a3c8557b5f77732e0712c2723edc71">DrawLine</a> (theX1, theY1, theX2, theY2);
<a name="l00697"></a>00697       }
<a name="l00698"></a>00698     }
<a name="l00699"></a>00699   }
<a name="l00700"></a>00700   <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00701"></a>00701 }
<a name="l00702"></a>00702 
<a name="l00703"></a><a class="code" href="classPCrosshairInteraction.html#a1debc0cb884f3f08d4ad288f9ee83541">00703</a> <span class="keywordtype">bool</span> <a class="code" href="classPCrosshairInteraction.html#a1debc0cb884f3f08d4ad288f9ee83541">PCrosshairInteraction::GetCrossPoint</a> (<span class="keyword">const</span> <a class="code" href="classPlotDataBase.html">PlotDataBase</a> *inXData, <span class="keyword">const</span> <a class="code" href="classPlotDataBase.html">PlotDataBase</a> *inYData, <span class="keywordtype">float</span> &amp;<a class="code" href="Renderer_2GL_2glext_8h.html#ab117d69745dd2957030b968f6ee21c4d">outY</a>) {
<a name="l00704"></a>00704   <span class="keywordflow">if</span> (inXData-&gt;<a class="code" href="classPlotDataBase.html#a74f7d59d2181ce0655baacab7d8f3626">GetSize</a> ()==0 ){
<a name="l00705"></a>00705     <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00706"></a>00706   }
<a name="l00707"></a>00707   <span class="keywordtype">float</span> theXTarget = <a class="code" href="classPPlotInteraction.html#a4c526bbe9d1a60f1c0e2a674002cd1d1">mPPlot</a>.<a class="code" href="classPPlot.html#a2621cb67e855d1ba8cb2e30a5660bf4b">mXTrafo</a>-&gt;<a class="code" href="classTrafo.html#a123aaa7d4f7a385b02d7184cf969197c">TransformBack</a> (<a class="code" href="classPCrosshairInteraction.html#a0994573a1d2da98a7baadef7faf8a461">mX</a>);
<a name="l00708"></a>00708   <span class="keywordtype">bool</span> theFirstIsLess = inXData-&gt;<a class="code" href="classPlotDataBase.html#a051e797882b97aab07c8defcffc941b0">GetValue</a> (0) &lt; theXTarget;
<a name="l00709"></a>00709   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> theI=0;theI&lt;inXData-&gt;<a class="code" href="classPlotDataBase.html#a74f7d59d2181ce0655baacab7d8f3626">GetSize</a> ();theI++) {
<a name="l00710"></a>00710     <span class="keywordtype">float</span> theX = inXData-&gt;<a class="code" href="classPlotDataBase.html#a051e797882b97aab07c8defcffc941b0">GetValue</a> (theI);
<a name="l00711"></a>00711     <span class="keywordtype">float</span> theY = inYData-&gt;<a class="code" href="classPlotDataBase.html#a051e797882b97aab07c8defcffc941b0">GetValue</a> (theI);
<a name="l00712"></a>00712     <span class="keywordtype">bool</span> theCurrentIsLess = theX &lt; theXTarget;
<a name="l00713"></a>00713 
<a name="l00714"></a>00714     <span class="keywordflow">if</span> (theCurrentIsLess != theFirstIsLess) {
<a name="l00715"></a>00715       outY = <a class="code" href="classPPlotInteraction.html#a4c526bbe9d1a60f1c0e2a674002cd1d1">mPPlot</a>.<a class="code" href="classPPlot.html#aa1718f3b38e95414b90edc8c56fd1942">mYTrafo</a>-&gt;<a class="code" href="classTrafo.html#a54eadaa6d336cfc5a1b1d346d5cde4dd">Transform</a> (theY);<span class="comment">// transform to pixels</span>
<a name="l00716"></a>00716       <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00717"></a>00717     }
<a name="l00718"></a>00718   }
<a name="l00719"></a>00719   <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00720"></a>00720 }
<a name="l00721"></a>00721 
<a name="l00722"></a>00722 
<a name="l00723"></a><a class="code" href="classInteractionContainer.html#a0f4452f00c3217fd0d5bc0369e23c2f9">00723</a> <span class="keywordtype">bool</span> <a class="code" href="classInteractionContainer.html#a0f4452f00c3217fd0d5bc0369e23c2f9">InteractionContainer::HandleMouseEvent</a> (<span class="keyword">const</span> <a class="code" href="classPMouseEvent.html">PMouseEvent</a> &amp;inEvent) {
<a name="l00724"></a>00724   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> theI=0;theI&lt;<a class="code" href="classInteractionContainer.html#abd77315a14ba6508b8e398b8cd4e4d10">mList</a>.size ();theI++) {
<a name="l00725"></a>00725     <a class="code" href="classPPlotInteraction.html">PPlotInteraction</a> *theInteraction = <a class="code" href="classInteractionContainer.html#abd77315a14ba6508b8e398b8cd4e4d10">mList</a>[theI];
<a name="l00726"></a>00726     <span class="keywordflow">if</span> (theInteraction-&gt;<a class="code" href="classPPlotInteraction.html#a587047b8b165989c4858c39211084a89">IsEnabled</a> () &amp;&amp; theInteraction-&gt;<a class="code" href="classPPlotInteraction.html#a1c92736933f5628b7623d978cd02bf12">HandleMouseEvent</a> (inEvent)) {
<a name="l00727"></a>00727       <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00728"></a>00728     }
<a name="l00729"></a>00729   }
<a name="l00730"></a>00730   <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00731"></a>00731 }
<a name="l00732"></a>00732 
<a name="l00733"></a><a class="code" href="classInteractionContainer.html#a732c37f885b359464b46bdde997dfee8">00733</a> <span class="keywordtype">bool</span> <a class="code" href="classInteractionContainer.html#a732c37f885b359464b46bdde997dfee8">InteractionContainer::HandleKeyEvent</a> (<span class="keyword">const</span> <a class="code" href="classPKeyEvent.html">PKeyEvent</a> &amp;inEvent) {
<a name="l00734"></a>00734   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> theI=0;theI&lt;<a class="code" href="classInteractionContainer.html#abd77315a14ba6508b8e398b8cd4e4d10">mList</a>.size ();theI++) {
<a name="l00735"></a>00735     <a class="code" href="classPPlotInteraction.html">PPlotInteraction</a> *theInteraction = <a class="code" href="classInteractionContainer.html#abd77315a14ba6508b8e398b8cd4e4d10">mList</a>[theI];
<a name="l00736"></a>00736     <span class="keywordflow">if</span> (theInteraction-&gt;<a class="code" href="classPPlotInteraction.html#a587047b8b165989c4858c39211084a89">IsEnabled</a> () &amp;&amp; theInteraction-&gt;<a class="code" href="classPPlotInteraction.html#a214ffb38ca7d623607cc24519b255953">HandleKeyEvent</a> (inEvent)) {
<a name="l00737"></a>00737       <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00738"></a>00738     }
<a name="l00739"></a>00739   }
<a name="l00740"></a>00740   <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00741"></a>00741 }
<a name="l00742"></a>00742 
<a name="l00743"></a>00743 
<a name="l00744"></a><a class="code" href="classDefaultInteractionContainer.html#a0bd72cb69eafefb8540abc3e10bf05bb">00744</a> <a class="code" href="classDefaultInteractionContainer.html#a0bd72cb69eafefb8540abc3e10bf05bb">DefaultInteractionContainer::DefaultInteractionContainer</a> (<a class="code" href="classPPlot.html">PPlot</a> &amp;inPPlot):
<a name="l00745"></a>00745   mZoomInteraction (inPPlot),
<a name="l00746"></a>00746   mSelectionInteraction (inPPlot),
<a name="l00747"></a>00747   mVerticalCursorInteraction (inPPlot),
<a name="l00748"></a>00748   mDeleteInteraction (inPPlot),
<a name="l00749"></a>00749   mCrosshairInteraction (inPPlot)
<a name="l00750"></a>00750 {
<a name="l00751"></a>00751   <a class="code" href="classInteractionContainer.html#a23a08ef39e36e017fa4b6b780a19d60c">AddInteraction</a> (<a class="code" href="classDefaultInteractionContainer.html#a74c14b96718110f72b9f01917bb67193">mZoomInteraction</a>);
<a name="l00752"></a>00752   <a class="code" href="classInteractionContainer.html#a23a08ef39e36e017fa4b6b780a19d60c">AddInteraction</a> (<a class="code" href="classDefaultInteractionContainer.html#afdd1a538feb7a898661c34001b7dcaac">mSelectionInteraction</a>);
<a name="l00753"></a>00753   <a class="code" href="classInteractionContainer.html#a23a08ef39e36e017fa4b6b780a19d60c">AddInteraction</a> (<a class="code" href="classDefaultInteractionContainer.html#aadc46a32eb4e822cfaea709e777416a8">mVerticalCursorInteraction</a>);
<a name="l00754"></a>00754   <a class="code" href="classInteractionContainer.html#a23a08ef39e36e017fa4b6b780a19d60c">AddInteraction</a> (<a class="code" href="classDefaultInteractionContainer.html#a820144452ff225a23de135ae4e0c7912">mDeleteInteraction</a>);
<a name="l00755"></a>00755   <a class="code" href="classInteractionContainer.html#a23a08ef39e36e017fa4b6b780a19d60c">AddInteraction</a> (<a class="code" href="classDefaultInteractionContainer.html#a24c5087cc4b073b6fa6721b6ffdd4436">mCrosshairInteraction</a>);
<a name="l00756"></a>00756 <span class="comment">/*</span>
<a name="l00757"></a>00757 <span class="comment">  mVerticalCursorInteraction.mGlobalBounds.mLowerBoundEnabled = true;</span>
<a name="l00758"></a>00758 <span class="comment">  mVerticalCursorInteraction.mGlobalBounds.mLowerBound = 0;</span>
<a name="l00759"></a>00759 <span class="comment">  mVerticalCursorInteraction.mGlobalBounds.mUpperBoundEnabled = true;</span>
<a name="l00760"></a>00760 <span class="comment">  mVerticalCursorInteraction.mGlobalBounds.mUpperBound = 10;*/</span>
<a name="l00761"></a>00761 }
</pre></div></div><!-- contents -->


<hr class="footer"/><address class="footer"><small>
Generated on Thu May 2 2013 17:17:11 for Proton by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
