<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Proton: AndroidUtils.cpp Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />



</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">Proton
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="dir_b4959094aa2649f063000bebf8111065.html">shared</a>      </li>
      <li class="navelem"><a class="el" href="dir_f309ce4042975f2dc2926e2d168d99c7.html">android</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">AndroidUtils.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="AndroidUtils_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="preprocessor">#include &quot;<a class="code" href="AndroidUtils_8h.html">AndroidUtils.h</a>&quot;</span>
<a name="l00002"></a>00002 <span class="preprocessor">#include &lt;errno.h&gt;</span>
<a name="l00003"></a>00003 <span class="preprocessor">#include &lt;stdio.h&gt;</span>
<a name="l00004"></a>00004 <span class="preprocessor">#include &lt;sys/types.h&gt;</span>
<a name="l00005"></a>00005 <span class="preprocessor">#include &lt;sys/stat.h&gt;</span>
<a name="l00006"></a>00006 <span class="preprocessor">#include &lt;dirent.h&gt;</span>
<a name="l00007"></a>00007 
<a name="l00008"></a>00008 <span class="preprocessor">#include &lt;jni.h&gt;</span>
<a name="l00009"></a>00009 <span class="preprocessor">#include &lt;android/log.h&gt;</span>
<a name="l00010"></a>00010 <span class="preprocessor">#include &lt;cstdlib&gt;</span>
<a name="l00011"></a>00011 <span class="preprocessor">#include &lt;cstdarg&gt;</span>
<a name="l00012"></a>00012 <span class="preprocessor">#include &lt;cassert&gt;</span>
<a name="l00013"></a>00013 <span class="preprocessor">#include &quot;<a class="code" href="PlatformSetup_8h.html">PlatformSetup.h</a>&quot;</span>
<a name="l00014"></a>00014 <span class="preprocessor">#include &quot;<a class="code" href="BaseApp_8h.html">BaseApp.h</a>&quot;</span>
<a name="l00015"></a>00015 
<a name="l00016"></a>00016 <span class="preprocessor">#include &quot;<a class="code" href="FileSystemZip_8h.html">FileSystem/FileSystemZip.h</a>&quot;</span>
<a name="l00017"></a>00017 <span class="keyword">extern</span> JavaVM* <a class="code" href="AndroidUtils_8cpp.html#a9359ff5decd8bba1c734018224b1dc4d">g_pJavaVM</a>;
<a name="l00018"></a>00018 
<a name="l00019"></a>00019 <span class="keyword">const</span> <span class="keywordtype">char</span> * <a class="code" href="AndroidUtils_8cpp.html#a73f8e7670c2e9e7f917acb32d9616315">GetAppName</a>();
<a name="l00020"></a>00020 <span class="keyword">const</span> <span class="keywordtype">char</span> * <a class="code" href="AndroidUtils_8cpp.html#a74e9d4c8aefbec5bb44b6d4b00413988">GetBundlePrefix</a>();
<a name="l00021"></a>00021 <span class="keyword">const</span> <span class="keywordtype">char</span> * <a class="code" href="AndroidUtils_8cpp.html#ac893d7c01fabee34f80294e3e026c37d">GetBundleName</a>();
<a name="l00022"></a>00022 
<a name="l00023"></a><a class="code" href="AndroidUtils_8cpp.html#a8686dd088f825b904791c8a70a950642">00023</a> <span class="keywordtype">bool</span> <a class="code" href="AndroidUtils_8cpp.html#a8686dd088f825b904791c8a70a950642">g_preferSDCardForUserStorage</a> = <span class="keyword">false</span>;
<a name="l00024"></a>00024 
<a name="l00025"></a><a class="code" href="AndroidUtils_8cpp.html#a0a0d717b190c6d78d1d9dd4e56762370">00025</a> <a class="code" href="PlatformSetupAndroid_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a> <a class="code" href="AndroidUtils_8cpp.html#a0a0d717b190c6d78d1d9dd4e56762370">g_callAppResumeASAPTimer</a> = 0;
<a name="l00026"></a><a class="code" href="AndroidUtils_8cpp.html#a6f0e75467c30e284e8896d21a2f7ff1f">00026</a> <span class="keywordtype">bool</span> <a class="code" href="AndroidUtils_8cpp.html#a6f0e75467c30e284e8896d21a2f7ff1f">g_pauseASAP</a> = <span class="keyword">false</span>;
<a name="l00027"></a><a class="code" href="AndroidUtils_8cpp.html#a058ba35f5bef2a9148e3fbfdcb9bfb44">00027</a> <span class="keywordtype">string</span> <a class="code" href="AndroidUtils_8cpp.html#a058ba35f5bef2a9148e3fbfdcb9bfb44">g_musicToPlay</a>;
<a name="l00028"></a><a class="code" href="AndroidUtils_8cpp.html#a396b630dab833dd0a13e2cc814330519">00028</a> <span class="keywordtype">int</span> <a class="code" href="AndroidUtils_8cpp.html#a396b630dab833dd0a13e2cc814330519">g_musicPos</a> = 0;
<a name="l00029"></a>00029 
<a name="l00030"></a><a class="code" href="AndroidUtils_8cpp.html#adc4a7de1d86174736d817209e60db6a8">00030</a> <span class="keywordtype">bool</span> <a class="code" href="AndroidUtils_8cpp.html#adc4a7de1d86174736d817209e60db6a8">g_bSurfacesUnloaded</a> = <span class="keyword">false</span>;
<a name="l00031"></a>00031 
<a name="l00032"></a>00032 <span class="comment">//this delay fixes a problem with restoring surfaces before android 1.6 devices are ready for it resulting</span>
<a name="l00033"></a>00033 <span class="comment">//in white textures -  update: unneeded</span>
<a name="l00034"></a>00034 <span class="preprocessor">#define C_DELAY_BEFORE_RESTORING_SURFACES_MS 1</span>
<a name="l00035"></a>00035 <span class="preprocessor"></span>
<a name="l00036"></a><a class="code" href="AndroidUtils_8cpp.html#a7929ed9a26e90a9d98d9c93960be4f79">00036</a> <a class="code" href="structOSMessage.html">OSMessage</a> <a class="code" href="AndroidUtils_8cpp.html#a7929ed9a26e90a9d98d9c93960be4f79">g_lastOSMessage</a>; <span class="comment">//used to be a temporary holding place so android can access it because I&#39;m too lazy to figure</span>
<a name="l00037"></a>00037 <span class="comment">//out how to make/pass java structs</span>
<a name="l00038"></a>00038 
<a name="l00039"></a>00039 <span class="comment">//android has some concurrency issues that cause problems unless we cache input events - we don&#39;t want it calling ConvertCoordinatesIfRequired</span>
<a name="l00040"></a>00040 <span class="comment">//willy nilly</span>
<a name="l00041"></a>00041 
<a name="l00042"></a>00042 <span class="keyword">class </span>AndroidMessageCache
<a name="l00043"></a>00043 {
<a name="l00044"></a>00044 <span class="keyword">public</span>:
<a name="l00045"></a>00045         <span class="keywordtype">float</span> <a class="code" href="flash_2GLES_2glext_8h.html#a0cdec8e97a75ee9458b23d152bf962d4">x</a>,<a class="code" href="flash_2GLES_2glext_8h.html#a2532a9f8ed3a10a63f5e3c484fbfdb9b">y</a>;
<a name="l00046"></a>00046         <a class="code" href="MessageManager_8h.html#a700ed30d49bfe436323e17539d3a0010">eMessageType</a> <a class="code" href="eglext_8h.html#a890efa53b3d7deeeced6f3a0d6653ed3">type</a>;
<a name="l00047"></a>00047         <span class="keywordtype">int</span> finger;
<a name="l00048"></a>00048 
<a name="l00049"></a>00049 };
<a name="l00050"></a>00050 
<a name="l00051"></a><a class="code" href="AndroidUtils_8cpp.html#ac6246abf949faf91c86382ee4c29be4d">00051</a> list&lt;AndroidMessageCache&gt; <a class="code" href="AndroidUtils_8cpp.html#ac6246abf949faf91c86382ee4c29be4d">g_messageCache</a>;
<a name="l00052"></a>00052 
<a name="l00053"></a><a class="code" href="AndroidUtils_8cpp.html#a9359ff5decd8bba1c734018224b1dc4d">00053</a> JavaVM* <a class="code" href="AndroidUtils_8cpp.html#a9359ff5decd8bba1c734018224b1dc4d">g_pJavaVM</a> = NULL;
<a name="l00054"></a>00054 
<a name="l00055"></a><a class="code" href="AndroidUtils_8cpp.html#abe9e7dbcabc78a04f12ff59d41ab409f">00055</a> <span class="keywordtype">int</span> <a class="code" href="AndroidUtils_8cpp.html#abe9e7dbcabc78a04f12ff59d41ab409f">g_winVideoScreenX</a> = 0;
<a name="l00056"></a><a class="code" href="AndroidUtils_8cpp.html#ac443274c7cc3c314e8b0068cdfb8f3aa">00056</a> <span class="keywordtype">int</span> <a class="code" href="AndroidUtils_8cpp.html#ac443274c7cc3c314e8b0068cdfb8f3aa">g_winVideoScreenY</a> = 0;
<a name="l00057"></a>00057 
<a name="l00058"></a>00058 
<a name="l00059"></a>00059 <span class="keywordtype">void</span> <a class="code" href="AndroidUtils_8cpp.html#a7762ea092d648c2ebfab19cf48baba2b">StringReplace</a>(<span class="keyword">const</span> <a class="code" href="Renderer_2GL_2glext_8h.html#a06b88fc81ad0b30d1512e9609e3d7c82">std::string</a>&amp; what, <span class="keyword">const</span> <a class="code" href="Renderer_2GL_2glext_8h.html#a06b88fc81ad0b30d1512e9609e3d7c82">std::string</a>&amp; with, <a class="code" href="Renderer_2GL_2glext_8h.html#a06b88fc81ad0b30d1512e9609e3d7c82">std::string</a>&amp; <a class="code" href="Renderer_2GL_2glext_8h.html#a83ad0ee7f1e06b59c90271716e689080">in</a>);
<a name="l00060"></a>00060 vector&lt;string&gt; <a class="code" href="AndroidUtils_8cpp.html#a08f9f474ba5306f229a556d9b3919651">StringTokenize</a> (<span class="keyword">const</span>  <span class="keywordtype">string</span>  &amp; theString,  <span class="keyword">const</span>  <span class="keywordtype">string</span>  &amp; theDelimiter );
<a name="l00061"></a>00061 
<a name="l00062"></a>00062 
<a name="l00063"></a>00063 
<a name="l00064"></a>00064 <span class="keyword">extern</span> <span class="stringliteral">&quot;C&quot;</span> 
<a name="l00065"></a>00065 {
<a name="l00066"></a>00066 
<a name="l00067"></a><a class="code" href="AndroidUtils_8cpp.html#aac0498b58a4bbbf42588d30433b4f8ea">00067</a>         JNIEXPORT jint JNICALL <a class="code" href="AndroidUtils_8cpp.html#aac0498b58a4bbbf42588d30433b4f8ea">JNI_OnLoad</a>(JavaVM* vm, <span class="keywordtype">void</span>* reserved) 
<a name="l00068"></a>00068         {
<a name="l00069"></a>00069                 <span class="comment">//LogMsg(&quot;JNI_OnLoad(): you are here&quot;);</span>
<a name="l00070"></a>00070 
<a name="l00071"></a>00071                 JNIEnv* env;
<a name="l00072"></a>00072                 <span class="keywordflow">if</span> (vm-&gt;GetEnv((<span class="keywordtype">void</span>**)&amp;env, JNI_VERSION_1_4) != JNI_OK) 
<a name="l00073"></a>00073                 {
<a name="l00074"></a>00074                         <a class="code" href="AndroidUtils_8cpp.html#aaa5c9bf2289dec09f59ef2b7ba6c66ae">LogMsg</a>(<span class="stringliteral">&quot;JNI_OnLoad(): GetEnv failed&quot;</span>);
<a name="l00075"></a>00075                         <span class="keywordflow">return</span> -1;
<a name="l00076"></a>00076                 }
<a name="l00077"></a>00077                 <a class="code" href="AndroidUtils_8cpp.html#a9359ff5decd8bba1c734018224b1dc4d">g_pJavaVM</a> = vm; <span class="comment">//save to use this for the rest of the app.  Not neccesarily safe to use the Env passed in though.</span>
<a name="l00078"></a>00078                 <span class="keywordflow">return</span> JNI_VERSION_1_4;
<a name="l00079"></a>00079         }
<a name="l00080"></a>00080 
<a name="l00081"></a>00081 }
<a name="l00082"></a>00082 
<a name="l00083"></a><a class="code" href="PlatformEnums_8h.html#a2f0e58aac06a13b950cef03dcc3e7267">00083</a> <span class="keywordtype">int</span> <a class="code" href="AndroidUtils_8cpp.html#a2f0e58aac06a13b950cef03dcc3e7267">GetPrimaryGLX</a>() 
<a name="l00084"></a>00084 {
<a name="l00085"></a>00085 
<a name="l00086"></a>00086         <span class="keywordflow">return</span> <a class="code" href="AndroidUtils_8cpp.html#abe9e7dbcabc78a04f12ff59d41ab409f">g_winVideoScreenX</a>;
<a name="l00087"></a>00087 }
<a name="l00088"></a><a class="code" href="PlatformEnums_8h.html#ac274a49195455502331eb617bce938e3">00088</a> <span class="keywordtype">int</span> <a class="code" href="AndroidUtils_8cpp.html#ac274a49195455502331eb617bce938e3">GetPrimaryGLY</a>() 
<a name="l00089"></a>00089 {
<a name="l00090"></a>00090         <span class="keywordflow">return</span> <a class="code" href="AndroidUtils_8cpp.html#ac443274c7cc3c314e8b0068cdfb8f3aa">g_winVideoScreenY</a>;
<a name="l00091"></a>00091 }       
<a name="l00092"></a>00092 
<a name="l00093"></a><a class="code" href="PlatformSetup_8h.html#aaa5c9bf2289dec09f59ef2b7ba6c66ae">00093</a> <span class="keywordtype">void</span> <a class="code" href="AndroidUtils_8cpp.html#aaa5c9bf2289dec09f59ef2b7ba6c66ae">LogMsg</a> ( <span class="keyword">const</span> <span class="keywordtype">char</span>* traceStr, ... )
<a name="l00094"></a>00094 {
<a name="l00095"></a>00095         va_list argsVA;
<a name="l00096"></a>00096         <span class="keyword">const</span> <span class="keywordtype">int</span> logSize = 4096;
<a name="l00097"></a>00097         <span class="keywordtype">char</span> <a class="code" href="eglext_8h.html#a3667f558219c90437106b544a3ca00b8">buffer</a>[logSize];
<a name="l00098"></a>00098         memset ( (<span class="keywordtype">void</span>*)buffer, 0, logSize );
<a name="l00099"></a>00099 
<a name="l00100"></a>00100         va_start ( argsVA, traceStr );
<a name="l00101"></a>00101         vsnprintf( buffer, logSize, traceStr, argsVA );
<a name="l00102"></a>00102         va_end( argsVA );
<a name="l00103"></a>00103         
<a name="l00104"></a>00104         
<a name="l00105"></a>00105         __android_log_write(ANDROID_LOG_INFO,<a class="code" href="AndroidUtils_8cpp.html#a73f8e7670c2e9e7f917acb32d9616315">GetAppName</a>(), buffer);
<a name="l00106"></a>00106 
<a name="l00107"></a>00107         <span class="keywordflow">if</span> (<a class="code" href="BaseApp_8cpp.html#aef043c38b21bf52ff43fbca27a6cadb0">IsBaseAppInitted</a>())
<a name="l00108"></a>00108         {
<a name="l00109"></a>00109                 <a class="code" href="BaseApp_8h.html#a72086b48d24daf0a65dd20189a16bd16">GetBaseApp</a>()-&gt;<a class="code" href="classBaseApp.html#a2a7aaee85cb00b53f1efa753a96e2fc5">GetConsole</a>()-&gt;<a class="code" href="classConsole.html#a45f4ffafd5898db59a34e62f15a8739c">AddLine</a>(buffer);
<a name="l00110"></a>00110         }
<a name="l00111"></a>00111 }
<a name="l00112"></a>00112 
<a name="l00113"></a>00113 
<a name="l00114"></a><a class="code" href="PlatformEnums_8h.html#aa8eaa305653a0c93336016f614c7c769">00114</a> <span class="keywordtype">string</span> <a class="code" href="AndroidUtils_8cpp.html#aff7491e86f057160b0f86ce4607ae23d">GetBaseAppPath</a>()
<a name="l00115"></a>00115 {
<a name="l00116"></a>00116         <span class="keywordflow">return</span> <span class="stringliteral">&quot;&quot;</span>; <span class="comment">//we mount the assets as zip, there really isn&#39;t a base path</span>
<a name="l00117"></a>00117 }
<a name="l00118"></a>00118 
<a name="l00119"></a><a class="code" href="AndroidUtils_8h.html#a4ca0fd0590d9574c704f73f02f2132f0">00119</a> JNIEnv * <a class="code" href="AndroidUtils_8cpp.html#a4ca0fd0590d9574c704f73f02f2132f0">GetJavaEnv</a>()
<a name="l00120"></a>00120 {
<a name="l00121"></a>00121         assert(<a class="code" href="AndroidUtils_8cpp.html#a9359ff5decd8bba1c734018224b1dc4d">g_pJavaVM</a>);
<a name="l00122"></a>00122 
<a name="l00123"></a>00123         JNIEnv *env = NULL;
<a name="l00124"></a>00124         <a class="code" href="AndroidUtils_8cpp.html#a9359ff5decd8bba1c734018224b1dc4d">g_pJavaVM</a>-&gt;GetEnv((<span class="keywordtype">void</span> **)&amp;env, JNI_VERSION_1_4);
<a name="l00125"></a>00125         <span class="keywordflow">if</span> (!env)
<a name="l00126"></a>00126         {
<a name="l00127"></a>00127                 <a class="code" href="BaseApp_8cpp.html#a7217cebc0d5d71425d7b83154d38a4aa">LogError</a>(<span class="stringliteral">&quot;Env is null, something is terrible wrong&quot;</span>);
<a name="l00128"></a>00128                 <span class="keywordflow">return</span> NULL;
<a name="l00129"></a>00129         }
<a name="l00130"></a>00130         <span class="keywordflow">return</span> env;
<a name="l00131"></a>00131 };
<a name="l00132"></a>00132 
<a name="l00133"></a><a class="code" href="AndroidUtils_8h.html#ac9a50169e053e3cc34462ba79bb0cbeb">00133</a> <span class="keywordtype">char</span> * <a class="code" href="AndroidUtils_8cpp.html#ac9a50169e053e3cc34462ba79bb0cbeb">GetAndroidMainClassName</a>()
<a name="l00134"></a>00134 {
<a name="l00135"></a>00135         <span class="keyword">static</span> <span class="keywordtype">char</span> <a class="code" href="Renderer_2GL_2glext_8h.html#aaced7cfc21e7d37775d6921bb8177239">name</a>[128]=<span class="stringliteral">&quot;&quot;</span>;
<a name="l00136"></a>00136         <span class="keyword">static</span> <span class="keywordtype">bool</span> bFirstTime = <span class="keyword">true</span>;
<a name="l00137"></a>00137         <span class="keywordflow">if</span> (bFirstTime)
<a name="l00138"></a>00138         {
<a name="l00139"></a>00139                 bFirstTime = <span class="keyword">false</span>;
<a name="l00140"></a>00140                 <span class="keywordtype">string</span> <span class="keyword">package </span>= string(GetBundlePrefix())+string(GetBundleName())+&quot;/Main&quot;;
<a name="l00141"></a>00141                 <a class="code" href="AndroidUtils_8cpp.html#a7762ea092d648c2ebfab19cf48baba2b">StringReplace</a>(<span class="stringliteral">&quot;.&quot;</span>, <span class="stringliteral">&quot;/&quot;</span>, package);
<a name="l00142"></a>00142                 sprintf(name, package.c_str());
<a name="l00143"></a>00143         }
<a name="l00144"></a>00144 
<a name="l00145"></a>00145         <span class="keywordflow">return</span> <a class="code" href="Renderer_2GL_2glext_8h.html#aaced7cfc21e7d37775d6921bb8177239">name</a>;
<a name="l00146"></a>00146 
<a name="l00147"></a>00147 };
<a name="l00148"></a>00148 
<a name="l00149"></a>00149 
<a name="l00150"></a><a class="code" href="AndroidUtils_8cpp.html#aba02d4c2dedf78c2c4802b7a69932231">00150</a> <span class="keywordtype">string</span> <a class="code" href="AndroidUtils_8cpp.html#aba02d4c2dedf78c2c4802b7a69932231">GetSavePathBasic</a>()
<a name="l00151"></a>00151 {
<a name="l00152"></a>00152         JNIEnv *env = <a class="code" href="AndroidUtils_8cpp.html#a4ca0fd0590d9574c704f73f02f2132f0">GetJavaEnv</a>();
<a name="l00153"></a>00153         <span class="keywordflow">if</span> (!env) <span class="keywordflow">return</span> <span class="stringliteral">&quot;&quot;</span>;
<a name="l00154"></a>00154 
<a name="l00155"></a>00155         jclass cls = env-&gt;FindClass(<a class="code" href="AndroidUtils_8cpp.html#ac9a50169e053e3cc34462ba79bb0cbeb">GetAndroidMainClassName</a>());
<a name="l00156"></a>00156         jmethodID mid = env-&gt;GetStaticMethodID(cls,
<a name="l00157"></a>00157                 <span class="stringliteral">&quot;get_docdir&quot;</span>,
<a name="l00158"></a>00158                 <span class="stringliteral">&quot;()Ljava/lang/String;&quot;</span>);
<a name="l00159"></a>00159         jstring ret;
<a name="l00160"></a>00160         ret = (jstring)env-&gt;CallStaticObjectMethod(cls, mid);
<a name="l00161"></a>00161         <span class="keyword">static</span> <span class="keywordtype">char</span> <a class="code" href="flash_2GLES_2glext_8h.html#abe08814c2f72843fde4d8df41440d5a0">r</a>[512];
<a name="l00162"></a>00162         <span class="keyword">const</span> <span class="keywordtype">char</span> * ss=env-&gt;GetStringUTFChars(ret,0);
<a name="l00163"></a>00163         sprintf(r,<span class="stringliteral">&quot;%s&quot;</span>,ss);
<a name="l00164"></a>00164         env-&gt;ReleaseStringUTFChars(ret, ss);
<a name="l00165"></a>00165         <span class="keywordflow">return</span> <a class="code" href="Renderer_2GL_2glext_8h.html#a06b88fc81ad0b30d1512e9609e3d7c82">string</a>(r)+<span class="stringliteral">&quot;/&quot;</span>;
<a name="l00166"></a>00166 }
<a name="l00167"></a>00167 
<a name="l00168"></a>00168 <span class="comment">//this isn&#39;t really defined anywhere yet, if you need it, make your own header. Better to just use GetAppCachePath()</span>
<a name="l00169"></a>00169 <span class="comment">//directly.</span>
<a name="l00170"></a><a class="code" href="AndroidUtils_8cpp.html#ae9dc3080f80bcec13158c40f0c022eac">00170</a> <span class="keywordtype">void</span> <a class="code" href="AndroidUtils_8cpp.html#ae9dc3080f80bcec13158c40f0c022eac">SetPreferSDCardForStorage</a>(<span class="keywordtype">bool</span> bNew)
<a name="l00171"></a>00171 {
<a name="l00172"></a>00172         <a class="code" href="AndroidUtils_8cpp.html#a8686dd088f825b904791c8a70a950642">g_preferSDCardForUserStorage</a> = bNew;
<a name="l00173"></a>00173 }
<a name="l00174"></a>00174 
<a name="l00175"></a><a class="code" href="PlatformEnums_8h.html#a8808e5b173a2f097a1ce6f86c88a9aa0">00175</a> <span class="keywordtype">string</span> <a class="code" href="AndroidUtils_8cpp.html#a4e3106af366a322b39c787e9fa98c478">GetSavePath</a>()
<a name="l00176"></a>00176 {
<a name="l00177"></a>00177 
<a name="l00178"></a>00178         <a class="code" href="AndroidUtils_8cpp.html#aaa5c9bf2289dec09f59ef2b7ba6c66ae">LogMsg</a>(<span class="stringliteral">&quot;Starting get save path..&quot;</span>);
<a name="l00179"></a>00179 
<a name="l00180"></a>00180         <span class="keywordflow">if</span> (<a class="code" href="AndroidUtils_8cpp.html#a8686dd088f825b904791c8a70a950642">g_preferSDCardForUserStorage</a>)
<a name="l00181"></a>00181         {
<a name="l00182"></a>00182                 <span class="keywordtype">string</span> storageDir = <a class="code" href="AndroidUtils_8cpp.html#a1e846bfaa9134978cccba41f9070efeb">GetAppCachePath</a>();
<a name="l00183"></a>00183                 <span class="keywordflow">if</span> (!storageDir.empty()) <span class="keywordflow">return</span> storageDir;
<a name="l00184"></a>00184         }
<a name="l00185"></a>00185         <a class="code" href="AndroidUtils_8cpp.html#aaa5c9bf2289dec09f59ef2b7ba6c66ae">LogMsg</a>(<span class="stringliteral">&quot;continuing get save path..&quot;</span>);
<a name="l00186"></a>00186 
<a name="l00187"></a>00187         <span class="keywordtype">string</span> retString = <a class="code" href="AndroidUtils_8cpp.html#aba02d4c2dedf78c2c4802b7a69932231">GetSavePathBasic</a>();
<a name="l00188"></a>00188         
<a name="l00189"></a>00189 <span class="preprocessor">#ifdef _DEBUG</span>
<a name="l00190"></a>00190 <span class="preprocessor"></span>        <a class="code" href="AndroidUtils_8cpp.html#aaa5c9bf2289dec09f59ef2b7ba6c66ae">LogMsg</a>(<span class="stringliteral">&quot;Save dir is %s&quot;</span>, <span class="keywordtype">string</span>(retString).c_str());
<a name="l00191"></a>00191 <span class="preprocessor">#endif</span>
<a name="l00192"></a>00192 <span class="preprocessor"></span>
<a name="l00193"></a>00193         <span class="keywordflow">return</span> retString;
<a name="l00194"></a>00194 }
<a name="l00195"></a>00195 
<a name="l00196"></a><a class="code" href="AndroidUtils_8h.html#a89891a4048b5f427b8998a78b1a40b51">00196</a> <span class="keywordtype">string</span> <a class="code" href="AndroidUtils_8cpp.html#a841faf6a931d182ad97a7a1c4af79e61">GetAPKFile</a>()
<a name="l00197"></a>00197 {
<a name="l00198"></a>00198         JNIEnv *env = <a class="code" href="AndroidUtils_8cpp.html#a4ca0fd0590d9574c704f73f02f2132f0">GetJavaEnv</a>();
<a name="l00199"></a>00199         <span class="keywordflow">if</span> (!env)
<a name="l00200"></a>00200         {
<a name="l00201"></a>00201                 <a class="code" href="AndroidUtils_8cpp.html#aaa5c9bf2289dec09f59ef2b7ba6c66ae">LogMsg</a>(<span class="stringliteral">&quot;GetAPKFile&gt;  Error, can&#39;t do this yet, no java environment&quot;</span>);
<a name="l00202"></a>00202                 <span class="keywordflow">return</span> <span class="stringliteral">&quot;&quot;</span>;
<a name="l00203"></a>00203         }
<a name="l00204"></a>00204 
<a name="l00205"></a>00205         <a class="code" href="AndroidUtils_8cpp.html#aaa5c9bf2289dec09f59ef2b7ba6c66ae">LogMsg</a>(<span class="stringliteral">&quot;Getting apk file for %s from the Java side...&quot;</span>,<a class="code" href="AndroidUtils_8cpp.html#ac9a50169e053e3cc34462ba79bb0cbeb">GetAndroidMainClassName</a>());
<a name="l00206"></a>00206         jclass cls = env-&gt;FindClass(<a class="code" href="AndroidUtils_8cpp.html#ac9a50169e053e3cc34462ba79bb0cbeb">GetAndroidMainClassName</a>());
<a name="l00207"></a>00207         jmethodID mid = env-&gt;GetStaticMethodID(cls,
<a name="l00208"></a>00208                 <span class="stringliteral">&quot;get_apkFileName&quot;</span>,
<a name="l00209"></a>00209                 <span class="stringliteral">&quot;()Ljava/lang/String;&quot;</span>);
<a name="l00210"></a>00210         jstring ret;
<a name="l00211"></a>00211         ret = (jstring)env-&gt;CallStaticObjectMethod(cls, mid);
<a name="l00212"></a>00212         <span class="keyword">const</span> <span class="keywordtype">char</span> * ss=env-&gt;GetStringUTFChars(ret,0);
<a name="l00213"></a>00213         <span class="keywordtype">string</span> <a class="code" href="flash_2GLES_2glext_8h.html#ad585a1393cfa368fa9dc3d8ebff640d5">s</a> = ss;
<a name="l00214"></a>00214         env-&gt;ReleaseStringUTFChars(ret, ss);
<a name="l00215"></a>00215         <span class="keywordflow">return</span> <a class="code" href="Renderer_2GL_2glext_8h.html#a06b88fc81ad0b30d1512e9609e3d7c82">string</a>(s);
<a name="l00216"></a>00216 }
<a name="l00217"></a>00217 
<a name="l00218"></a>00218 <span class="comment">//returns the SD card user save path (will be deleted when app is uninstalled on 2.2+)</span>
<a name="l00219"></a>00219 <span class="comment">//returns &quot;&quot; if no SD card/external writable storage available</span>
<a name="l00220"></a>00220 
<a name="l00221"></a><a class="code" href="PlatformEnums_8h.html#ad03fd0666ac7b935a754c719545adeb8">00221</a> <span class="keywordtype">string</span> <a class="code" href="AndroidUtils_8cpp.html#a1e846bfaa9134978cccba41f9070efeb">GetAppCachePath</a>()
<a name="l00222"></a>00222 {
<a name="l00223"></a>00223 
<a name="l00224"></a>00224         <a class="code" href="AndroidUtils_8cpp.html#aaa5c9bf2289dec09f59ef2b7ba6c66ae">LogMsg</a>(<span class="stringliteral">&quot;Getting app cache..&quot;</span>);
<a name="l00225"></a>00225 
<a name="l00226"></a>00226         JNIEnv *env = <a class="code" href="AndroidUtils_8cpp.html#a4ca0fd0590d9574c704f73f02f2132f0">GetJavaEnv</a>();
<a name="l00227"></a>00227         <span class="keywordflow">if</span> (!env) <span class="keywordflow">return</span> <span class="stringliteral">&quot;&quot;</span>;
<a name="l00228"></a>00228 
<a name="l00229"></a>00229                 <span class="comment">//first see if we can access an external storage method</span>
<a name="l00230"></a>00230                 jclass cls = env-&gt;FindClass(<a class="code" href="AndroidUtils_8cpp.html#ac9a50169e053e3cc34462ba79bb0cbeb">GetAndroidMainClassName</a>());
<a name="l00231"></a>00231                 jmethodID mid = env-&gt;GetStaticMethodID(cls,
<a name="l00232"></a>00232                         <span class="stringliteral">&quot;get_externaldir&quot;</span>,
<a name="l00233"></a>00233                         <span class="stringliteral">&quot;()Ljava/lang/String;&quot;</span>);
<a name="l00234"></a>00234                 jstring ret;
<a name="l00235"></a>00235                 ret = (jstring)env-&gt;CallStaticObjectMethod(cls, mid);
<a name="l00236"></a>00236                 <span class="keyword">static</span> <span class="keywordtype">char</span> <a class="code" href="flash_2GLES_2glext_8h.html#abe08814c2f72843fde4d8df41440d5a0">r</a>[512];
<a name="l00237"></a>00237                 <span class="keyword">const</span> <span class="keywordtype">char</span> * ss=env-&gt;GetStringUTFChars(ret,0);
<a name="l00238"></a>00238                 sprintf(r,<span class="stringliteral">&quot;%s&quot;</span>,ss);
<a name="l00239"></a>00239                 env-&gt;ReleaseStringUTFChars(ret, ss);
<a name="l00240"></a>00240 
<a name="l00241"></a>00241                 <span class="keywordtype">string</span> retString = <a class="code" href="Renderer_2GL_2glext_8h.html#a06b88fc81ad0b30d1512e9609e3d7c82">string</a>(r);
<a name="l00242"></a>00242 
<a name="l00243"></a>00243                 <span class="keywordflow">if</span> (!retString.empty())
<a name="l00244"></a>00244                 {
<a name="l00245"></a>00245                         retString += <a class="code" href="Renderer_2GL_2glext_8h.html#a06b88fc81ad0b30d1512e9609e3d7c82">string</a>(<span class="stringliteral">&quot;/Android/data/&quot;</span>)+<a class="code" href="AndroidUtils_8cpp.html#a74e9d4c8aefbec5bb44b6d4b00413988">GetBundlePrefix</a>()+<a class="code" href="AndroidUtils_8cpp.html#ac893d7c01fabee34f80294e3e026c37d">GetBundleName</a>()+<span class="stringliteral">&quot;/files/&quot;</span>;
<a name="l00246"></a>00246                         <span class="comment">//LogMsg(&quot;External dir is %s&quot;, retString.c_str());</span>
<a name="l00247"></a>00247 
<a name="l00248"></a>00248                         <span class="comment">//looks valid</span>
<a name="l00249"></a>00249 <span class="preprocessor">#ifdef _DEBUG</span>
<a name="l00250"></a>00250 <span class="preprocessor"></span><span class="comment">//LogMsg(&quot;GetAppCachePath returning %s&quot;,retString.c_str());</span>
<a name="l00251"></a>00251 <span class="preprocessor">#endif</span>
<a name="l00252"></a>00252 <span class="preprocessor"></span>                        <span class="keywordflow">return</span> retString;
<a name="l00253"></a>00253                 }
<a name="l00254"></a>00254 
<a name="l00255"></a>00255                 retString = <a class="code" href="AndroidUtils_8cpp.html#aba02d4c2dedf78c2c4802b7a69932231">GetSavePathBasic</a>();
<a name="l00256"></a>00256 <span class="preprocessor">#ifdef _DEBUG</span>
<a name="l00257"></a>00257 <span class="preprocessor"></span>        <span class="comment">//      LogMsg(&quot;GetAppCachePath returned blank, so giving %s&quot;,retString.c_str());</span>
<a name="l00258"></a>00258 <span class="preprocessor">#endif</span>
<a name="l00259"></a>00259 <span class="preprocessor"></span>
<a name="l00260"></a>00260         <span class="keywordflow">return</span> retString; <span class="comment">//invalid</span>
<a name="l00261"></a>00261 }
<a name="l00262"></a>00262 
<a name="l00263"></a><a class="code" href="AndroidUtils_8cpp.html#aed7fff5248f5ad216f1bfd3f9f5aafc7">00263</a> <span class="keywordtype">void</span> <a class="code" href="AndroidUtils_8cpp.html#aed7fff5248f5ad216f1bfd3f9f5aafc7">LaunchEmail</a>(<span class="keywordtype">string</span> subject, <span class="keywordtype">string</span> content)
<a name="l00264"></a>00264 {
<a name="l00265"></a>00265 }
<a name="l00266"></a>00266 
<a name="l00267"></a><a class="code" href="AndroidUtils_8cpp.html#a686be4e0e1b63dc1764f2de83fb62c62">00267</a> <span class="keywordtype">void</span> <a class="code" href="AndroidUtils_8cpp.html#a686be4e0e1b63dc1764f2de83fb62c62">FireAchievement</a>(<span class="keywordtype">string</span> achievement)
<a name="l00268"></a>00268 {
<a name="l00269"></a>00269         JNIEnv *env = <a class="code" href="AndroidUtils_8cpp.html#a4ca0fd0590d9574c704f73f02f2132f0">GetJavaEnv</a>();
<a name="l00270"></a>00270         <a class="code" href="AndroidUtils_8cpp.html#aaa5c9bf2289dec09f59ef2b7ba6c66ae">LogMsg</a>(<span class="stringliteral">&quot;Attempting to fire Achievement %s&quot;</span>, achievement.c_str());
<a name="l00271"></a>00271 
<a name="l00272"></a>00272         <span class="keywordflow">if</span> (!env) 
<a name="l00273"></a>00273                 <span class="keywordflow">return</span>;
<a name="l00274"></a>00274         jclass cls = env-&gt;FindClass(<a class="code" href="AndroidUtils_8cpp.html#ac9a50169e053e3cc34462ba79bb0cbeb">GetAndroidMainClassName</a>());
<a name="l00275"></a>00275         jmethodID mid = env-&gt;GetStaticMethodID(cls,
<a name="l00276"></a>00276                 <span class="stringliteral">&quot;HandleAchievement&quot;</span>,
<a name="l00277"></a>00277                 <span class="stringliteral">&quot;(Ljava/lang/String;)V&quot;</span>);
<a name="l00278"></a>00278         env-&gt;CallStaticVoidMethod(cls, mid, env-&gt;NewStringUTF(achievement.c_str()));
<a name="l00279"></a>00279 }
<a name="l00280"></a>00280 
<a name="l00281"></a><a class="code" href="AndroidUtils_8cpp.html#a846b7d2d5376b357894ed37cc4a1bc27">00281</a> <span class="keywordtype">void</span> <a class="code" href="AndroidUtils_8cpp.html#a846b7d2d5376b357894ed37cc4a1bc27">LaunchURL</a>(<span class="keywordtype">string</span> url)
<a name="l00282"></a>00282 {
<a name="l00283"></a>00283         JNIEnv *env = <a class="code" href="AndroidUtils_8cpp.html#a4ca0fd0590d9574c704f73f02f2132f0">GetJavaEnv</a>();
<a name="l00284"></a>00284         <a class="code" href="AndroidUtils_8cpp.html#aaa5c9bf2289dec09f59ef2b7ba6c66ae">LogMsg</a>(<span class="stringliteral">&quot;Launching %s&quot;</span>, url.c_str());
<a name="l00285"></a>00285 
<a name="l00286"></a>00286         <span class="keywordflow">if</span> (!env) <span class="keywordflow">return</span>;
<a name="l00287"></a>00287         jclass cls = env-&gt;FindClass(<a class="code" href="AndroidUtils_8cpp.html#ac9a50169e053e3cc34462ba79bb0cbeb">GetAndroidMainClassName</a>());
<a name="l00288"></a>00288         jmethodID mid = env-&gt;GetStaticMethodID(cls,
<a name="l00289"></a>00289                 <span class="stringliteral">&quot;LaunchURL&quot;</span>,
<a name="l00290"></a>00290                 <span class="stringliteral">&quot;(Ljava/lang/String;)V&quot;</span>);
<a name="l00291"></a>00291         env-&gt;CallStaticVoidMethod(cls, mid, env-&gt;NewStringUTF(url.c_str()));
<a name="l00292"></a>00292 }
<a name="l00293"></a>00293 
<a name="l00294"></a><a class="code" href="PlatformEnums_8h.html#ace4f383ef050b30a44fe493a6df71649">00294</a> <span class="keywordtype">string</span> <a class="code" href="AndroidUtils_8cpp.html#acbacc5b050230751a1436f48e5a090ee">GetClipboardText</a>()
<a name="l00295"></a>00295 {
<a name="l00296"></a>00296         JNIEnv *env = <a class="code" href="AndroidUtils_8cpp.html#a4ca0fd0590d9574c704f73f02f2132f0">GetJavaEnv</a>();
<a name="l00297"></a>00297         <span class="keywordflow">if</span> (!env) <span class="keywordflow">return</span> <span class="stringliteral">&quot;&quot;</span>;
<a name="l00298"></a>00298 
<a name="l00299"></a>00299         jclass cls = env-&gt;FindClass(<a class="code" href="AndroidUtils_8cpp.html#ac9a50169e053e3cc34462ba79bb0cbeb">GetAndroidMainClassName</a>());
<a name="l00300"></a>00300         jmethodID mid = env-&gt;GetStaticMethodID(cls,
<a name="l00301"></a>00301                 <span class="stringliteral">&quot;get_clipboard&quot;</span>,
<a name="l00302"></a>00302                 <span class="stringliteral">&quot;()Ljava/lang/String;&quot;</span>);
<a name="l00303"></a>00303         jstring ret;
<a name="l00304"></a>00304         ret = (jstring)env-&gt;CallStaticObjectMethod(cls, mid);
<a name="l00305"></a>00305         <span class="keyword">const</span> <span class="keywordtype">char</span> * ss=env-&gt;GetStringUTFChars(ret,0);
<a name="l00306"></a>00306         <span class="keywordtype">string</span> <a class="code" href="flash_2GLES_2glext_8h.html#ad585a1393cfa368fa9dc3d8ebff640d5">s</a> = ss;
<a name="l00307"></a>00307         env-&gt;ReleaseStringUTFChars(ret, ss);
<a name="l00308"></a>00308         <span class="keywordflow">return</span> <a class="code" href="Renderer_2GL_2glext_8h.html#a06b88fc81ad0b30d1512e9609e3d7c82">string</a>(s);
<a name="l00309"></a>00309 }
<a name="l00310"></a>00310 
<a name="l00311"></a><a class="code" href="PlatformEnums_8h.html#a21ca3f553a2032f2f34ff2a3988efe9f">00311</a> <span class="keywordtype">bool</span> <a class="code" href="AndroidUtils_8cpp.html#a21ca3f553a2032f2f34ff2a3988efe9f">IsIPhone3GS</a>()
<a name="l00312"></a>00312 {
<a name="l00313"></a>00313         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00314"></a>00314 }
<a name="l00315"></a>00315 
<a name="l00316"></a><a class="code" href="PlatformEnums_8h.html#ad18508fd9ba560576bd0009dffebd014">00316</a> <span class="keywordtype">bool</span> <a class="code" href="AndroidUtils_8cpp.html#ad18508fd9ba560576bd0009dffebd014" title="Checks if the currently emulated platform is a desktop platform.">IsDesktop</a>()
<a name="l00317"></a>00317 {
<a name="l00318"></a>00318         <span class="keywordflow">if</span> (<a class="code" href="PlatformEnums_8h.html#a5eec67bdc9a66fa580686bcf211485f0" title="Gets the emulated platform id.">GetEmulatedPlatformID</a>() == <a class="code" href="PlatformEnums_8h.html#aaa43572fa440af9fa31b5ef4155975b2a4c56589fc030bd59718aaf643434c790">PLATFORM_ID_ANDROID</a>) <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00319"></a>00319         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00320"></a>00320 }
<a name="l00321"></a>00321 
<a name="l00322"></a><a class="code" href="PlatformEnums_8h.html#a3793c2907a23f8de9955b72f10c7789b">00322</a> <a class="code" href="PlatformEnums_8h.html#aaa43572fa440af9fa31b5ef4155975b2">ePlatformID</a> <a class="code" href="AndroidUtils_8cpp.html#a3793c2907a23f8de9955b72f10c7789b" title="Gets the platform id of the real running environment.">GetPlatformID</a>()
<a name="l00323"></a>00323 {
<a name="l00324"></a>00324         <span class="keywordflow">return</span> <a class="code" href="PlatformEnums_8h.html#aaa43572fa440af9fa31b5ef4155975b2a4c56589fc030bd59718aaf643434c790">PLATFORM_ID_ANDROID</a>;
<a name="l00325"></a>00325 }
<a name="l00326"></a>00326 
<a name="l00327"></a><a class="code" href="PlatformEnums_8h.html#ab76ffacfda2efb1677f0d8ff273ec110">00327</a> <span class="keywordtype">bool</span> <a class="code" href="AndroidUtils_8cpp.html#ab76ffacfda2efb1677f0d8ff273ec110">IsIphoneOriPad</a>()
<a name="l00328"></a>00328 {
<a name="l00329"></a>00329         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00330"></a>00330 }
<a name="l00331"></a>00331 
<a name="l00332"></a><a class="code" href="PlatformEnums_8h.html#ab229bc62a7e7163287d9379f7b224011">00332</a> <span class="keywordtype">bool</span> <a class="code" href="AndroidUtils_8cpp.html#ab229bc62a7e7163287d9379f7b224011">IsIphone</a>()
<a name="l00333"></a>00333 {
<a name="l00334"></a>00334         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00335"></a>00335 }
<a name="l00336"></a>00336 
<a name="l00337"></a><a class="code" href="PlatformEnums_8h.html#a424cf52050df28d3a4019cfdca31bc92">00337</a> <span class="keywordtype">bool</span> <a class="code" href="AndroidUtils_8cpp.html#a424cf52050df28d3a4019cfdca31bc92">IsIphone4</a>()
<a name="l00338"></a>00338 {
<a name="l00339"></a>00339         <span class="keywordflow">return</span> <span class="keyword">false</span>; 
<a name="l00340"></a>00340 }
<a name="l00341"></a>00341 
<a name="l00342"></a><a class="code" href="PlatformEnums_8h.html#aca0bc8f588b91e35bc47a61cb94a88eb">00342</a> <span class="keywordtype">string</span> <a class="code" href="AndroidUtils_8cpp.html#a7448c792ea7488e9976367c16978f398">GetDeviceID</a>()
<a name="l00343"></a>00343 {
<a name="l00344"></a>00344         JNIEnv *env = <a class="code" href="AndroidUtils_8cpp.html#a4ca0fd0590d9574c704f73f02f2132f0">GetJavaEnv</a>();
<a name="l00345"></a>00345         <span class="keywordflow">if</span> (!env) <span class="keywordflow">return</span> <span class="stringliteral">&quot;&quot;</span>;
<a name="l00346"></a>00346 
<a name="l00347"></a>00347         jclass cls = env-&gt;FindClass(<a class="code" href="AndroidUtils_8cpp.html#ac9a50169e053e3cc34462ba79bb0cbeb">GetAndroidMainClassName</a>());
<a name="l00348"></a>00348         jmethodID mid = env-&gt;GetStaticMethodID(cls,     
<a name="l00349"></a>00349                 <span class="stringliteral">&quot;get_deviceID&quot;</span>,
<a name="l00350"></a>00350                 <span class="stringliteral">&quot;()Ljava/lang/String;&quot;</span>);
<a name="l00351"></a>00351         jstring ret;
<a name="l00352"></a>00352         ret = (jstring)env-&gt;CallStaticObjectMethod(cls, mid);
<a name="l00353"></a>00353         <span class="keyword">const</span> <span class="keywordtype">char</span> * ss=env-&gt;GetStringUTFChars(ret,0);
<a name="l00354"></a>00354         <span class="keywordtype">string</span> <a class="code" href="flash_2GLES_2glext_8h.html#ad585a1393cfa368fa9dc3d8ebff640d5">s</a> = ss;
<a name="l00355"></a>00355         env-&gt;ReleaseStringUTFChars(ret, ss);
<a name="l00356"></a>00356         <span class="keywordflow">return</span> <a class="code" href="Renderer_2GL_2glext_8h.html#a06b88fc81ad0b30d1512e9609e3d7c82">string</a>(s);
<a name="l00357"></a>00357 }
<a name="l00358"></a>00358 
<a name="l00359"></a><a class="code" href="PlatformEnums_8h.html#aac6193ad8e9b0f83927e419710e457d3">00359</a> <span class="keywordtype">string</span> <a class="code" href="AndroidUtils_8cpp.html#a408161608b770026411d1b54cce6009d">GetMacAddress</a>()
<a name="l00360"></a>00360 {
<a name="l00361"></a>00361         <span class="comment">//todo</span>
<a name="l00362"></a>00362         <span class="keywordflow">return</span> <span class="stringliteral">&quot;&quot;</span>;
<a name="l00363"></a>00363 }
<a name="l00364"></a>00364 
<a name="l00365"></a><a class="code" href="PlatformEnums_8h.html#a626d2605494373d6732d56ef74b01ea7">00365</a> <span class="keywordtype">bool</span> <a class="code" href="AndroidUtils_8cpp.html#a626d2605494373d6732d56ef74b01ea7">IsIPAD</a>()
<a name="l00366"></a>00366 {
<a name="l00367"></a>00367         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00368"></a>00368 }
<a name="l00369"></a>00369 
<a name="l00370"></a><a class="code" href="PlatformEnums_8h.html#a46ee86c8f3871ed903d1d34f34f7639f">00370</a> <span class="keywordtype">float</span> <a class="code" href="AndroidUtils_8cpp.html#a46ee86c8f3871ed903d1d34f34f7639f">GetDeviceOSVersion</a>()
<a name="l00371"></a>00371 {
<a name="l00372"></a>00372         <span class="comment">//TODO</span>
<a name="l00373"></a>00373         <span class="keywordflow">return</span> 0.0f;
<a name="l00374"></a>00374 }
<a name="l00375"></a>00375 
<a name="l00376"></a><a class="code" href="PlatformEnums_8h.html#aab47e2e2253706e5991bc39f50f8d70f">00376</a> <a class="code" href="PlatformEnums_8h.html#aa859a933c9a9d85708d8be0a51557ce7">eDeviceMemoryClass</a> <a class="code" href="AndroidUtils_8cpp.html#aab47e2e2253706e5991bc39f50f8d70f">GetDeviceMemoryClass</a>()
<a name="l00377"></a>00377 {
<a name="l00378"></a>00378         <span class="keywordflow">return</span> <a class="code" href="PlatformEnums_8h.html#aa859a933c9a9d85708d8be0a51557ce7a911621d1308190d7bfd7297499108ea9">C_DEVICE_MEMORY_CLASS_2</a>;
<a name="l00379"></a>00379 }
<a name="l00380"></a>00380 
<a name="l00381"></a><a class="code" href="PlatformEnums_8h.html#a91969115f42fdcc21815c51e3924eacf">00381</a> <span class="keywordtype">bool</span> <a class="code" href="AndroidUtils_8cpp.html#a91969115f42fdcc21815c51e3924eacf">CheckDay</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> year, <span class="keyword">const</span> <span class="keywordtype">int</span> month, <span class="keyword">const</span> <span class="keywordtype">int</span> day)
<a name="l00382"></a>00382 {
<a name="l00383"></a>00383         <span class="keyword">struct </span>timeval  nowSecs;
<a name="l00384"></a>00384     gettimeofday(&amp;nowSecs, NULL);
<a name="l00385"></a>00385         time_t  nowtime = nowSecs.tv_sec;
<a name="l00386"></a>00386         <span class="keyword">struct </span>tm *now = localtime(&amp;nowtime);
<a name="l00387"></a>00387         <span class="keywordflow">if</span> (now-&gt;tm_year &lt; 1900)
<a name="l00388"></a>00388         {
<a name="l00389"></a>00389                 now-&gt;tm_year += 1900;
<a name="l00390"></a>00390         }
<a name="l00391"></a>00391         now-&gt;tm_mon++;
<a name="l00392"></a>00392         <a class="code" href="AndroidUtils_8cpp.html#aaa5c9bf2289dec09f59ef2b7ba6c66ae">LogMsg</a>(<span class="stringliteral">&quot;Comparing against date year %d, month %d, day %d&quot;</span>, now-&gt;tm_year, now-&gt;tm_mon, now-&gt;tm_mday);
<a name="l00393"></a>00393         <span class="keywordflow">if</span> ((now-&gt;tm_mday == day) &amp;&amp; (now-&gt;tm_mon == month) &amp;&amp; (now-&gt;tm_year == year))
<a name="l00394"></a>00394         {
<a name="l00395"></a>00395                 <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00396"></a>00396         }
<a name="l00397"></a>00397         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00398"></a>00398 }
<a name="l00399"></a>00399 
<a name="l00400"></a><a class="code" href="PlatformEnums_8h.html#aa5128e324b44511e06750cfc670c4be9">00400</a> <span class="keywordtype">bool</span> <a class="code" href="AndroidUtils_8cpp.html#aa5128e324b44511e06750cfc670c4be9">LaterThanNow</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> year, <span class="keyword">const</span> <span class="keywordtype">int</span> month, <span class="keyword">const</span> <span class="keywordtype">int</span> day)
<a name="l00401"></a>00401 {
<a name="l00402"></a>00402         <span class="keyword">struct </span>timeval  nowSecs;
<a name="l00403"></a>00403     gettimeofday(&amp;nowSecs, NULL);
<a name="l00404"></a>00404         time_t  nowtime = nowSecs.tv_sec;
<a name="l00405"></a>00405         <span class="keyword">struct </span>tm *now = localtime(&amp;nowtime);
<a name="l00406"></a>00406         <span class="keywordflow">if</span> (now-&gt;tm_year &lt; 1900)
<a name="l00407"></a>00407         {
<a name="l00408"></a>00408                 now-&gt;tm_year += 1900;
<a name="l00409"></a>00409         }
<a name="l00410"></a>00410         now-&gt;tm_mon++;
<a name="l00411"></a>00411         <a class="code" href="AndroidUtils_8cpp.html#aaa5c9bf2289dec09f59ef2b7ba6c66ae">LogMsg</a>(<span class="stringliteral">&quot;Comparing against date year %d, month %d, day %d&quot;</span>, now-&gt;tm_year, now-&gt;tm_mon, now-&gt;tm_mday);
<a name="l00412"></a>00412 
<a name="l00413"></a>00413         <span class="keywordflow">if</span> (now-&gt;tm_year&lt; year )
<a name="l00414"></a>00414         {
<a name="l00415"></a>00415                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00416"></a>00416         }
<a name="l00417"></a>00417         <span class="keywordflow">if</span> (now-&gt;tm_year&gt; year )
<a name="l00418"></a>00418         {
<a name="l00419"></a>00419                 <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00420"></a>00420         }
<a name="l00421"></a>00421         <span class="comment">// year must be equal</span>
<a name="l00422"></a>00422         <span class="keywordflow">if</span> (now-&gt;tm_mon &lt; month )
<a name="l00423"></a>00423         {
<a name="l00424"></a>00424                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00425"></a>00425         }
<a name="l00426"></a>00426         <span class="keywordflow">if</span> (now-&gt;tm_mon &gt; month )
<a name="l00427"></a>00427         {
<a name="l00428"></a>00428                 <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00429"></a>00429         }
<a name="l00430"></a>00430         <span class="comment">// month must be equal</span>
<a name="l00431"></a>00431         <span class="keywordflow">if</span> (now-&gt;tm_mday &lt; day )
<a name="l00432"></a>00432         {
<a name="l00433"></a>00433                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00434"></a>00434         }
<a name="l00435"></a>00435         <span class="keywordflow">if</span> (now-&gt;tm_mday &gt; day )
<a name="l00436"></a>00436         {
<a name="l00437"></a>00437                 <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00438"></a>00438         }
<a name="l00439"></a>00439         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00440"></a>00440 }
<a name="l00441"></a>00441 
<a name="l00442"></a><a class="code" href="PlatformEnums_8h.html#a702ae5b60fcc304afff9622752d8ee74">00442</a> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="AndroidUtils_8cpp.html#a702ae5b60fcc304afff9622752d8ee74">GetSystemTimeTick</a>()
<a name="l00443"></a>00443 {
<a name="l00444"></a>00444 
<a name="l00445"></a>00445         <span class="comment">/*</span>
<a name="l00446"></a>00446 <span class="comment">        struct timeval tv;</span>
<a name="l00447"></a>00447 <span class="comment">        gettimeofday(&amp;tv, NULL);</span>
<a name="l00448"></a>00448 <span class="comment">        return tv.tv_usec/1000 + tv.tv_sec*1000;</span>
<a name="l00449"></a>00449 <span class="comment">        */</span>
<a name="l00450"></a>00450 
<a name="l00451"></a>00451         <span class="comment">//More resistent to playing with the date to change timing in games</span>
<a name="l00452"></a>00452 
<a name="l00453"></a>00453         <span class="keyword">static</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> incrementingTimer = 0;
<a name="l00454"></a>00454         <span class="keyword">static</span> <span class="keywordtype">double</span> buildUp = 0;
<a name="l00455"></a>00455         <span class="keyword">static</span> <span class="keywordtype">double</span> lastTime = 0;
<a name="l00456"></a>00456 
<a name="l00457"></a>00457         <span class="keyword">struct </span>timespec time;
<a name="l00458"></a>00458         clock_gettime(CLOCK_MONOTONIC, &amp;time);
<a name="l00459"></a>00459         <span class="keywordtype">double</span> timeDouble = time.tv_sec*1000 + time.tv_nsec/1000000;
<a name="l00460"></a>00460 
<a name="l00461"></a>00461         <span class="keywordtype">double</span> change = timeDouble -lastTime;
<a name="l00462"></a>00462         <span class="keywordflow">if</span> (change &gt; 0 &amp;&amp; change &lt; 500)
<a name="l00463"></a>00463         {
<a name="l00464"></a>00464                 incrementingTimer += change;
<a name="l00465"></a>00465         }
<a name="l00466"></a>00466         lastTime = timeDouble;
<a name="l00467"></a>00467 
<a name="l00468"></a>00468         <span class="keywordflow">return</span> incrementingTimer;
<a name="l00469"></a>00469 
<a name="l00470"></a>00470 }
<a name="l00471"></a>00471 
<a name="l00472"></a><a class="code" href="PlatformEnums_8h.html#ad6aedd90205e1faea0c1f1fae08d0c4b">00472</a> <span class="keywordtype">double</span> <a class="code" href="AndroidUtils_8cpp.html#ad6aedd90205e1faea0c1f1fae08d0c4b">GetSystemTimeAccurate</a>()
<a name="l00473"></a>00473 {
<a name="l00474"></a>00474         <span class="keywordflow">return</span> double(<a class="code" href="AndroidUtils_8cpp.html#a702ae5b60fcc304afff9622752d8ee74">GetSystemTimeTick</a>());
<a name="l00475"></a>00475 }
<a name="l00476"></a>00476 
<a name="l00477"></a><a class="code" href="PlatformEnums_8h.html#a82f64c25cccdb1d9cac86095e58f1136">00477</a> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="AndroidUtils_8cpp.html#a82f64c25cccdb1d9cac86095e58f1136">GetFreeMemory</a>()
<a name="l00478"></a>00478 {
<a name="l00479"></a>00479         <span class="keywordflow">return</span> 0; <span class="comment">//don&#39;t care on the PC</span>
<a name="l00480"></a>00480 }
<a name="l00481"></a>00481 
<a name="l00482"></a><a class="code" href="AndroidUtils_8cpp.html#ab5e544a0c665a2408d1db9920e74b471">00482</a> <span class="keywordtype">string</span> <a class="code" href="AndroidUtils_8cpp.html#ab5e544a0c665a2408d1db9920e74b471">g_string</a>;
<a name="l00483"></a>00483 
<a name="l00484"></a><a class="code" href="AndroidUtils_8cpp.html#ac0ecdfe3fb97001fe047f56f385d0173">00484</a> <span class="keywordtype">void</span> <a class="code" href="AndroidUtils_8cpp.html#ac0ecdfe3fb97001fe047f56f385d0173">SetLastStringInput</a>( <span class="keywordtype">string</span> <a class="code" href="flash_2GLES_2glext_8h.html#ad585a1393cfa368fa9dc3d8ebff640d5">s</a> )
<a name="l00485"></a>00485 {
<a name="l00486"></a>00486         g_string = <a class="code" href="flash_2GLES_2glext_8h.html#ad585a1393cfa368fa9dc3d8ebff640d5">s</a>;
<a name="l00487"></a>00487 }
<a name="l00488"></a>00488 
<a name="l00489"></a><a class="code" href="PlatformEnums_8h.html#abf3b9c4cc1c16939d0be67eca2025c0c">00489</a> <a class="code" href="Renderer_2GL_2glext_8h.html#a06b88fc81ad0b30d1512e9609e3d7c82">std::string</a> <a class="code" href="AndroidUtils_8cpp.html#abf3b9c4cc1c16939d0be67eca2025c0c">GetLastStringInput</a>()
<a name="l00490"></a>00490 {
<a name="l00491"></a>00491         <span class="keywordflow">return</span> <a class="code" href="AndroidUtils_8cpp.html#ab5e544a0c665a2408d1db9920e74b471">g_string</a>;
<a name="l00492"></a>00492 }
<a name="l00493"></a>00493 
<a name="l00494"></a><a class="code" href="AndroidUtils_8cpp.html#afb0a6c30e87f95733f516e2ba49ee5f7">00494</a> <a class="code" href="PlatformEnums_8h.html#a3e3d37879cf6f3ed97af36cf5df9796a">eNetworkType</a> <a class="code" href="AndroidUtils_8cpp.html#afb0a6c30e87f95733f516e2ba49ee5f7">IsNetReachable</a>( <span class="keywordtype">string</span> url )
<a name="l00495"></a>00495 {
<a name="l00496"></a>00496         <span class="keywordflow">return</span> <a class="code" href="PlatformEnums_8h.html#a3e3d37879cf6f3ed97af36cf5df9796aa02d76eaedc1b4b906e200b00019ce1f2">C_NETWORK_WIFI</a>;
<a name="l00497"></a>00497 }
<a name="l00498"></a>00498 
<a name="l00499"></a><a class="code" href="PlatformEnums_8h.html#ad513237df8a4d5cc981cb9b8fd9bb1b4">00499</a> <span class="keywordtype">int</span> <a class="code" href="AndroidUtils_8cpp.html#ad513237df8a4d5cc981cb9b8fd9bb1b4">GetSystemData</a>()
<a name="l00500"></a>00500 {
<a name="l00501"></a>00501         <span class="keywordflow">return</span> C_PIRATED_NO;
<a name="l00502"></a>00502 }
<a name="l00503"></a>00503 
<a name="l00504"></a><a class="code" href="AndroidUtils_8cpp.html#a4cf9130da0fff38deef47f410af1d542">00504</a> <span class="keywordtype">void</span> <a class="code" href="AndroidUtils_8cpp.html#a4cf9130da0fff38deef47f410af1d542">RemoveFile</a>( <span class="keywordtype">string</span> fileName, <span class="keywordtype">bool</span> bAddSavePath)
<a name="l00505"></a>00505 {
<a name="l00506"></a>00506         
<a name="l00507"></a>00507         <span class="keywordflow">if</span> (bAddSavePath)
<a name="l00508"></a>00508         {
<a name="l00509"></a>00509                 fileName = <a class="code" href="AndroidUtils_8cpp.html#a4e3106af366a322b39c787e9fa98c478">GetSavePath</a>()+fileName;
<a name="l00510"></a>00510         }
<a name="l00511"></a>00511 
<a name="l00512"></a>00512         <span class="keywordflow">if</span> (unlink(fileName.c_str()) == -1)
<a name="l00513"></a>00513         {
<a name="l00514"></a>00514                 <span class="keywordflow">switch</span> (errno)
<a name="l00515"></a>00515                 {
<a name="l00516"></a>00516                 <span class="keywordflow">case</span> EACCES: 
<a name="l00517"></a>00517                         <a class="code" href="AndroidUtils_8cpp.html#aaa5c9bf2289dec09f59ef2b7ba6c66ae">LogMsg</a>(<span class="stringliteral">&quot;Warning: Unable to delete file %s, no access&quot;</span>, fileName.c_str());
<a name="l00518"></a>00518                         <span class="keywordflow">break</span>;
<a name="l00519"></a>00519                 <span class="keywordflow">case</span> EBUSY: 
<a name="l00520"></a>00520                         <a class="code" href="BaseApp_8cpp.html#a7217cebc0d5d71425d7b83154d38a4aa">LogError</a>(<span class="stringliteral">&quot;Warning: Unable to delete file %s, file is being used&quot;</span>, fileName.c_str());
<a name="l00521"></a>00521                         <span class="keywordflow">break</span>;
<a name="l00522"></a>00522                 <span class="keywordflow">case</span> EPERM: 
<a name="l00523"></a>00523                         <a class="code" href="AndroidUtils_8cpp.html#aaa5c9bf2289dec09f59ef2b7ba6c66ae">LogMsg</a>(<span class="stringliteral">&quot;Warning: Unable to delete file %s, may be a dir&quot;</span>, fileName.c_str());
<a name="l00524"></a>00524                         <span class="keywordflow">break</span>;
<a name="l00525"></a>00525                 <span class="keywordflow">case</span> EROFS: 
<a name="l00526"></a>00526                         <a class="code" href="AndroidUtils_8cpp.html#aaa5c9bf2289dec09f59ef2b7ba6c66ae">LogMsg</a>(<span class="stringliteral">&quot;Warning: Unable to delete file %s, File system is read only&quot;</span>, fileName.c_str());
<a name="l00527"></a>00527                         <span class="keywordflow">break</span>;
<a name="l00528"></a>00528                 <span class="keywordflow">default</span>:
<a name="l00529"></a>00529                         <span class="comment">//LogMsg(&quot;Warning: Unable to delete file %s, unknown error&quot;, fileName.c_str());</span>
<a name="l00530"></a>00530                         <span class="comment">//file doesn&#39;t exist</span>
<a name="l00531"></a>00531                         <span class="keywordflow">break</span>;
<a name="l00532"></a>00532                 }
<a name="l00533"></a>00533         }
<a name="l00534"></a>00534 }
<a name="l00535"></a>00535 
<a name="l00536"></a><a class="code" href="PlatformEnums_8h.html#ae8e9c4789478d1fa806cceb580533e2d">00536</a> <span class="keywordtype">string</span> <a class="code" href="AndroidUtils_8cpp.html#a50228c1eb3007896134f47c43d33078d">GetRegionString</a>()
<a name="l00537"></a>00537 {
<a name="l00538"></a>00538         JNIEnv *env = <a class="code" href="AndroidUtils_8cpp.html#a4ca0fd0590d9574c704f73f02f2132f0">GetJavaEnv</a>();
<a name="l00539"></a>00539         <span class="keywordflow">if</span> (!env) <span class="keywordflow">return</span> <span class="stringliteral">&quot;&quot;</span>;
<a name="l00540"></a>00540 
<a name="l00541"></a>00541         jclass cls = env-&gt;FindClass(<a class="code" href="AndroidUtils_8cpp.html#ac9a50169e053e3cc34462ba79bb0cbeb">GetAndroidMainClassName</a>());
<a name="l00542"></a>00542         jmethodID mid = env-&gt;GetStaticMethodID(cls,
<a name="l00543"></a>00543                 <span class="stringliteral">&quot;get_region&quot;</span>,
<a name="l00544"></a>00544                 <span class="stringliteral">&quot;()Ljava/lang/String;&quot;</span>);
<a name="l00545"></a>00545         jstring ret;
<a name="l00546"></a>00546         ret = (jstring)env-&gt;CallStaticObjectMethod(cls, mid);
<a name="l00547"></a>00547         <span class="keyword">const</span> <span class="keywordtype">char</span> * ss=env-&gt;GetStringUTFChars(ret,0);
<a name="l00548"></a>00548         <span class="keywordtype">string</span> <a class="code" href="flash_2GLES_2glext_8h.html#ad585a1393cfa368fa9dc3d8ebff640d5">s</a> = ss;
<a name="l00549"></a>00549         env-&gt;ReleaseStringUTFChars(ret, ss);
<a name="l00550"></a>00550         <span class="keywordflow">return</span> <a class="code" href="Renderer_2GL_2glext_8h.html#a06b88fc81ad0b30d1512e9609e3d7c82">string</a>(s);
<a name="l00551"></a>00551 }
<a name="l00552"></a>00552 
<a name="l00553"></a><a class="code" href="AndroidUtils_8cpp.html#aa33029c1f9a187fd145318e6bcf3067b">00553</a> <span class="keywordtype">bool</span> <a class="code" href="AndroidUtils_8cpp.html#aa33029c1f9a187fd145318e6bcf3067b">IsAppInstalled</a>(<span class="keywordtype">string</span> packageName)
<a name="l00554"></a>00554 {
<a name="l00555"></a>00555         JNIEnv *env = <a class="code" href="AndroidUtils_8cpp.html#a4ca0fd0590d9574c704f73f02f2132f0">GetJavaEnv</a>();
<a name="l00556"></a>00556         
<a name="l00557"></a>00557         <span class="keywordflow">if</span> (!env) <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00558"></a>00558         jclass cls = env-&gt;FindClass(<a class="code" href="AndroidUtils_8cpp.html#ac9a50169e053e3cc34462ba79bb0cbeb">GetAndroidMainClassName</a>());
<a name="l00559"></a>00559         jmethodID mid = env-&gt;GetStaticMethodID(cls,
<a name="l00560"></a>00560                 <span class="stringliteral">&quot;is_app_installed&quot;</span>,
<a name="l00561"></a>00561                 <span class="stringliteral">&quot;(Ljava/lang/String;)I&quot;</span>);
<a name="l00562"></a>00562         <span class="keywordflow">return</span> env-&gt;CallStaticIntMethod(cls, mid, env-&gt;NewStringUTF(packageName.c_str())) != 0;
<a name="l00563"></a>00563 }
<a name="l00564"></a>00564 
<a name="l00565"></a>00565 <span class="comment">//month is 1-12 btw</span>
<a name="l00566"></a><a class="code" href="AndroidUtils_8cpp.html#a165fd07b20e6e28b074d1f471e714d17">00566</a> <span class="keywordtype">int</span> <a class="code" href="AndroidUtils_8cpp.html#a165fd07b20e6e28b074d1f471e714d17">GetDaysSinceDate</a>(<span class="keywordtype">int</span> month,<span class="keywordtype">int</span> day, <span class="keywordtype">int</span> year)
<a name="l00567"></a>00567 {
<a name="l00568"></a>00568         <span class="comment">//LogMsg(&quot;GetDaysSinceDate url not done&quot;);</span>
<a name="l00569"></a>00569         assert(!<span class="stringliteral">&quot;no!&quot;</span>);
<a name="l00570"></a>00570         <span class="keywordflow">return</span> 0;
<a name="l00571"></a>00571 }
<a name="l00572"></a>00572 
<a name="l00573"></a><a class="code" href="AndroidUtils_8cpp.html#aa4681ca9ffee503016704cf81aaf7d59">00573</a> <span class="keywordtype">bool</span> <a class="code" href="AndroidUtils_8cpp.html#aa4681ca9ffee503016704cf81aaf7d59">RTCreateDirectory</a>(<span class="keyword">const</span> <a class="code" href="Renderer_2GL_2glext_8h.html#a06b88fc81ad0b30d1512e9609e3d7c82">std::string</a> &amp;dir_name)
<a name="l00574"></a>00574 {
<a name="l00575"></a>00575 <span class="preprocessor">#ifdef _DEBUG</span>
<a name="l00576"></a>00576 <span class="preprocessor"></span>        <a class="code" href="AndroidUtils_8cpp.html#aaa5c9bf2289dec09f59ef2b7ba6c66ae">LogMsg</a>(<span class="stringliteral">&quot;CreateDirectory: %s&quot;</span>, dir_name.c_str());
<a name="l00577"></a>00577 <span class="preprocessor">#endif</span>
<a name="l00578"></a>00578 <span class="preprocessor"></span>
<a name="l00579"></a>00579         <span class="keywordtype">string</span> temp = dir_name;
<a name="l00580"></a>00580         <a class="code" href="AndroidUtils_8cpp.html#a494540b6a324c775a277c53102744a71">CreateDirectoryRecursively</a>(<span class="stringliteral">&quot;&quot;</span>, temp);
<a name="l00581"></a>00581         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00582"></a>00582 }
<a name="l00583"></a>00583 
<a name="l00584"></a><a class="code" href="AndroidUtils_8cpp.html#a494540b6a324c775a277c53102744a71">00584</a> <span class="keywordtype">void</span> <a class="code" href="AndroidUtils_8cpp.html#a494540b6a324c775a277c53102744a71">CreateDirectoryRecursively</a>(<span class="keywordtype">string</span> basePath, <span class="keywordtype">string</span> <a class="code" href="Renderer_2GL_2glext_8h.html#a23ffbd2c127adf1c57bc2667fdedb1c9">path</a>)
<a name="l00585"></a>00585 {
<a name="l00586"></a>00586 <span class="preprocessor">#ifdef _DEBUG</span>
<a name="l00587"></a>00587 <span class="preprocessor"></span>        <span class="comment">//LogMsg(&quot;CreateDirectoryRecursively: %s, path is %s&quot;, basePath.c_str(), path.c_str());</span>
<a name="l00588"></a>00588 <span class="preprocessor">#endif</span>
<a name="l00589"></a>00589 <span class="preprocessor"></span>        
<a name="l00590"></a>00590         JNIEnv *env = <a class="code" href="AndroidUtils_8cpp.html#a4ca0fd0590d9574c704f73f02f2132f0">GetJavaEnv</a>();
<a name="l00591"></a>00591         <span class="keywordflow">if</span> (!env) <span class="keywordflow">return</span>;
<a name="l00592"></a>00592 
<a name="l00593"></a>00593         jclass cls = env-&gt;FindClass(<a class="code" href="AndroidUtils_8cpp.html#ac9a50169e053e3cc34462ba79bb0cbeb">GetAndroidMainClassName</a>());
<a name="l00594"></a>00594         jmethodID mid = env-&gt;GetStaticMethodID(cls,
<a name="l00595"></a>00595                 <span class="stringliteral">&quot;create_dir_recursively&quot;</span>,
<a name="l00596"></a>00596                 <span class="stringliteral">&quot;(Ljava/lang/String;Ljava/lang/String;)V&quot;</span>);
<a name="l00597"></a>00597         jstring ret;
<a name="l00598"></a>00598         env-&gt;CallStaticVoidMethod(cls, mid, env-&gt;NewStringUTF(basePath.c_str()), env-&gt;NewStringUTF(path.c_str()));
<a name="l00599"></a>00599         <span class="keywordflow">return</span>;
<a name="l00600"></a>00600 }
<a name="l00601"></a>00601 
<a name="l00602"></a>00602 
<a name="l00603"></a><a class="code" href="AndroidUtils_8cpp.html#a6050ac9f6fd64843ebe8a89342591033">00603</a> vector&lt;string&gt; <a class="code" href="AndroidUtils_8cpp.html#a6050ac9f6fd64843ebe8a89342591033">GetDirectoriesAtPath</a>(<span class="keywordtype">string</span> <a class="code" href="Renderer_2GL_2glext_8h.html#a23ffbd2c127adf1c57bc2667fdedb1c9">path</a>)
<a name="l00604"></a>00604 {
<a name="l00605"></a>00605         vector&lt;string&gt; <a class="code" href="Renderer_2GL_2glext_8h.html#a4568fc090febc136eed4577a600739ca">v</a>;
<a name="l00606"></a>00606         
<a name="l00607"></a>00607 <span class="preprocessor">#ifdef _DEBUG</span>
<a name="l00608"></a>00608 <span class="preprocessor"></span>        <span class="comment">//LogMsg(&quot;GetDirectoriesAtPath: %s&quot;, path.c_str());</span>
<a name="l00609"></a>00609 <span class="preprocessor">#endif</span>
<a name="l00610"></a>00610 <span class="preprocessor"></span>
<a name="l00611"></a>00611         dirent * <a class="code" href="Renderer_2GL_2glext_8h.html#aa3b73d9ca9f2e2396cbeae1ce6ce14be">buf</a>, * ent;
<a name="l00612"></a>00612         DIR *dp;
<a name="l00613"></a>00613 
<a name="l00614"></a>00614         dp = opendir(path.c_str());
<a name="l00615"></a>00615         <span class="keywordflow">if</span> (!dp)
<a name="l00616"></a>00616         {
<a name="l00617"></a>00617                 <a class="code" href="BaseApp_8cpp.html#a7217cebc0d5d71425d7b83154d38a4aa">LogError</a>(<span class="stringliteral">&quot;GetDirectoriesAtPath: opendir failed&quot;</span>);
<a name="l00618"></a>00618                 <span class="keywordflow">return</span> <a class="code" href="Renderer_2GL_2glext_8h.html#a4568fc090febc136eed4577a600739ca">v</a>;
<a name="l00619"></a>00619         }
<a name="l00620"></a>00620 
<a name="l00621"></a>00621         buf = (dirent*) malloc(<span class="keyword">sizeof</span>(dirent)+512);
<a name="l00622"></a>00622         <span class="keywordflow">while</span> (readdir_r(dp, buf, &amp;ent) == 0 &amp;&amp; ent)
<a name="l00623"></a>00623         {
<a name="l00624"></a>00624                 <span class="keywordflow">if</span> (ent-&gt;d_name[0] == <span class="charliteral">&#39;.&#39;</span> &amp;&amp; ent-&gt;d_name[1] == 0) <span class="keywordflow">continue</span>;
<a name="l00625"></a>00625                 <span class="keywordflow">if</span> (ent-&gt;d_name[0] == <span class="charliteral">&#39;.&#39;</span> &amp;&amp; ent-&gt;d_name[1] == <span class="charliteral">&#39;.&#39;</span> &amp;&amp; ent-&gt;d_name[2] == 0) <span class="keywordflow">continue</span>;
<a name="l00626"></a>00626 
<a name="l00627"></a>00627                 <span class="comment">//LogMsg(&quot;Got %s. type %d&quot;, ent-&gt;d_name, int(ent-&gt;d_type));</span>
<a name="l00628"></a>00628                 
<a name="l00629"></a>00629                 <span class="keywordflow">if</span> (ent-&gt;d_type == DT_DIR)
<a name="l00630"></a>00630                 {
<a name="l00631"></a>00631                         v.push_back(ent-&gt;d_name);
<a name="l00632"></a>00632                 }
<a name="l00633"></a>00633         }
<a name="l00634"></a>00634 
<a name="l00635"></a>00635         free (buf);
<a name="l00636"></a>00636         closedir(dp);
<a name="l00637"></a>00637         <span class="keywordflow">return</span> <a class="code" href="Renderer_2GL_2glext_8h.html#a4568fc090febc136eed4577a600739ca">v</a>;
<a name="l00638"></a>00638 }
<a name="l00639"></a>00639 
<a name="l00640"></a><a class="code" href="AndroidUtils_8cpp.html#ac5c21eb363be315a513d7426b0e3df92">00640</a> vector&lt;string&gt; <a class="code" href="AndroidUtils_8cpp.html#ac5c21eb363be315a513d7426b0e3df92">GetFilesAtPath</a>(<span class="keywordtype">string</span> <a class="code" href="Renderer_2GL_2glext_8h.html#a23ffbd2c127adf1c57bc2667fdedb1c9">path</a>)
<a name="l00641"></a>00641 {
<a name="l00642"></a>00642 <span class="preprocessor">#ifdef _DEBUG</span>
<a name="l00643"></a>00643 <span class="preprocessor"></span>        <span class="comment">//LogMsg(&quot;GetFilesAtPath: %s&quot;, path.c_str());</span>
<a name="l00644"></a>00644 <span class="preprocessor">#endif</span>
<a name="l00645"></a>00645 <span class="preprocessor"></span>
<a name="l00646"></a>00646         vector&lt;string&gt; <a class="code" href="Renderer_2GL_2glext_8h.html#a4568fc090febc136eed4577a600739ca">v</a>;
<a name="l00647"></a>00647         dirent * <a class="code" href="Renderer_2GL_2glext_8h.html#aa3b73d9ca9f2e2396cbeae1ce6ce14be">buf</a>, * ent;
<a name="l00648"></a>00648         DIR *dp;
<a name="l00649"></a>00649 
<a name="l00650"></a>00650         dp = opendir(path.c_str());
<a name="l00651"></a>00651         <span class="keywordflow">if</span> (!dp)
<a name="l00652"></a>00652         {
<a name="l00653"></a>00653                 <a class="code" href="BaseApp_8cpp.html#a7217cebc0d5d71425d7b83154d38a4aa">LogError</a>(<span class="stringliteral">&quot;GetDirectoriesAtPath: opendir failed&quot;</span>);
<a name="l00654"></a>00654                 <span class="keywordflow">return</span> <a class="code" href="Renderer_2GL_2glext_8h.html#a4568fc090febc136eed4577a600739ca">v</a>;
<a name="l00655"></a>00655         }
<a name="l00656"></a>00656 
<a name="l00657"></a>00657         buf = (dirent*) malloc(<span class="keyword">sizeof</span>(dirent)+512);
<a name="l00658"></a>00658         <span class="keywordflow">while</span> (readdir_r(dp, buf, &amp;ent) == 0 &amp;&amp; ent)
<a name="l00659"></a>00659         {
<a name="l00660"></a>00660                 <span class="keywordflow">if</span> (ent-&gt;d_name[0] == <span class="charliteral">&#39;.&#39;</span> &amp;&amp; ent-&gt;d_name[1] == 0) <span class="keywordflow">continue</span>;
<a name="l00661"></a>00661                 <span class="keywordflow">if</span> (ent-&gt;d_name[0] == <span class="charliteral">&#39;.&#39;</span> &amp;&amp; ent-&gt;d_name[1] == <span class="charliteral">&#39;.&#39;</span> &amp;&amp; ent-&gt;d_name[2] == 0) <span class="keywordflow">continue</span>;
<a name="l00662"></a>00662 
<a name="l00663"></a>00663                 <span class="comment">//LogMsg(&quot;Got %s. type %d&quot;, ent-&gt;d_name, int(ent-&gt;d_type));</span>
<a name="l00664"></a>00664                 <span class="keywordflow">if</span> (ent-&gt;d_type == DT_REG) <span class="comment">//regular file</span>
<a name="l00665"></a>00665                 {
<a name="l00666"></a>00666                         v.push_back(ent-&gt;d_name);
<a name="l00667"></a>00667                 }
<a name="l00668"></a>00668         }
<a name="l00669"></a>00669 
<a name="l00670"></a>00670         free (buf);
<a name="l00671"></a>00671         closedir(dp);
<a name="l00672"></a>00672         <span class="keywordflow">return</span> <a class="code" href="Renderer_2GL_2glext_8h.html#a4568fc090febc136eed4577a600739ca">v</a>;
<a name="l00673"></a>00673 }
<a name="l00674"></a>00674 
<a name="l00675"></a><a class="code" href="AndroidUtils_8cpp.html#a290da55a1f3b477b5da143d4975480ba">00675</a> <span class="keywordtype">bool</span> <a class="code" href="AndroidUtils_8cpp.html#a290da55a1f3b477b5da143d4975480ba">RemoveDirectoryRecursively</a>(<span class="keywordtype">string</span> <a class="code" href="Renderer_2GL_2glext_8h.html#a23ffbd2c127adf1c57bc2667fdedb1c9">path</a>)
<a name="l00676"></a>00676 {
<a name="l00677"></a>00677         <span class="comment">//LogMsg(&quot; RemoveDirectoryRecursively: %s&quot;, path.c_str());</span>
<a name="l00678"></a>00678         
<a name="l00679"></a>00679         dirent * <a class="code" href="Renderer_2GL_2glext_8h.html#aa3b73d9ca9f2e2396cbeae1ce6ce14be">buf</a>, * ent;
<a name="l00680"></a>00680         DIR *dp;
<a name="l00681"></a>00681 
<a name="l00682"></a>00682         dp = opendir(path.c_str());
<a name="l00683"></a>00683         <span class="keywordflow">if</span> (!dp)
<a name="l00684"></a>00684         {
<a name="l00685"></a>00685                 <a class="code" href="BaseApp_8cpp.html#a7217cebc0d5d71425d7b83154d38a4aa">LogError</a>(<span class="stringliteral">&quot;RemoveDirectoryRecursively: opendir failed&quot;</span>);
<a name="l00686"></a>00686                 <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00687"></a>00687         }
<a name="l00688"></a>00688 
<a name="l00689"></a>00689         buf = (dirent*) malloc(<span class="keyword">sizeof</span>(dirent)+512);
<a name="l00690"></a>00690         <span class="keywordflow">while</span> (readdir_r(dp, buf, &amp;ent) == 0 &amp;&amp; ent)
<a name="l00691"></a>00691         {
<a name="l00692"></a>00692                 
<a name="l00693"></a>00693                 <span class="keywordflow">if</span> (ent-&gt;d_name[0] == <span class="charliteral">&#39;.&#39;</span> &amp;&amp; ent-&gt;d_name[1] == 0) <span class="keywordflow">continue</span>;
<a name="l00694"></a>00694                 <span class="keywordflow">if</span> (ent-&gt;d_name[0] == <span class="charliteral">&#39;.&#39;</span> &amp;&amp; ent-&gt;d_name[1] == <span class="charliteral">&#39;.&#39;</span> &amp;&amp; ent-&gt;d_name[2] == 0) <span class="keywordflow">continue</span>;
<a name="l00695"></a>00695 
<a name="l00696"></a>00696                 <span class="comment">//LogMsg(&quot;Got %s. type %d&quot;, ent-&gt;d_name, int(ent-&gt;d_type));</span>
<a name="l00697"></a>00697                 <span class="keywordflow">if</span> (ent-&gt;d_type == DT_REG) <span class="comment">//regular file</span>
<a name="l00698"></a>00698                 {
<a name="l00699"></a>00699                         <span class="keywordtype">string</span> fName = path+<a class="code" href="Renderer_2GL_2glext_8h.html#a06b88fc81ad0b30d1512e9609e3d7c82">string</a>(<span class="stringliteral">&quot;/&quot;</span>)+ent-&gt;d_name;
<a name="l00700"></a>00700                         <span class="comment">//LogMsg(&quot;Deleting %s&quot;, fName.c_str());</span>
<a name="l00701"></a>00701                         unlink( fName.c_str());
<a name="l00702"></a>00702                 }
<a name="l00703"></a>00703 
<a name="l00704"></a>00704                 <span class="keywordflow">if</span> (ent-&gt;d_type == DT_DIR) <span class="comment">//regular file</span>
<a name="l00705"></a>00705                 {
<a name="l00706"></a>00706                         <span class="keywordtype">string</span> fName = path+<a class="code" href="Renderer_2GL_2glext_8h.html#a06b88fc81ad0b30d1512e9609e3d7c82">string</a>(<span class="stringliteral">&quot;/&quot;</span>)+ent-&gt;d_name;
<a name="l00707"></a>00707                         <span class="comment">//LogMsg(&quot;Entering DIR %s&quot;,fName.c_str());</span>
<a name="l00708"></a>00708                         <span class="keywordflow">if</span> (!<a class="code" href="AndroidUtils_8cpp.html#a290da55a1f3b477b5da143d4975480ba">RemoveDirectoryRecursively</a>(fName.c_str()))
<a name="l00709"></a>00709                         {
<a name="l00710"></a>00710                                 <a class="code" href="BaseApp_8cpp.html#a7217cebc0d5d71425d7b83154d38a4aa">LogError</a>(<span class="stringliteral">&quot;Error removing dir %s&quot;</span>, fName.c_str());
<a name="l00711"></a>00711                                 <span class="keywordflow">break</span>;
<a name="l00712"></a>00712                         }
<a name="l00713"></a>00713                 }
<a name="l00714"></a>00714         }
<a name="l00715"></a>00715 
<a name="l00716"></a>00716         free (buf);
<a name="l00717"></a>00717         closedir(dp);
<a name="l00718"></a>00718 
<a name="l00719"></a>00719         <span class="comment">//delete the final dir as well</span>
<a name="l00720"></a>00720         rmdir( path.c_str());
<a name="l00721"></a>00721         <span class="keywordflow">return</span> <span class="keyword">true</span>; <span class="comment">//success</span>
<a name="l00722"></a>00722 }
<a name="l00723"></a>00723 
<a name="l00724"></a><a class="code" href="AudioManager_8h.html#a0048dc067e95283990e66e63b410ee04">00724</a> <span class="keywordtype">bool</span> <a class="code" href="AndroidUtils_8cpp.html#a0048dc067e95283990e66e63b410ee04">CheckIfOtherAudioIsPlaying</a>()
<a name="l00725"></a>00725 {
<a name="l00726"></a>00726         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00727"></a>00727 }
<a name="l00728"></a>00728 
<a name="l00729"></a><a class="code" href="PlatformEnums_8h.html#a7799208d50e04441d1b4fdab17ce3423">00729</a> <span class="keywordtype">void</span> <a class="code" href="AndroidUtils_8cpp.html#a7799208d50e04441d1b4fdab17ce3423">CreateAppCacheDirIfNeeded</a>()
<a name="l00730"></a>00730 {
<a name="l00731"></a>00731   <span class="comment">//only applicable to iOS</span>
<a name="l00732"></a>00732 }
<a name="l00733"></a>00733 
<a name="l00734"></a><a class="code" href="PlatformEnums_8h.html#ac465c34ba2c31698c800b10b345d0db5">00734</a> <span class="keywordtype">void</span> <a class="code" href="AndroidUtils_8cpp.html#ac465c34ba2c31698c800b10b345d0db5">NotifyOSOfOrientationPreference</a>(<a class="code" href="PlatformEnums_8h.html#a02ed901e93e9d5ffb22fc6a2f0284f3d">eOrientationMode</a> orientation)
<a name="l00735"></a>00735 {
<a name="l00736"></a>00736 }
<a name="l00737"></a>00737 
<a name="l00738"></a><a class="code" href="PlatformEnums_8h.html#a3af1b7fbed86634a38c80dacd27a75b8">00738</a> <span class="keywordtype">bool</span> <a class="code" href="AndroidUtils_8cpp.html#a3af1b7fbed86634a38c80dacd27a75b8">HasVibration</a>()
<a name="l00739"></a>00739 {
<a name="l00740"></a>00740         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00741"></a>00741 }
<a name="l00742"></a>00742 
<a name="l00743"></a><a class="code" href="AndroidUtils_8h.html#a17da29f5f93763ef69b45d4d8d8e6648">00743</a> <span class="keywordtype">void</span> <a class="code" href="AndroidUtils_8cpp.html#a17da29f5f93763ef69b45d4d8d8e6648">AppResize</a>( JNIEnv*  env, jobject  thiz, jint <a class="code" href="Renderer_2GL_2glext_8h.html#adb12a0d439f32ca388b2c806150cc54d">w</a>, jint <a class="code" href="Renderer_2GL_2glext_8h.html#afa0fb1b5e976920c0abeff2dca3ed774">h</a> )
<a name="l00744"></a>00744 {
<a name="l00745"></a>00745         <a class="code" href="AndroidUtils_8cpp.html#abe9e7dbcabc78a04f12ff59d41ab409f">g_winVideoScreenX</a> = <a class="code" href="Renderer_2GL_2glext_8h.html#adb12a0d439f32ca388b2c806150cc54d">w</a>;
<a name="l00746"></a>00746         <a class="code" href="AndroidUtils_8cpp.html#ac443274c7cc3c314e8b0068cdfb8f3aa">g_winVideoScreenY</a> = <a class="code" href="Renderer_2GL_2glext_8h.html#afa0fb1b5e976920c0abeff2dca3ed774">h</a>;
<a name="l00747"></a>00747 <span class="preprocessor">#ifdef _DEBUG</span>
<a name="l00748"></a>00748 <span class="preprocessor"></span>        <a class="code" href="AndroidUtils_8cpp.html#aaa5c9bf2289dec09f59ef2b7ba6c66ae">LogMsg</a>(<span class="stringliteral">&quot;Resizing screen to %d %d&quot;</span>, w, h);
<a name="l00749"></a>00749 <span class="preprocessor">#endif</span>
<a name="l00750"></a>00750 <span class="preprocessor"></span>        
<a name="l00751"></a>00751         <span class="keywordflow">if</span> (!<a class="code" href="BaseApp_8h.html#a72086b48d24daf0a65dd20189a16bd16">GetBaseApp</a>()-&gt;IsInitted())
<a name="l00752"></a>00752         {
<a name="l00753"></a>00753                 <a class="code" href="RenderUtils_8cpp.html#adf9bef99a628dbdecbdec63b7695ff86">SetupScreenInfo</a>(<a class="code" href="AndroidUtils_8cpp.html#a2f0e58aac06a13b950cef03dcc3e7267">GetPrimaryGLX</a>(), <a class="code" href="AndroidUtils_8cpp.html#ac274a49195455502331eb617bce938e3">GetPrimaryGLY</a>(), <a class="code" href="PlatformEnums_8h.html#a02ed901e93e9d5ffb22fc6a2f0284f3dacd00a965397a558275015a84f2f22dd5">ORIENTATION_PORTRAIT</a>);
<a name="l00754"></a>00754                 <a class="code" href="AndroidUtils_8cpp.html#aaa5c9bf2289dec09f59ef2b7ba6c66ae">LogMsg</a>(<span class="stringliteral">&quot;Initializing BaseApp.  APK filename is %s&quot;</span>, <a class="code" href="AndroidUtils_8cpp.html#a841faf6a931d182ad97a7a1c4af79e61">GetAPKFile</a>().c_str());
<a name="l00755"></a>00755                 srand( (<span class="keywordtype">unsigned</span>)time(NULL) );
<a name="l00756"></a>00756                 <a class="code" href="classFileSystemZip.html">FileSystemZip</a> *pFileSystem = <span class="keyword">new</span> <a class="code" href="classFileSystemZip.html">FileSystemZip</a>();
<a name="l00757"></a>00757 <span class="preprocessor">#ifdef _DEBUG</span>
<a name="l00758"></a>00758 <span class="preprocessor"></span>                <a class="code" href="AndroidUtils_8cpp.html#aaa5c9bf2289dec09f59ef2b7ba6c66ae">LogMsg</a>(<span class="stringliteral">&quot;Filesystem new&#39;ed&quot;</span>);
<a name="l00759"></a>00759 <span class="preprocessor">#endif</span>
<a name="l00760"></a>00760 <span class="preprocessor"></span>                <span class="keywordflow">if</span> (!pFileSystem-&gt;<a class="code" href="classFileSystemZip.html#a83c91ae750f0c884e08a993486714165">Init</a>(<a class="code" href="AndroidUtils_8cpp.html#a841faf6a931d182ad97a7a1c4af79e61">GetAPKFile</a>()))
<a name="l00761"></a>00761                 {
<a name="l00762"></a>00762                         <a class="code" href="AndroidUtils_8cpp.html#aaa5c9bf2289dec09f59ef2b7ba6c66ae">LogMsg</a>(<span class="stringliteral">&quot;Error finding APK file to load resources (%s&quot;</span>, <a class="code" href="AndroidUtils_8cpp.html#a841faf6a931d182ad97a7a1c4af79e61">GetAPKFile</a>().c_str());
<a name="l00763"></a>00763                 }
<a name="l00764"></a>00764 
<a name="l00765"></a>00765 <span class="preprocessor">#ifdef _DEBUG</span>
<a name="l00766"></a>00766 <span class="preprocessor"></span>        <a class="code" href="AndroidUtils_8cpp.html#aaa5c9bf2289dec09f59ef2b7ba6c66ae">LogMsg</a>(<span class="stringliteral">&quot;APK based Filesystem mounted.&quot;</span>);
<a name="l00767"></a>00767 <span class="preprocessor">#endif</span>
<a name="l00768"></a>00768 <span class="preprocessor"></span>                <span class="comment">/*</span>
<a name="l00769"></a>00769 <span class="comment">                vector&lt;string&gt; contents = pFileSystem-&gt;GetContents();</span>
<a name="l00770"></a>00770 <span class="comment">                for (int i=0; i &lt; contents.size(); i++)</span>
<a name="l00771"></a>00771 <span class="comment">                {</span>
<a name="l00772"></a>00772 <span class="comment">                LogMsg(&quot;%s&quot;, contents[i].c_str());</span>
<a name="l00773"></a>00773 <span class="comment">                }</span>
<a name="l00774"></a>00774 <span class="comment">                */</span>
<a name="l00775"></a>00775 
<a name="l00776"></a>00776                 pFileSystem-&gt;<a class="code" href="classFileSystemZip.html#a99ebc877e38be7766ae21b9ef29f5cd0">SetRootDirectory</a>(<span class="stringliteral">&quot;assets&quot;</span>);
<a name="l00777"></a>00777 
<a name="l00778"></a>00778                 <a class="code" href="BaseApp_8h.html#a2a28a70107383bd6d326aee251acc407">GetFileManager</a>()-&gt;<a class="code" href="classFileManager.html#a049f60695c27a4a6650820d260e3e16c">MountFileSystem</a>(pFileSystem);
<a name="l00779"></a>00779                 <a class="code" href="AndroidUtils_8cpp.html#aaa5c9bf2289dec09f59ef2b7ba6c66ae">LogMsg</a>(<span class="stringliteral">&quot;Assets mounted&quot;</span>);
<a name="l00780"></a>00780 
<a name="l00781"></a>00781                 <span class="keywordflow">if</span> (!<a class="code" href="BaseApp_8h.html#a72086b48d24daf0a65dd20189a16bd16">GetBaseApp</a>()-&gt;Init())
<a name="l00782"></a>00782                 {
<a name="l00783"></a>00783                         <a class="code" href="AndroidUtils_8cpp.html#aaa5c9bf2289dec09f59ef2b7ba6c66ae">LogMsg</a>(<span class="stringliteral">&quot;Unable to initalize BaseApp&quot;</span>);
<a name="l00784"></a>00784                 }
<a name="l00785"></a>00785 
<a name="l00786"></a>00786 
<a name="l00787"></a>00787                 <span class="comment">//let&#39;s also create our save directory on the sd card if needed, so we don&#39;t get errors when just assuming we can save</span>
<a name="l00788"></a>00788                 <span class="comment">//settings later in the app.</span>
<a name="l00789"></a>00789 
<a name="l00790"></a>00790                 <a class="code" href="AndroidUtils_8cpp.html#a494540b6a324c775a277c53102744a71">CreateDirectoryRecursively</a>(<span class="stringliteral">&quot;&quot;</span>, <a class="code" href="AndroidUtils_8cpp.html#a1e846bfaa9134978cccba41f9070efeb">GetAppCachePath</a>());
<a name="l00791"></a>00791 
<a name="l00792"></a>00792 
<a name="l00793"></a>00793         }
<a name="l00794"></a>00794 
<a name="l00795"></a>00795         <a class="code" href="BaseApp_8h.html#a72086b48d24daf0a65dd20189a16bd16">GetBaseApp</a>()-&gt;<a class="code" href="classBaseApp.html#a35a9a8c9a69a37339d8cb84a108b2cd6">OnScreenSizeChange</a>();
<a name="l00796"></a>00796 };
<a name="l00797"></a>00797 
<a name="l00798"></a><a class="code" href="AndroidUtils_8h.html#a601b38f8a3a49180e07a75c9ea355969">00798</a> <span class="keywordtype">void</span> <a class="code" href="AndroidUtils_8cpp.html#a601b38f8a3a49180e07a75c9ea355969">AppRender</a>(JNIEnv*  env)
<a name="l00799"></a>00799 {
<a name="l00800"></a>00800         <span class="keywordflow">if</span> (<a class="code" href="BaseApp_8h.html#a72086b48d24daf0a65dd20189a16bd16">GetBaseApp</a>()-&gt;IsInBackground() || <a class="code" href="AndroidUtils_8cpp.html#a6f0e75467c30e284e8896d21a2f7ff1f">g_pauseASAP</a>) <span class="keywordflow">return</span>;
<a name="l00801"></a>00801 
<a name="l00802"></a>00802         <a class="code" href="flash_2GLES_2gl_8h.html#a5eb920920346e3fbe09467275a700b07">glViewport</a>(0, 0, <a class="code" href="AndroidUtils_8cpp.html#a2f0e58aac06a13b950cef03dcc3e7267">GetPrimaryGLX</a>(), <a class="code" href="AndroidUtils_8cpp.html#ac274a49195455502331eb617bce938e3">GetPrimaryGLY</a>());
<a name="l00803"></a>00803         <a class="code" href="BaseApp_8h.html#a72086b48d24daf0a65dd20189a16bd16">GetBaseApp</a>()-&gt;<a class="code" href="classBaseApp.html#a373ff81f7946181429f4e8fea43cd1ce">Draw</a>();
<a name="l00804"></a>00804         <span class="comment">//appRender(0, sWindowWidth, sWindowHeight);</span>
<a name="l00805"></a>00805 }
<a name="l00806"></a>00806 
<a name="l00807"></a><a class="code" href="AndroidUtils_8h.html#ad5aaa356c32a3392d7da031a53c7d4aa">00807</a> <span class="keywordtype">void</span> <a class="code" href="AndroidUtils_8cpp.html#ad5aaa356c32a3392d7da031a53c7d4aa">AppUpdate</a>(JNIEnv*  env)
<a name="l00808"></a>00808 {
<a name="l00809"></a>00809         
<a name="l00810"></a>00810         <span class="keywordflow">if</span> (<a class="code" href="AndroidUtils_8cpp.html#a6f0e75467c30e284e8896d21a2f7ff1f">g_pauseASAP</a>)
<a name="l00811"></a>00811         {
<a name="l00812"></a>00812                 <a class="code" href="AndroidUtils_8cpp.html#a6f0e75467c30e284e8896d21a2f7ff1f">g_pauseASAP</a> = <span class="keyword">false</span>;    
<a name="l00813"></a>00813 
<a name="l00814"></a>00814                 <a class="code" href="AndroidUtils_8cpp.html#aaa5c9bf2289dec09f59ef2b7ba6c66ae">LogMsg</a>(<span class="stringliteral">&quot;Pause&quot;</span>);
<a name="l00815"></a>00815 
<a name="l00816"></a>00816                 <a class="code" href="BaseApp_8h.html#a72086b48d24daf0a65dd20189a16bd16">GetBaseApp</a>()-&gt;<a class="code" href="classBaseApp.html#a9809967f0001d2d51a2b3fcf2d2ef14a" title="Signal to notify that it&#39;s time to release surfaces.">m_sig_unloadSurfaces</a>();
<a name="l00817"></a>00817                 <a class="code" href="AndroidUtils_8cpp.html#adc4a7de1d86174736d817209e60db6a8">g_bSurfacesUnloaded</a> = <span class="keyword">true</span>;
<a name="l00818"></a>00818                 <a class="code" href="BaseApp_8h.html#a72086b48d24daf0a65dd20189a16bd16">GetBaseApp</a>()-&gt;<a class="code" href="classBaseApp.html#aeddf8ac355a68f59350c05f64b7b9efb">OnEnterBackground</a>();
<a name="l00819"></a>00819 
<a name="l00820"></a>00820                 <a class="code" href="BaseApp_8h.html#ae540dadab1f412451b29de16f58ab139">GetAudioManager</a>()-&gt;<a class="code" href="classAudioManager.html#a6a693832771af20eb24b1562810dc342">Kill</a>();
<a name="l00821"></a>00821                 
<a name="l00822"></a>00822                 <span class="keywordflow">return</span>;
<a name="l00823"></a>00823         }
<a name="l00824"></a>00824 
<a name="l00825"></a>00825         <span class="keywordflow">if</span> (<a class="code" href="AndroidUtils_8cpp.html#a0a0d717b190c6d78d1d9dd4e56762370">g_callAppResumeASAPTimer</a> != 0 &amp;&amp; <a class="code" href="AndroidUtils_8cpp.html#a0a0d717b190c6d78d1d9dd4e56762370">g_callAppResumeASAPTimer</a> &lt; <a class="code" href="AndroidUtils_8cpp.html#a702ae5b60fcc304afff9622752d8ee74">GetSystemTimeTick</a>())
<a name="l00826"></a>00826         {
<a name="l00827"></a>00827 <span class="preprocessor">#ifdef _DEBUG</span>
<a name="l00828"></a>00828 <span class="preprocessor"></span>                <a class="code" href="AndroidUtils_8cpp.html#aaa5c9bf2289dec09f59ef2b7ba6c66ae">LogMsg</a>(<span class="stringliteral">&quot;Resuming at %u (timer was %u)&quot;</span>, <a class="code" href="AndroidUtils_8cpp.html#a702ae5b60fcc304afff9622752d8ee74">GetSystemTimeTick</a>(), <a class="code" href="AndroidUtils_8cpp.html#a0a0d717b190c6d78d1d9dd4e56762370">g_callAppResumeASAPTimer</a>);
<a name="l00829"></a>00829 <span class="preprocessor">#endif</span>
<a name="l00830"></a>00830 <span class="preprocessor"></span>                <a class="code" href="AndroidUtils_8cpp.html#a0a0d717b190c6d78d1d9dd4e56762370">g_callAppResumeASAPTimer</a> = 0;
<a name="l00831"></a>00831                 <a class="code" href="BaseApp_8h.html#a72086b48d24daf0a65dd20189a16bd16">GetBaseApp</a>()-&gt;<a class="code" href="classBaseApp.html#a4a1bb54245313e867b3df65f6e6b0c11">OnEnterForeground</a>();
<a name="l00832"></a>00832                 <a class="code" href="BaseApp_8h.html#ae540dadab1f412451b29de16f58ab139">GetAudioManager</a>()-&gt;<a class="code" href="classAudioManager.html#a8b3436782f316a1cd5110d77c02f855e">Init</a>();
<a name="l00833"></a>00833 
<a name="l00834"></a>00834                 <span class="keywordflow">if</span> (!<a class="code" href="AndroidUtils_8cpp.html#a058ba35f5bef2a9148e3fbfdcb9bfb44">g_musicToPlay</a>.empty())
<a name="l00835"></a>00835                 {
<a name="l00836"></a>00836                         <a class="code" href="BaseApp_8h.html#ae540dadab1f412451b29de16f58ab139">GetAudioManager</a>()-&gt;<a class="code" href="classAudioManager.html#a2c144fcd407dae864d60b9aa8cb62726" title="Plays an audio specified by a file name.">Play</a>(<a class="code" href="AndroidUtils_8cpp.html#a058ba35f5bef2a9148e3fbfdcb9bfb44">g_musicToPlay</a>, <a class="code" href="BaseApp_8h.html#ae540dadab1f412451b29de16f58ab139">GetAudioManager</a>()-&gt;GetLastMusicLooping(), <span class="keyword">true</span>, <span class="keyword">false</span>, <span class="keyword">true</span>);
<a name="l00837"></a>00837                         <a class="code" href="BaseApp_8h.html#ae540dadab1f412451b29de16f58ab139">GetAudioManager</a>()-&gt;<a class="code" href="classAudioManager.html#afdf8bb72dc84bc8c207756499bb7b06e">SetPos</a>(<a class="code" href="BaseApp_8h.html#ae540dadab1f412451b29de16f58ab139">GetAudioManager</a>()-&gt;GetLastMusicID(), <a class="code" href="AndroidUtils_8cpp.html#a396b630dab833dd0a13e2cc814330519">g_musicPos</a>);
<a name="l00838"></a>00838                 }
<a name="l00839"></a>00839 
<a name="l00840"></a>00840         }
<a name="l00841"></a>00841 
<a name="l00842"></a>00842         <span class="keywordflow">if</span> (<a class="code" href="BaseApp_8h.html#a72086b48d24daf0a65dd20189a16bd16">GetBaseApp</a>()-&gt;IsInBackground()) <span class="keywordflow">return</span>;
<a name="l00843"></a>00843         
<a name="l00844"></a>00844         <span class="keywordflow">if</span> (<a class="code" href="AndroidUtils_8cpp.html#adc4a7de1d86174736d817209e60db6a8">g_bSurfacesUnloaded</a>)
<a name="l00845"></a>00845         {
<a name="l00846"></a>00846                 <span class="comment">//this is a work around for a problem where surfaces don&#39;t get reloaded on the Xoom right after IAB is used</span>
<a name="l00847"></a>00847                 <span class="keywordflow">if</span> (IsXoomSize)
<a name="l00848"></a>00848                 {
<a name="l00849"></a>00849                         <a class="code" href="AndroidUtils_8cpp.html#adc4a7de1d86174736d817209e60db6a8">g_bSurfacesUnloaded</a> = <span class="keyword">false</span>;
<a name="l00850"></a>00850                 }
<a name="l00851"></a>00851                 <a class="code" href="AndroidUtils_8cpp.html#a943b36472e81f4444db64f382c67a775">AppInit</a>(NULL);
<a name="l00852"></a>00852         }
<a name="l00853"></a>00853 
<a name="l00854"></a>00854         <a class="code" href="BaseApp_8h.html#a72086b48d24daf0a65dd20189a16bd16">GetBaseApp</a>()-&gt;<a class="code" href="classBaseApp.html#a6f7b9dab5bee920cf727acca823a9bea">Update</a>();
<a name="l00855"></a>00855 }
<a name="l00856"></a>00856 
<a name="l00857"></a><a class="code" href="AndroidUtils_8h.html#ad7a20a2b2256f04239a7dcc7d82464e4">00857</a> <span class="keywordtype">void</span> <a class="code" href="AndroidUtils_8cpp.html#ad7a20a2b2256f04239a7dcc7d82464e4">AppDone</a>(JNIEnv*  env)
<a name="l00858"></a>00858 {
<a name="l00859"></a>00859         <a class="code" href="AndroidUtils_8cpp.html#aaa5c9bf2289dec09f59ef2b7ba6c66ae">LogMsg</a>(<span class="stringliteral">&quot;Killing base app.&quot;</span>);
<a name="l00860"></a>00860         <span class="keywordflow">if</span> (<a class="code" href="BaseApp_8cpp.html#aef043c38b21bf52ff43fbca27a6cadb0">IsBaseAppInitted</a>())
<a name="l00861"></a>00861                 <a class="code" href="BaseApp_8h.html#a72086b48d24daf0a65dd20189a16bd16">GetBaseApp</a>()-&gt;<a class="code" href="classBaseApp.html#ae54f1d4fefdc2998cfc2cb3d8cd40c36">Kill</a>();
<a name="l00862"></a>00862 }
<a name="l00863"></a>00863 
<a name="l00864"></a><a class="code" href="AndroidUtils_8h.html#a884cfab86ce3a4a6e976dc0b9c283743">00864</a> <span class="keywordtype">void</span> <a class="code" href="AndroidUtils_8cpp.html#a884cfab86ce3a4a6e976dc0b9c283743">AppPause</a>(JNIEnv*  env)
<a name="l00865"></a>00865 {
<a name="l00866"></a>00866         
<a name="l00867"></a>00867         <span class="comment">//instead of pausing right now and dealing with thread problems, schedule it to happen</span>
<a name="l00868"></a>00868         <span class="comment">//in the main update.  We will kill the sound now though.</span>
<a name="l00869"></a>00869 
<a name="l00870"></a>00870         <span class="comment">//Note: Thread update isn&#39;t going to happen until they COME back, which means we aren&#39;t killing</span>
<a name="l00871"></a>00871         <span class="comment">//all used textures.  But this fixes problems with the engine trying to reload textures as it</span>
<a name="l00872"></a>00872         <span class="comment">//notices they are killed because the pause is run concurrently with the game update/render</span>
<a name="l00873"></a>00873         <span class="comment">//thread going.</span>
<a name="l00874"></a>00874 
<a name="l00875"></a>00875         <span class="comment">//We will kill/restore lost surfaces when the app is restored so we are still ok with v1.6</span>
<a name="l00876"></a>00876 
<a name="l00877"></a>00877         <span class="comment">//This also means we might not be saving the game until we return which is sort of weird, but</span>
<a name="l00878"></a>00878         <span class="comment">//I don&#39;t think Android users really expect that to happen anyway</span>
<a name="l00879"></a>00879 
<a name="l00880"></a>00880         <span class="keywordflow">if</span> (<a class="code" href="AndroidUtils_8cpp.html#a6f0e75467c30e284e8896d21a2f7ff1f">g_pauseASAP</a>)
<a name="l00881"></a>00881         {
<a name="l00882"></a>00882                 <a class="code" href="AndroidUtils_8cpp.html#aaa5c9bf2289dec09f59ef2b7ba6c66ae">LogMsg</a>(<span class="stringliteral">&quot;Got android AppPause, ignoring as we&#39;ve already triggered it&quot;</span>);
<a name="l00883"></a>00883                 <span class="keywordflow">return</span>;
<a name="l00884"></a>00884         }
<a name="l00885"></a>00885 <span class="preprocessor">#ifdef _DEBUG</span>
<a name="l00886"></a>00886 <span class="preprocessor"></span>        <a class="code" href="AndroidUtils_8cpp.html#aaa5c9bf2289dec09f59ef2b7ba6c66ae">LogMsg</a>(<span class="stringliteral">&quot;Got android AppPause&quot;</span>);
<a name="l00887"></a>00887 <span class="preprocessor">#endif</span>
<a name="l00888"></a>00888 <span class="preprocessor"></span>
<a name="l00889"></a>00889         <a class="code" href="AndroidUtils_8cpp.html#a6f0e75467c30e284e8896d21a2f7ff1f">g_pauseASAP</a> = <span class="keyword">true</span>;
<a name="l00890"></a>00890 
<a name="l00891"></a>00891         <span class="keywordflow">if</span> (<a class="code" href="BaseApp_8h.html#ae540dadab1f412451b29de16f58ab139">GetAudioManager</a>()-&gt;IsPlaying(<a class="code" href="BaseApp_8h.html#ae540dadab1f412451b29de16f58ab139">GetAudioManager</a>()-&gt;GetLastMusicID()))
<a name="l00892"></a>00892         {
<a name="l00893"></a>00893                 <a class="code" href="AndroidUtils_8cpp.html#a058ba35f5bef2a9148e3fbfdcb9bfb44">g_musicToPlay</a> = <a class="code" href="BaseApp_8h.html#ae540dadab1f412451b29de16f58ab139">GetAudioManager</a>()-&gt;<a class="code" href="classAudioManager.html#a3b6cb4ed917b261be7fce483100d4d90" title="Gets the name of the file that was last played as music.">GetLastMusicFileName</a>();
<a name="l00894"></a>00894                 <a class="code" href="AndroidUtils_8cpp.html#a396b630dab833dd0a13e2cc814330519">g_musicPos</a> = <a class="code" href="BaseApp_8h.html#ae540dadab1f412451b29de16f58ab139">GetAudioManager</a>()-&gt;<a class="code" href="classAudioManager.html#ae32bb8ff62fd29b72ec13de66a98e68a">GetPos</a>(<a class="code" href="BaseApp_8h.html#ae540dadab1f412451b29de16f58ab139">GetAudioManager</a>()-&gt;GetLastMusicID());
<a name="l00895"></a>00895         } <span class="keywordflow">else</span>
<a name="l00896"></a>00896         {
<a name="l00897"></a>00897                 <a class="code" href="AndroidUtils_8cpp.html#a058ba35f5bef2a9148e3fbfdcb9bfb44">g_musicToPlay</a>.clear();
<a name="l00898"></a>00898                 <a class="code" href="AndroidUtils_8cpp.html#a396b630dab833dd0a13e2cc814330519">g_musicPos</a> = 0;
<a name="l00899"></a>00899 
<a name="l00900"></a>00900         }
<a name="l00901"></a>00901         
<a name="l00902"></a>00902         <a class="code" href="BaseApp_8h.html#a72086b48d24daf0a65dd20189a16bd16">GetBaseApp</a>()-&gt;<a class="code" href="classBaseApp.html#ae34181fc70304a3fababcbbdcbfa6dfe" title="Early signal that we are about to enter background.">m_sig_pre_enterbackground</a>(NULL); <span class="comment">//I needed this to kill audio in a custom way, but we still</span>
<a name="l00903"></a>00903         <span class="comment">//shouldn&#39;t do anything else or we risk android conflicts</span>
<a name="l00904"></a>00904 
<a name="l00905"></a>00905         <a class="code" href="BaseApp_8h.html#ae540dadab1f412451b29de16f58ab139">GetAudioManager</a>()-&gt;<a class="code" href="classAudioManager.html#a6a693832771af20eb24b1562810dc342">Kill</a>();
<a name="l00906"></a>00906 
<a name="l00907"></a>00907 }
<a name="l00908"></a><a class="code" href="AndroidUtils_8h.html#a6e46aea018aa7c9d24a4a6ffa6085e7a">00908</a> <span class="keywordtype">void</span> <a class="code" href="AndroidUtils_8cpp.html#a6e46aea018aa7c9d24a4a6ffa6085e7a">AppResume</a>(JNIEnv*  env)
<a name="l00909"></a>00909 {
<a name="l00910"></a>00910 
<a name="l00911"></a>00911         <a class="code" href="AndroidUtils_8cpp.html#a0a0d717b190c6d78d1d9dd4e56762370">g_callAppResumeASAPTimer</a> = <a class="code" href="AndroidUtils_8cpp.html#a702ae5b60fcc304afff9622752d8ee74">GetSystemTimeTick</a>() + C_DELAY_BEFORE_RESTORING_SURFACES_MS;
<a name="l00912"></a>00912 <span class="preprocessor">#ifdef _DEBUG</span>
<a name="l00913"></a>00913 <span class="preprocessor"></span>        <a class="code" href="AndroidUtils_8cpp.html#aaa5c9bf2289dec09f59ef2b7ba6c66ae">LogMsg</a>(<span class="stringliteral">&quot;Queuing resume: %u (now is %u)&quot;</span>, <a class="code" href="AndroidUtils_8cpp.html#a0a0d717b190c6d78d1d9dd4e56762370">g_callAppResumeASAPTimer</a>, <a class="code" href="BaseApp_8cpp.html#a8335cabda3b97e427d7e0dfdc71f5591">GetTick</a>(<a class="code" href="MessageManager_8h.html#a6ccdae1e5bdcea24cc3c7a814445e196a1f41a724a7ed2283070514f600166e04">TIMER_SYSTEM</a>));
<a name="l00914"></a>00914 <span class="preprocessor">#endif</span>
<a name="l00915"></a>00915 <span class="preprocessor"></span>}
<a name="l00916"></a>00916 
<a name="l00917"></a><a class="code" href="AndroidUtils_8h.html#a943b36472e81f4444db64f382c67a775">00917</a> <span class="keywordtype">void</span> <a class="code" href="AndroidUtils_8cpp.html#a943b36472e81f4444db64f382c67a775">AppInit</a>(JNIEnv*  env)
<a name="l00918"></a>00918 {
<a name="l00919"></a>00919         <span class="comment">//happens after the gl surface is initialized</span>
<a name="l00920"></a>00920 
<a name="l00921"></a>00921         <a class="code" href="AndroidUtils_8cpp.html#aaa5c9bf2289dec09f59ef2b7ba6c66ae">LogMsg</a>(<span class="stringliteral">&quot;Initialized GL surfaces for game&quot;</span>);
<a name="l00922"></a>00922         <a class="code" href="BaseApp_8h.html#a72086b48d24daf0a65dd20189a16bd16">GetBaseApp</a>()-&gt;<a class="code" href="classBaseApp.html#acbdde2bb959d5abd2db84a71ef4cfcee">InitializeGLDefaults</a>();
<a name="l00923"></a>00923         <a class="code" href="AndroidUtils_8cpp.html#aaa5c9bf2289dec09f59ef2b7ba6c66ae">LogMsg</a>(<span class="stringliteral">&quot;gl defaults set&quot;</span>);
<a name="l00924"></a>00924         <a class="code" href="BaseApp_8h.html#a72086b48d24daf0a65dd20189a16bd16">GetBaseApp</a>()-&gt;<a class="code" href="classBaseApp.html#a35a9a8c9a69a37339d8cb84a108b2cd6">OnScreenSizeChange</a>();
<a name="l00925"></a>00925         <a class="code" href="AndroidUtils_8cpp.html#aaa5c9bf2289dec09f59ef2b7ba6c66ae">LogMsg</a>(<span class="stringliteral">&quot;OnScreensizechange done&quot;</span>);
<a name="l00926"></a>00926         <span class="keywordflow">if</span> (<a class="code" href="AndroidUtils_8cpp.html#adc4a7de1d86174736d817209e60db6a8">g_bSurfacesUnloaded</a>)
<a name="l00927"></a>00927         {
<a name="l00928"></a>00928                 <a class="code" href="BaseApp_8h.html#a72086b48d24daf0a65dd20189a16bd16">GetBaseApp</a>()-&gt;<a class="code" href="classBaseApp.html#a4363b54dd50f8cc4200e4b195f066086" title="Signal to notify that it&#39;s time to reload surfaces.">m_sig_loadSurfaces</a>(); 
<a name="l00929"></a>00929                 <a class="code" href="AndroidUtils_8cpp.html#adc4a7de1d86174736d817209e60db6a8">g_bSurfacesUnloaded</a> = <span class="keyword">false</span>;
<a name="l00930"></a>00930         }
<a name="l00931"></a>00931         <a class="code" href="AndroidUtils_8cpp.html#aaa5c9bf2289dec09f59ef2b7ba6c66ae">LogMsg</a>(<span class="stringliteral">&quot;Surfaces loaded&quot;</span>);
<a name="l00932"></a>00932 
<a name="l00933"></a>00933 }
<a name="l00934"></a>00934 
<a name="l00935"></a>00935 
<a name="l00936"></a>00936 
<a name="l00937"></a><a class="code" href="AndroidUtils_8cpp.html#aaf19aa46f352ca0ecb9c36d17967a99f">00937</a> <span class="keyword">enum</span> <a class="code" href="AndroidUtils_8cpp.html#aaf19aa46f352ca0ecb9c36d17967a99f">eAndroidActions</a>
<a name="l00938"></a>00938 {
<a name="l00939"></a><a class="code" href="AndroidUtils_8cpp.html#aaf19aa46f352ca0ecb9c36d17967a99fa8d27643b75eb9ca027a8c1b6d6f145f5">00939</a>         <a class="code" href="AndroidUtils_8cpp.html#aaf19aa46f352ca0ecb9c36d17967a99fa8d27643b75eb9ca027a8c1b6d6f145f5">ACTION_DOWN</a>,
<a name="l00940"></a><a class="code" href="AndroidUtils_8cpp.html#aaf19aa46f352ca0ecb9c36d17967a99fa8c684c62d0b5488a8938a868c3b9ada3">00940</a>         <a class="code" href="AndroidUtils_8cpp.html#aaf19aa46f352ca0ecb9c36d17967a99fa8c684c62d0b5488a8938a868c3b9ada3">ACTION_UP</a>,
<a name="l00941"></a><a class="code" href="AndroidUtils_8cpp.html#aaf19aa46f352ca0ecb9c36d17967a99fa28a70050a91a75e0af79e70c1ad74ca0">00941</a>         <a class="code" href="AndroidUtils_8cpp.html#aaf19aa46f352ca0ecb9c36d17967a99fa28a70050a91a75e0af79e70c1ad74ca0">ACTION_MOVE</a>,
<a name="l00942"></a><a class="code" href="AndroidUtils_8cpp.html#aaf19aa46f352ca0ecb9c36d17967a99faac84a613dbd1a12b1343d4ababdaa37c">00942</a>         <a class="code" href="AndroidUtils_8cpp.html#aaf19aa46f352ca0ecb9c36d17967a99faac84a613dbd1a12b1343d4ababdaa37c">ACTION_CANCEL</a>,
<a name="l00943"></a><a class="code" href="AndroidUtils_8cpp.html#aaf19aa46f352ca0ecb9c36d17967a99fa10d59450e39773f318ff9fea816aa6b4">00943</a>         <a class="code" href="AndroidUtils_8cpp.html#aaf19aa46f352ca0ecb9c36d17967a99fa10d59450e39773f318ff9fea816aa6b4">ACTION_OUTSIDE</a>,
<a name="l00944"></a>00944 };
<a name="l00945"></a>00945 
<a name="l00946"></a><a class="code" href="AndroidUtils_8h.html#ad7340ea230cc9f1ced247a0f9eb33887">00946</a> <span class="keywordtype">void</span> <a class="code" href="AndroidUtils_8cpp.html#ad7340ea230cc9f1ced247a0f9eb33887">AppOnTouch</a>( JNIEnv*  env, jobject jobj,jint action, jfloat <a class="code" href="flash_2GLES_2glext_8h.html#a0cdec8e97a75ee9458b23d152bf962d4">x</a>, jfloat <a class="code" href="flash_2GLES_2glext_8h.html#a2532a9f8ed3a10a63f5e3c484fbfdb9b">y</a>, jint finger)
<a name="l00947"></a>00947 {
<a name="l00948"></a>00948         <span class="comment">//LogMsg(&quot;Got action %d, %.2f %.2f&quot;, action, x, y);</span>
<a name="l00949"></a>00949 
<a name="l00950"></a>00950         
<a name="l00951"></a>00951         <a class="code" href="MessageManager_8h.html#a700ed30d49bfe436323e17539d3a0010">eMessageType</a> messageType = <a class="code" href="MessageManager_8h.html#a700ed30d49bfe436323e17539d3a0010a130de07a456a18615c9aeba74a1fff6e">MESSAGE_TYPE_UNKNOWN</a>;
<a name="l00952"></a>00952 
<a name="l00953"></a>00953         <span class="keywordflow">switch</span> (action)
<a name="l00954"></a>00954         {
<a name="l00955"></a>00955         <span class="keywordflow">case</span> <a class="code" href="AndroidUtils_8cpp.html#aaf19aa46f352ca0ecb9c36d17967a99fa8d27643b75eb9ca027a8c1b6d6f145f5">ACTION_DOWN</a>:
<a name="l00956"></a>00956                 messageType = <a class="code" href="MessageManager_8h.html#a700ed30d49bfe436323e17539d3a0010a62a072d43e11c16229b536509a3dc1b8">MESSAGE_TYPE_GUI_CLICK_START</a>;
<a name="l00957"></a>00957                 <span class="keywordflow">break</span>;
<a name="l00958"></a>00958 
<a name="l00959"></a>00959         <span class="keywordflow">case</span> <a class="code" href="AndroidUtils_8cpp.html#aaf19aa46f352ca0ecb9c36d17967a99fa8c684c62d0b5488a8938a868c3b9ada3">ACTION_UP</a>:
<a name="l00960"></a>00960                 messageType = <a class="code" href="MessageManager_8h.html#a700ed30d49bfe436323e17539d3a0010a7f2d808ba01bebb86035466a59744aee">MESSAGE_TYPE_GUI_CLICK_END</a>;
<a name="l00961"></a>00961                 <span class="keywordflow">break</span>;
<a name="l00962"></a>00962 
<a name="l00963"></a>00963         <span class="keywordflow">case</span> <a class="code" href="AndroidUtils_8cpp.html#aaf19aa46f352ca0ecb9c36d17967a99fa28a70050a91a75e0af79e70c1ad74ca0">ACTION_MOVE</a>:
<a name="l00964"></a>00964                 messageType = <a class="code" href="MessageManager_8h.html#a700ed30d49bfe436323e17539d3a0010aff54ad3a33fb04dca784df64b2e5e3ee">MESSAGE_TYPE_GUI_CLICK_MOVE</a>;
<a name="l00965"></a>00965                 <span class="keywordflow">break</span>;
<a name="l00966"></a>00966 
<a name="l00967"></a>00967         <span class="keywordflow">default</span>:
<a name="l00968"></a>00968 
<a name="l00969"></a>00969 <span class="preprocessor">#ifndef _DEBUG</span>
<a name="l00970"></a>00970 <span class="preprocessor"></span>                <a class="code" href="AndroidUtils_8cpp.html#aaa5c9bf2289dec09f59ef2b7ba6c66ae">LogMsg</a>(<span class="stringliteral">&quot;Unhandled input message %d at %.2f:%.2f&quot;</span>, action, x, y);
<a name="l00971"></a>00971 <span class="preprocessor">#endif</span>
<a name="l00972"></a>00972 <span class="preprocessor"></span>                <span class="keywordflow">break</span>;
<a name="l00973"></a>00973 
<a name="l00974"></a>00974         }
<a name="l00975"></a>00975 
<a name="l00976"></a>00976         <span class="keyword">static</span> AndroidMessageCache <a class="code" href="Renderer_2GL_2glext_8h.html#af593500c283bf1a787a6f947f503a5c2">m</a>;
<a name="l00977"></a>00977         
<a name="l00978"></a>00978         m.x = <a class="code" href="flash_2GLES_2glext_8h.html#a0cdec8e97a75ee9458b23d152bf962d4">x</a>;
<a name="l00979"></a>00979         m.y = <a class="code" href="flash_2GLES_2glext_8h.html#a2532a9f8ed3a10a63f5e3c484fbfdb9b">y</a>;
<a name="l00980"></a>00980         m.finger = finger;
<a name="l00981"></a>00981         m.type = messageType;
<a name="l00982"></a>00982 
<a name="l00983"></a>00983         <a class="code" href="AndroidUtils_8cpp.html#ac6246abf949faf91c86382ee4c29be4d">g_messageCache</a>.push_back(m);
<a name="l00984"></a>00984         <span class="comment">//GetMessageManager()-&gt;SendGUI(messageType, x, y);</span>
<a name="l00985"></a>00985 }
<a name="l00986"></a>00986 
<a name="l00987"></a>00987 
<a name="l00988"></a><a class="code" href="AndroidUtils_8h.html#a81723a931806a5fef7292c83dbda7be8">00988</a> <span class="keywordtype">void</span> <a class="code" href="AndroidUtils_8cpp.html#a81723a931806a5fef7292c83dbda7be8">AppOnSendGUIEx</a>(JNIEnv*  env, jobject thiz,jint messageType, jint parm1, jint parm2, jint finger )
<a name="l00989"></a>00989 {
<a name="l00990"></a>00990         <a class="code" href="BaseApp_8h.html#a11454091168162d8f3991461725aa24f">GetMessageManager</a>()-&gt;<a class="code" href="classMessageManager.html#a8a5224558c0c4718b1c5e8d197f179cb">SendGUIEx</a>((<a class="code" href="MessageManager_8h.html#a700ed30d49bfe436323e17539d3a0010">eMessageType</a>)messageType, (<span class="keywordtype">float</span>)parm1, (<span class="keywordtype">float</span>)parm2, finger);  
<a name="l00991"></a>00991 
<a name="l00992"></a>00992 }
<a name="l00993"></a>00993 
<a name="l00994"></a><a class="code" href="AndroidUtils_8h.html#a274b2f91d5fcdef95436e13daa3d2676">00994</a> <span class="keywordtype">void</span> <a class="code" href="AndroidUtils_8cpp.html#a274b2f91d5fcdef95436e13daa3d2676">AppOnSendGUIStringEx</a>(JNIEnv*  env, jobject thiz,jint messageType, jint parm1, jint parm2, jint finger, jstring <a class="code" href="flash_2GLES_2glext_8h.html#ad585a1393cfa368fa9dc3d8ebff640d5">s</a> )
<a name="l00995"></a>00995 {
<a name="l00996"></a>00996         <span class="keyword">const</span> <span class="keywordtype">char</span> * ss=env-&gt;GetStringUTFChars(s,0);
<a name="l00997"></a>00997         <span class="keywordtype">string</span> str = ss;
<a name="l00998"></a>00998         env-&gt;ReleaseStringUTFChars(s, ss);
<a name="l00999"></a>00999 
<a name="l01000"></a>01000         <a class="code" href="BaseApp_8h.html#a11454091168162d8f3991461725aa24f">GetMessageManager</a>()-&gt;<a class="code" href="classMessageManager.html#a54eb18bb73fa1a7c266d6a52732f1c87">SendGUIStringEx</a>((<a class="code" href="MessageManager_8h.html#a700ed30d49bfe436323e17539d3a0010">eMessageType</a>)messageType, (<span class="keywordtype">float</span>)parm1, (<span class="keywordtype">float</span>)parm2, finger, str);  
<a name="l01001"></a>01001 
<a name="l01002"></a>01002 }
<a name="l01003"></a>01003 
<a name="l01004"></a><a class="code" href="AndroidUtils_8h.html#a189eb054c38f610fbb7b9a4ea3a7bef9">01004</a> <span class="keywordtype">void</span> <a class="code" href="AndroidUtils_8cpp.html#a189eb054c38f610fbb7b9a4ea3a7bef9">AppOnKey</a>( JNIEnv*  env, jobject jobj, jint <a class="code" href="eglext_8h.html#a890efa53b3d7deeeced6f3a0d6653ed3">type</a>, jint keycode, jint <a class="code" href="Renderer_2GL_2glext_8h.html#a1f2d7f8147412c43ba2303a56f97ee73">c</a>)
<a name="l01005"></a>01005 {
<a name="l01006"></a>01006         
<a name="l01007"></a>01007 <span class="preprocessor">#ifdef _DEBUG</span>
<a name="l01008"></a>01008 <span class="preprocessor"></span>        <a class="code" href="AndroidUtils_8cpp.html#aaa5c9bf2289dec09f59ef2b7ba6c66ae">LogMsg</a>(<span class="stringliteral">&quot;Native Got type %d, keycode %d, key %d (%c)&quot;</span>, type, keycode, c, (<span class="keywordtype">char</span>(c)));
<a name="l01009"></a>01009 <span class="preprocessor">#endif</span>
<a name="l01010"></a>01010 <span class="preprocessor"></span>
<a name="l01011"></a>01011         <span class="keywordflow">switch</span> (keycode)
<a name="l01012"></a>01012         {
<a name="l01013"></a>01013                 
<a name="l01014"></a>01014                 <span class="comment">//case 4: e.v = KEY_BACK; break; // KEYCODE_BACK</span>
<a name="l01015"></a>01015                 <span class="comment">//case 82: e.v = KEY_MENU; break; // KEYCODE_MENU</span>
<a name="l01016"></a>01016                 <span class="comment">//case 84: e.v = KEY_SEARCH; break; // KEYCODE_SEARCH</span>
<a name="l01017"></a>01017         <span class="keywordflow">case</span> 66: <span class="comment">//enter</span>
<a name="l01018"></a>01018                 c = 13;
<a name="l01019"></a>01019                 <span class="keywordflow">break</span>;
<a name="l01020"></a>01020         <span class="keywordflow">case</span> 67: <span class="comment">//back space</span>
<a name="l01021"></a>01021                 c = 8;
<a name="l01022"></a>01022                 <span class="keywordflow">break</span>;
<a name="l01023"></a>01023 
<a name="l01024"></a>01024         <span class="keywordflow">case</span> 99:
<a name="l01025"></a>01025                 keycode = <a class="code" href="MessageManager_8h.html#ac265638eff0541bfda12d093cd56b673a14081f00e29d429b5a593c2ea0c61fa4">VIRTUAL_DPAD_BUTTON_LEFT</a>;
<a name="l01026"></a>01026                 <span class="keywordflow">break</span>;
<a name="l01027"></a>01027 
<a name="l01028"></a>01028         <span class="keywordflow">case</span> 100:
<a name="l01029"></a>01029                 keycode = <a class="code" href="MessageManager_8h.html#ac265638eff0541bfda12d093cd56b673a727d6a765855dbd9599ee9eb6f244108">VIRTUAL_DPAD_BUTTON_UP</a>;
<a name="l01030"></a>01030                 <span class="keywordflow">break</span>;
<a name="l01031"></a>01031 
<a name="l01032"></a>01032 
<a name="l01033"></a>01033         <span class="keywordflow">case</span> 4:
<a name="l01034"></a>01034                 <span class="comment">//actually this will never get hit, the java side will send VIRTUAL_DPAD_BUTTON_RIGHT directly, because it</span>
<a name="l01035"></a>01035                 <span class="comment">//shares stuff with the back button and has to detect which one it is on that side</span>
<a name="l01036"></a>01036                 keycode = <a class="code" href="MessageManager_8h.html#ac265638eff0541bfda12d093cd56b673a42fecce6cc04615b2a12a725a78f9774">VIRTUAL_DPAD_BUTTON_RIGHT</a>;
<a name="l01037"></a>01037                 <span class="keywordflow">break</span>;
<a name="l01038"></a>01038         <span class="keywordflow">case</span> 109:
<a name="l01039"></a>01039                 keycode = <a class="code" href="MessageManager_8h.html#ac265638eff0541bfda12d093cd56b673a568e57a541272da089360015a1b62490">VIRTUAL_DPAD_SELECT</a>;
<a name="l01040"></a>01040                 <span class="keywordflow">break</span>;
<a name="l01041"></a>01041         <span class="keywordflow">case</span> 108:
<a name="l01042"></a>01042                 keycode =  <a class="code" href="MessageManager_8h.html#ac265638eff0541bfda12d093cd56b673aa1d022a8414a54c7d5f44696a5f629bf">VIRTUAL_DPAD_START</a>;
<a name="l01043"></a>01043                 <span class="keywordflow">break</span>;
<a name="l01044"></a>01044 
<a name="l01045"></a>01045         <span class="keywordflow">case</span> 102:
<a name="l01046"></a>01046                 keycode =  <a class="code" href="MessageManager_8h.html#ac265638eff0541bfda12d093cd56b673ab9be8104d4781c47446efed394029ccc">VIRTUAL_DPAD_LBUTTON</a>;
<a name="l01047"></a>01047         <span class="keywordflow">break</span>;
<a name="l01048"></a>01048         <span class="keywordflow">case</span> 103:
<a name="l01049"></a>01049                 keycode =  <a class="code" href="MessageManager_8h.html#ac265638eff0541bfda12d093cd56b673aa2c3d74e6fcc78087e793dc4a45010ee">VIRTUAL_DPAD_RBUTTON</a>;
<a name="l01050"></a>01050                 <span class="keywordflow">break</span>;
<a name="l01051"></a>01051 
<a name="l01052"></a>01052         }
<a name="l01053"></a>01053         
<a name="l01054"></a>01054         <span class="keywordflow">if</span> (keycode &gt;= <a class="code" href="MessageManager_8h.html#ac265638eff0541bfda12d093cd56b673adb311f8588b5ddd97064ebf3e064bfa5">VIRTUAL_KEY_BACK</a>)
<a name="l01055"></a>01055         {
<a name="l01056"></a>01056                 
<a name="l01057"></a>01057                 <span class="keywordflow">if</span> (<a class="code" href="RenderUtils_8cpp.html#aed0a0b710950a1a867d83377921b1235">GetIsUsingNativeUI</a>())
<a name="l01058"></a>01058                 {
<a name="l01059"></a>01059                         <span class="comment">//hitting back with the keyboard open?  Just pretend they closed the keyboard.</span>
<a name="l01060"></a>01060                         <a class="code" href="RenderUtils_8cpp.html#a51e15055160b774712bf5085fac88780">SetIsUsingNativeUI</a>(<span class="keyword">false</span>);
<a name="l01061"></a>01061                         <span class="keywordflow">return</span>;
<a name="l01062"></a>01062                 } <span class="keywordflow">else</span>
<a name="l01063"></a>01063                 {
<a name="l01064"></a>01064                         c = keycode;
<a name="l01065"></a>01065                 }
<a name="l01066"></a>01066                 
<a name="l01067"></a>01067 
<a name="l01068"></a>01068                 c = keycode;
<a name="l01069"></a>01069         }
<a name="l01070"></a>01070 
<a name="l01071"></a>01071         <span class="keywordflow">switch</span> (type)
<a name="l01072"></a>01072         {
<a name="l01073"></a>01073         <span class="keywordflow">case</span> 1: <span class="comment">//keydown</span>
<a name="l01074"></a>01074                 <a class="code" href="BaseApp_8h.html#a11454091168162d8f3991461725aa24f">GetMessageManager</a>()-&gt;<a class="code" href="classMessageManager.html#ad693aa202e80ca038ee6dfc4fb81a566">SendGUI</a>(<a class="code" href="MessageManager_8h.html#a700ed30d49bfe436323e17539d3a0010a28f5b06e02b343a08d3c0f6f6bcd80a3">MESSAGE_TYPE_GUI_CHAR</a>, (<span class="keywordtype">float</span>)c, (<span class="keywordtype">float</span>)1);  
<a name="l01075"></a>01075                 
<a name="l01076"></a>01076                 <span class="keywordflow">if</span> (c &lt; 128) c = toupper(c);
<a name="l01077"></a>01077                 <a class="code" href="BaseApp_8h.html#a11454091168162d8f3991461725aa24f">GetMessageManager</a>()-&gt;<a class="code" href="classMessageManager.html#ad693aa202e80ca038ee6dfc4fb81a566">SendGUI</a>(<a class="code" href="MessageManager_8h.html#a700ed30d49bfe436323e17539d3a0010a0dc81596f38d348bca4f3bc9c5215c0b">MESSAGE_TYPE_GUI_CHAR_RAW</a>, (<span class="keywordtype">float</span>)c, (<span class="keywordtype">float</span>)1);  
<a name="l01078"></a>01078                 <span class="keywordflow">break</span>;
<a name="l01079"></a>01079 
<a name="l01080"></a>01080         <span class="keywordflow">case</span> 0: <span class="comment">//key up</span>
<a name="l01081"></a>01081                 <span class="keywordflow">if</span> (c &lt; 128) c = toupper(c);
<a name="l01082"></a>01082                 <a class="code" href="BaseApp_8h.html#a11454091168162d8f3991461725aa24f">GetMessageManager</a>()-&gt;<a class="code" href="classMessageManager.html#ad693aa202e80ca038ee6dfc4fb81a566">SendGUI</a>(<a class="code" href="MessageManager_8h.html#a700ed30d49bfe436323e17539d3a0010a0dc81596f38d348bca4f3bc9c5215c0b">MESSAGE_TYPE_GUI_CHAR_RAW</a>, (<span class="keywordtype">float</span>)c, 0.0<a class="code" href="Renderer_2GL_2glext_8h.html#aba8ad56949f59242bc167b073dae3715">f</a>);  
<a name="l01083"></a>01083                 <span class="keywordflow">break</span>;
<a name="l01084"></a>01084         }
<a name="l01085"></a>01085 }
<a name="l01086"></a>01086 
<a name="l01087"></a>01087 
<a name="l01088"></a><a class="code" href="AndroidUtils_8h.html#a88ed11259f12c7ac0c90207587570acd">01088</a> <span class="keywordtype">int</span> <a class="code" href="AndroidUtils_8cpp.html#a88ed11259f12c7ac0c90207587570acd">AppOSMessageGet</a>(JNIEnv* env)
<a name="l01089"></a>01089 {
<a name="l01090"></a>01090 
<a name="l01091"></a>01091         <span class="keywordflow">if</span> (!<a class="code" href="BaseApp_8cpp.html#aef043c38b21bf52ff43fbca27a6cadb0">IsBaseAppInitted</a>())
<a name="l01092"></a>01092         {
<a name="l01093"></a>01093                 <span class="keywordflow">return</span> 0;
<a name="l01094"></a>01094         }
<a name="l01095"></a>01095 
<a name="l01096"></a>01096         <span class="keywordflow">while</span> (!<a class="code" href="AndroidUtils_8cpp.html#ac6246abf949faf91c86382ee4c29be4d">g_messageCache</a>.empty())
<a name="l01097"></a>01097         {
<a name="l01098"></a>01098                 AndroidMessageCache *pM = &amp;<a class="code" href="AndroidUtils_8cpp.html#ac6246abf949faf91c86382ee4c29be4d">g_messageCache</a>.front();
<a name="l01099"></a>01099                 
<a name="l01100"></a>01100                 <a class="code" href="RenderUtils_8cpp.html#aefb4995d0b8dcf2f2f19ba6994f7a7f7">ConvertCoordinatesIfRequired</a>(pM-&gt;x, pM-&gt;y);
<a name="l01101"></a>01101 
<a name="l01102"></a>01102                 <a class="code" href="BaseApp_8h.html#a11454091168162d8f3991461725aa24f">GetMessageManager</a>()-&gt;<a class="code" href="classMessageManager.html#a8a5224558c0c4718b1c5e8d197f179cb">SendGUIEx</a>(pM-&gt;type, pM-&gt;x, pM-&gt;y, pM-&gt;finger);
<a name="l01103"></a>01103                 <a class="code" href="AndroidUtils_8cpp.html#ac6246abf949faf91c86382ee4c29be4d">g_messageCache</a>.pop_front();
<a name="l01104"></a>01104         }
<a name="l01105"></a>01105 
<a name="l01106"></a>01106         <span class="keywordflow">while</span> (!<a class="code" href="BaseApp_8h.html#a72086b48d24daf0a65dd20189a16bd16">GetBaseApp</a>()-&gt;GetOSMessages()-&gt;empty())
<a name="l01107"></a>01107         {
<a name="l01108"></a>01108                 <span class="comment">//check for special messages that we don&#39;t want to pass on</span>
<a name="l01109"></a>01109                 g_lastOSMessage = <a class="code" href="BaseApp_8h.html#a72086b48d24daf0a65dd20189a16bd16">GetBaseApp</a>()-&gt;<a class="code" href="classBaseApp.html#a4b85ad1e9d93589d94f97bbff445a4d0">GetOSMessages</a>()-&gt;front();
<a name="l01110"></a>01110                 <span class="keywordflow">if</span> (g_lastOSMessage.<a class="code" href="structOSMessage.html#a15a064581798f6bc8724440f285eacd7">m_type</a> == <a class="code" href="structOSMessage.html#a9fc98c3cc1a5a51feb7a977b01defadcabf4e2a5e60488ba5f7fef2b52d420a15">OSMessage::MESSAGE_CHECK_CONNECTION</a>)
<a name="l01111"></a>01111                 {
<a name="l01112"></a>01112                                 <span class="comment">//pretend we did it</span>
<a name="l01113"></a>01113                                 <a class="code" href="BaseApp_8h.html#a11454091168162d8f3991461725aa24f">GetMessageManager</a>()-&gt;<a class="code" href="classMessageManager.html#ad693aa202e80ca038ee6dfc4fb81a566">SendGUI</a>(<a class="code" href="MessageManager_8h.html#a700ed30d49bfe436323e17539d3a0010afd6e1c3d04bcfa990b1bf81dd52d2123">MESSAGE_TYPE_OS_CONNECTION_CHECKED</a>, (<span class="keywordtype">float</span>)<a class="code" href="MessageManager_8h.html#aa8c50be3996ab6399d448c30417ec183a9635db3b4092a144be0a91f8af3bf0c0">RT_kCFStreamEventOpenCompleted</a>, 0.0<a class="code" href="Renderer_2GL_2glext_8h.html#aba8ad56949f59242bc167b073dae3715">f</a>);  
<a name="l01114"></a>01114                                 <a class="code" href="BaseApp_8h.html#a72086b48d24daf0a65dd20189a16bd16">GetBaseApp</a>()-&gt;<a class="code" href="classBaseApp.html#a4b85ad1e9d93589d94f97bbff445a4d0">GetOSMessages</a>()-&gt;pop_front();
<a name="l01115"></a>01115                                 <span class="keywordflow">continue</span>;
<a name="l01116"></a>01116                 }
<a name="l01117"></a>01117                 <span class="keywordflow">break</span>;
<a name="l01118"></a>01118         }
<a name="l01119"></a>01119 
<a name="l01120"></a>01120         <span class="keywordflow">if</span> (!<a class="code" href="BaseApp_8h.html#a72086b48d24daf0a65dd20189a16bd16">GetBaseApp</a>()-&gt;GetOSMessages()-&gt;empty())
<a name="l01121"></a>01121         {
<a name="l01122"></a>01122                 g_lastOSMessage = <a class="code" href="BaseApp_8h.html#a72086b48d24daf0a65dd20189a16bd16">GetBaseApp</a>()-&gt;<a class="code" href="classBaseApp.html#a4b85ad1e9d93589d94f97bbff445a4d0">GetOSMessages</a>()-&gt;front();
<a name="l01123"></a>01123                 <a class="code" href="BaseApp_8h.html#a72086b48d24daf0a65dd20189a16bd16">GetBaseApp</a>()-&gt;<a class="code" href="classBaseApp.html#a4b85ad1e9d93589d94f97bbff445a4d0">GetOSMessages</a>()-&gt;pop_front();
<a name="l01124"></a>01124                 <span class="comment">//LogMsg(&quot;Preparing OS message %d, %s&quot;, g_lastOSMessage.m_type, g_lastOSMessage.m_string.c_str());</span>
<a name="l01125"></a>01125                 <span class="keywordflow">return</span> g_lastOSMessage.<a class="code" href="structOSMessage.html#a15a064581798f6bc8724440f285eacd7">m_type</a>;
<a name="l01126"></a>01126         }
<a name="l01127"></a>01127 
<a name="l01128"></a>01128         <span class="keywordflow">return</span> <a class="code" href="structOSMessage.html#a9fc98c3cc1a5a51feb7a977b01defadca7b5ed0504628afdab7046d5d1f995589">OSMessage::MESSAGE_NONE</a>;
<a name="l01129"></a>01129 }
<a name="l01130"></a>01130 
<a name="l01131"></a><a class="code" href="AndroidUtils_8h.html#acf06b34d7f8e6317fff26920eb91833a">01131</a> jstring <a class="code" href="AndroidUtils_8cpp.html#acf06b34d7f8e6317fff26920eb91833a">AppGetLastOSMessageString</a>(JNIEnv* env)
<a name="l01132"></a>01132 {
<a name="l01133"></a>01133          <span class="keywordflow">return</span>(env-&gt;NewStringUTF(g_lastOSMessage.<a class="code" href="structOSMessage.html#a30c292046d221c99a48dd1915298bf35">m_string</a>.c_str()));
<a name="l01134"></a>01134 }
<a name="l01135"></a>01135 
<a name="l01136"></a><a class="code" href="AndroidUtils_8h.html#a344eaba250a3e9b819b8bf6011b30371">01136</a> jstring <a class="code" href="AndroidUtils_8cpp.html#a344eaba250a3e9b819b8bf6011b30371">AppGetLastOSMessageString2</a>(JNIEnv* env)
<a name="l01137"></a>01137 {
<a name="l01138"></a>01138         <span class="keywordflow">return</span>(env-&gt;NewStringUTF(g_lastOSMessage.<a class="code" href="structOSMessage.html#a5d03aedc9e0ac2a93c0d82e4cb3d4787">m_string2</a>.c_str()));
<a name="l01139"></a>01139 }
<a name="l01140"></a>01140 
<a name="l01141"></a><a class="code" href="AndroidUtils_8h.html#aeca4de04247fe246d3c6bd5309e7e79b">01141</a> jstring <a class="code" href="AndroidUtils_8cpp.html#aeca4de04247fe246d3c6bd5309e7e79b">AppGetLastOSMessageString3</a>(JNIEnv* env)
<a name="l01142"></a>01142 {
<a name="l01143"></a>01143         <span class="keywordflow">return</span>(env-&gt;NewStringUTF(g_lastOSMessage.<a class="code" href="structOSMessage.html#ade6287d11f9d51ebfd43aee87ce07728">m_string3</a>.c_str()));
<a name="l01144"></a>01144 }
<a name="l01145"></a>01145 
<a name="l01146"></a><a class="code" href="AndroidUtils_8h.html#a1087d426261926835cab0bd9d0ff84c3">01146</a> <span class="keywordtype">float</span> <a class="code" href="AndroidUtils_8cpp.html#a1087d426261926835cab0bd9d0ff84c3">AppGetLastOSMessageX</a>(JNIEnv* env)
<a name="l01147"></a>01147 {
<a name="l01148"></a>01148         <span class="keywordflow">return</span> g_lastOSMessage.<a class="code" href="structOSMessage.html#a61a7899985dd6f06be9b060b306eabc7">m_x</a>;
<a name="l01149"></a>01149 }
<a name="l01150"></a>01150 
<a name="l01151"></a><a class="code" href="AndroidUtils_8h.html#acc6c9bd38bd39274ed9123cdf40fb207">01151</a> <span class="keywordtype">float</span> <a class="code" href="AndroidUtils_8cpp.html#acc6c9bd38bd39274ed9123cdf40fb207">AppGetLastOSMessageY</a>(JNIEnv* env)
<a name="l01152"></a>01152 {
<a name="l01153"></a>01153         <span class="keywordflow">return</span> g_lastOSMessage.<a class="code" href="structOSMessage.html#a6971e2199218ece8f10478d1fb76317c">m_y</a>;
<a name="l01154"></a>01154 }
<a name="l01155"></a>01155 
<a name="l01156"></a><a class="code" href="AndroidUtils_8h.html#ae5f9a64d0477a2b5c8f68da028a19849">01156</a> <span class="keywordtype">float</span> <a class="code" href="AndroidUtils_8cpp.html#ae5f9a64d0477a2b5c8f68da028a19849">AppGetLastOSMessageParm1</a>(JNIEnv* env)
<a name="l01157"></a>01157 {
<a name="l01158"></a>01158         <span class="keywordflow">return</span> g_lastOSMessage.<a class="code" href="structOSMessage.html#a2b0df92db9773c66231c6bdfbeafae44">m_parm1</a>;
<a name="l01159"></a>01159 }
<a name="l01160"></a>01160 
<a name="l01161"></a>01161 <span class="comment">// JAKE ADDED - MachineWorks needs this, so please leave.</span>
<a name="l01162"></a><a class="code" href="AndroidUtils_8h.html#af6769fac6a13e224e6fc2c1c8b13302d">01162</a> <span class="keywordtype">void</span> <a class="code" href="AndroidUtils_8cpp.html#af6769fac6a13e224e6fc2c1c8b13302d">AppOnJoypadButtons</a>(JNIEnv* env, jobject jobj, jint key, jint <a class="code" href="eglext_8h.html#a79169be77d7e02a24f68a5bfe627dc29">value</a>)
<a name="l01163"></a>01163 {
<a name="l01164"></a>01164 
<a name="l01165"></a>01165 <span class="preprocessor">#ifdef RT_MOGA_ENABLED</span>
<a name="l01166"></a>01166 <span class="preprocessor"></span>        <span class="comment">//for Seth&#39;s GamepadManagerMoga implementation, so it can be abstracted like any other gamepad</span>
<a name="l01167"></a>01167         <span class="comment">//LogMsg(&quot;Received key %d, value %d&quot;, key, value);</span>
<a name="l01168"></a>01168         <a class="code" href="classVariantList.html">VariantList</a> vList((<a class="code" href="PlatformSetupAndroid_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a>)<a class="code" href="MessageManager_8h.html#a700ed30d49bfe436323e17539d3a0010a20cd4213507df73f08bdcf3d7f6e1626">MESSAGE_TYPE_GUI_JOYPAD_BUTTONS</a>, (<a class="code" href="PlatformSetupAndroid_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a>) key, (<a class="code" href="PlatformSetupAndroid_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a>)value);
<a name="l01169"></a>01169         <a class="code" href="BaseApp_8h.html#a72086b48d24daf0a65dd20189a16bd16">GetBaseApp</a>()-&gt;<a class="code" href="classBaseApp.html#a0faefd0bc7bf64728bb0a1a443e8041f">m_sig_joypad_events</a>(&amp;vList);
<a name="l01170"></a>01170 <span class="preprocessor">#else</span>
<a name="l01171"></a>01171 <span class="preprocessor"></span>        <span class="comment">//LogMsg(&quot;Jakes: Received key %d, value %d&quot;, key, value);</span>
<a name="l01172"></a>01172         <a class="code" href="BaseApp_8h.html#a11454091168162d8f3991461725aa24f">GetMessageManager</a>()-&gt;<a class="code" href="classMessageManager.html#ad693aa202e80ca038ee6dfc4fb81a566">SendGUI</a>(MESSAGE_TYPE_GUI_JOYPAD_BUTTONS, <a class="code" href="classVariant.html">Variant</a>(key, value, 0.0<a class="code" href="Renderer_2GL_2glext_8h.html#aba8ad56949f59242bc167b073dae3715">f</a>));
<a name="l01173"></a>01173 <span class="preprocessor">#endif</span>
<a name="l01174"></a>01174 <span class="preprocessor"></span>
<a name="l01175"></a>01175 }
<a name="l01176"></a>01176 
<a name="l01177"></a><a class="code" href="AndroidUtils_8h.html#a47e216cb86704b7ef74516fc41336e7a">01177</a> <span class="keywordtype">void</span> <a class="code" href="AndroidUtils_8cpp.html#a47e216cb86704b7ef74516fc41336e7a">AppOnJoypad</a>(JNIEnv* env, jobject jobj, jfloat xL, jfloat yL, jfloat xR, jfloat yR)
<a name="l01178"></a>01178 {
<a name="l01179"></a>01179         <a class="code" href="AndroidUtils_8cpp.html#aaa5c9bf2289dec09f59ef2b7ba6c66ae">LogMsg</a>(<span class="stringliteral">&quot;Got %.2f, %.2f and %.2f, %.2f&quot;</span>, xL, yL, xR, yR);
<a name="l01180"></a>01180 
<a name="l01181"></a>01181 <span class="preprocessor">#ifdef RT_MOGA_ENABLED</span>
<a name="l01182"></a>01182 <span class="preprocessor"></span>        <span class="comment">//for Seth&#39;s GamepadManagerMoga implementation, so it can be abstracted like any other gamepad</span>
<a name="l01183"></a>01183         <a class="code" href="classVariantList.html">VariantList</a> vList((<a class="code" href="PlatformSetupAndroid_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a>)<a class="code" href="MessageManager_8h.html#a700ed30d49bfe436323e17539d3a0010ad22afa99e841a58f29cc7883a3dcba60">MESSAGE_TYPE_GUI_JOYPAD</a>, xL, yL, xR, yR);
<a name="l01184"></a>01184         <a class="code" href="BaseApp_8h.html#a72086b48d24daf0a65dd20189a16bd16">GetBaseApp</a>()-&gt;<a class="code" href="classBaseApp.html#a0faefd0bc7bf64728bb0a1a443e8041f">m_sig_joypad_events</a>(&amp;vList);
<a name="l01185"></a>01185 <span class="preprocessor">#else</span>
<a name="l01186"></a>01186 <span class="preprocessor"></span>        <span class="comment">//legacy, for Jake&#39;s stuff</span>
<a name="l01187"></a>01187         <a class="code" href="classVariantList.html">VariantList</a> vList( xL, yL, xR, yR);
<a name="l01188"></a>01188         <a class="code" href="BaseApp_8h.html#a11454091168162d8f3991461725aa24f">GetMessageManager</a>()-&gt;<a class="code" href="classMessageManager.html#ad693aa202e80ca038ee6dfc4fb81a566">SendGUI</a>(MESSAGE_TYPE_GUI_JOYPAD, vList);
<a name="l01189"></a>01189 <span class="preprocessor">#endif</span>
<a name="l01190"></a>01190 <span class="preprocessor"></span>}
<a name="l01191"></a>01191 
<a name="l01192"></a><a class="code" href="AndroidUtils_8h.html#a3973d27e44c2dc9cfd9adb7cb5d30977">01192</a> <span class="keywordtype">void</span> <a class="code" href="AndroidUtils_8cpp.html#a3973d27e44c2dc9cfd9adb7cb5d30977">AppOnJoypadConnection</a>(JNIEnv* env, jobject jobj, jint connect)
<a name="l01193"></a>01193 {
<a name="l01194"></a>01194 <span class="comment">//      LogMsg(&quot;Received connect value %d&quot;, connect);</span>
<a name="l01195"></a>01195 <span class="preprocessor">#ifdef RT_MOGA_ENABLED</span>
<a name="l01196"></a>01196 <span class="preprocessor"></span>        <span class="comment">//for Seth&#39;s GamepadManagerMoga implementation, so it can be abstracted like any other gamepad</span>
<a name="l01197"></a>01197         <a class="code" href="classVariantList.html">VariantList</a> vList((<a class="code" href="PlatformSetupAndroid_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a>)<a class="code" href="MessageManager_8h.html#a700ed30d49bfe436323e17539d3a0010af53c6ed8c5ba51951f710db94d7adad0">MESSAGE_TYPE_GUI_JOYPAD_CONNECT</a>, (<a class="code" href="PlatformSetupAndroid_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a>)connect);
<a name="l01198"></a>01198         <a class="code" href="BaseApp_8h.html#a72086b48d24daf0a65dd20189a16bd16">GetBaseApp</a>()-&gt;<a class="code" href="classBaseApp.html#a0faefd0bc7bf64728bb0a1a443e8041f">m_sig_joypad_events</a>(&amp;vList);
<a name="l01199"></a>01199 <span class="preprocessor">#else</span>
<a name="l01200"></a>01200 <span class="preprocessor"></span>        {
<a name="l01201"></a>01201                 <a class="code" href="BaseApp_8h.html#a11454091168162d8f3991461725aa24f">GetMessageManager</a>()-&gt;<a class="code" href="classMessageManager.html#ad693aa202e80ca038ee6dfc4fb81a566">SendGUI</a>(MESSAGE_TYPE_GUI_JOYPAD_CONNECT, <a class="code" href="classVariant.html">Variant</a>(connect, 0.0<a class="code" href="Renderer_2GL_2glext_8h.html#aba8ad56949f59242bc167b073dae3715">f</a>, 0.0<a class="code" href="Renderer_2GL_2glext_8h.html#aba8ad56949f59242bc167b073dae3715">f</a>));
<a name="l01202"></a>01202         }
<a name="l01203"></a>01203 <span class="preprocessor">#endif</span>
<a name="l01204"></a>01204 <span class="preprocessor"></span>}
<a name="l01205"></a>01205 <span class="comment">// Jake End</span>
<a name="l01206"></a>01206 
<a name="l01207"></a><a class="code" href="AndroidUtils_8h.html#a8ca81d13e54a8cc94f773bb35db4d16f">01207</a> <span class="keywordtype">void</span> <a class="code" href="AndroidUtils_8cpp.html#a8ca81d13e54a8cc94f773bb35db4d16f">AppOnTrackball</a>(JNIEnv* env, jobject jobj, jfloat <a class="code" href="flash_2GLES_2glext_8h.html#a0cdec8e97a75ee9458b23d152bf962d4">x</a>, jfloat <a class="code" href="flash_2GLES_2glext_8h.html#a2532a9f8ed3a10a63f5e3c484fbfdb9b">y</a>)
<a name="l01208"></a>01208 {
<a name="l01209"></a>01209         <span class="comment">//LogMsg(&quot;Got %.2f, %.2f&quot;, x, y);</span>
<a name="l01210"></a>01210         <a class="code" href="BaseApp_8h.html#a11454091168162d8f3991461725aa24f">GetMessageManager</a>()-&gt;<a class="code" href="classMessageManager.html#ad693aa202e80ca038ee6dfc4fb81a566">SendGUI</a>(<a class="code" href="MessageManager_8h.html#a700ed30d49bfe436323e17539d3a0010aedbbf1ebda825b0905c7be36d0b3d6a5">MESSAGE_TYPE_GUI_TRACKBALL</a>,  <a class="code" href="classVariant.html">Variant</a>(x, y, 0.0<a class="code" href="Renderer_2GL_2glext_8h.html#aba8ad56949f59242bc167b073dae3715">f</a>));
<a name="l01211"></a>01211 }
<a name="l01212"></a>01212 
<a name="l01213"></a><a class="code" href="AndroidUtils_8h.html#af2fa4dc014d42b37161ea716a22132ba">01213</a> <span class="keywordtype">void</span> <a class="code" href="AndroidUtils_8cpp.html#af2fa4dc014d42b37161ea716a22132ba">AppOnAccelerometerUpdate</a>(JNIEnv* env, jobject jobj, jfloat <a class="code" href="flash_2GLES_2glext_8h.html#a0cdec8e97a75ee9458b23d152bf962d4">x</a>, jfloat <a class="code" href="flash_2GLES_2glext_8h.html#a2532a9f8ed3a10a63f5e3c484fbfdb9b">y</a>, jfloat <a class="code" href="flash_2GLES_2glext_8h.html#afbd8e4152e83f10b9242ae1e7a71cb0b">z</a>)
<a name="l01214"></a>01214 {
<a name="l01215"></a>01215         <span class="comment">//convert to about the same format as iPhone and webOS.  I used the nexus one to calibrate this.. are other phones different?</span>
<a name="l01216"></a>01216 
<a name="l01217"></a>01217         x *= -(1.0f/8.3f);
<a name="l01218"></a>01218         y *= -(1.0f/8.3f);
<a name="l01219"></a>01219         z *= -(1.0f/8.3f);
<a name="l01220"></a>01220 
<a name="l01221"></a>01221         <a class="code" href="BaseApp_8h.html#a11454091168162d8f3991461725aa24f">GetMessageManager</a>()-&gt;<a class="code" href="classMessageManager.html#ad693aa202e80ca038ee6dfc4fb81a566">SendGUI</a>(<a class="code" href="MessageManager_8h.html#a700ed30d49bfe436323e17539d3a0010a5a44c9afa41028cdd386748af4e9dd06">MESSAGE_TYPE_GUI_ACCELEROMETER</a>,  <a class="code" href="classVariant.html">Variant</a>(x, y, z));
<a name="l01222"></a>01222 }
<a name="l01223"></a>01223 
<a name="l01224"></a>01224 
<a name="l01225"></a><a class="code" href="PlatformEnums_8h.html#a4fd3c3ec86bcddbe3f1145253be79b14">01225</a> <span class="keywordtype">void</span> <a class="code" href="AndroidUtils_8cpp.html#a4fd3c3ec86bcddbe3f1145253be79b14">ForceVideoUpdate</a>()
<a name="l01226"></a>01226 {
<a name="l01227"></a>01227         <a class="code" href="BaseApp_8cpp.html#a2575c1138f3c57506bd1b72caa8c80c2">g_globalBatcher</a>.<a class="code" href="classRenderBatcher.html#a591ad1906b8683de45ed8a7c86043151">Flush</a>();
<a name="l01228"></a>01228         assert(!<span class="stringliteral">&quot;You really need this?  Add it.  It&#39;s supposed to force a gl flip or whatever now.. useful for some situations where you need to update mid-function call..&quot;</span>);
<a name="l01229"></a>01229 }
<a name="l01230"></a>01230 
<a name="l01231"></a><a class="code" href="AndroidUtils_8cpp.html#a199842897fbe24c6203919ae9084eaea">01231</a> <span class="keywordtype">bool</span> <a class="code" href="AndroidUtils_8cpp.html#a199842897fbe24c6203919ae9084eaea">IsDirectoryDateNewerThan</a>(<span class="keywordtype">string</span> dir, <span class="keywordtype">int</span> day, <span class="keywordtype">int</span> month, <span class="keywordtype">int</span> year)
<a name="l01232"></a>01232 {
<a name="l01233"></a>01233         <span class="keyword">struct </span>stat st;
<a name="l01234"></a>01234         <span class="keywordtype">int</span> ierr = stat (dir.c_str(), &amp;st);
<a name="l01235"></a>01235         <span class="keywordflow">if</span> (ierr != 0) 
<a name="l01236"></a>01236         {
<a name="l01237"></a>01237                 <a class="code" href="AndroidUtils_8cpp.html#aaa5c9bf2289dec09f59ef2b7ba6c66ae">LogMsg</a>(<span class="stringliteral">&quot;Unable to get date of %s&quot;</span>, dir.c_str());
<a name="l01238"></a>01238                 <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01239"></a>01239         }
<a name="l01240"></a>01240         
<a name="l01241"></a>01241         time_t <a class="code" href="flash_2GLES_2glext_8h.html#a00140d6f5c548b26daf170bf16e86a6d">t</a> = st.st_mtime;
<a name="l01242"></a>01242         <span class="keyword">struct </span>tm* my_tm = localtime(&amp;t);
<a name="l01243"></a>01243         <span class="comment">//fix to match what was passed in</span>
<a name="l01244"></a>01244         my_tm-&gt;tm_year += 1900;
<a name="l01245"></a>01245         my_tm-&gt;tm_mday += 1;
<a name="l01246"></a>01246         my_tm-&gt;tm_mon += 1;
<a name="l01247"></a>01247 
<a name="l01248"></a>01248         <span class="comment">//LogMsg(&quot;Date is %d, %d, %d&quot;, my_tm-&gt;tm_mday, my_tm-&gt;tm_mon, my_tm-&gt;tm_year);</span>
<a name="l01249"></a>01249 
<a name="l01250"></a>01250         <span class="keywordflow">if</span> (my_tm-&gt;tm_year &gt; year) <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01251"></a>01251         <span class="keywordflow">if</span> (my_tm-&gt;tm_mon &gt; month) <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01252"></a>01252         <span class="keywordflow">if</span> (my_tm-&gt;tm_mday &gt; day) <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01253"></a>01253 
<a name="l01254"></a>01254         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l01255"></a>01255 }
</pre></div></div><!-- contents -->


<hr class="footer"/><address class="footer"><small>
Generated on Thu May 2 2013 17:17:03 for Proton by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
