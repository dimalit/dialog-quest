<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Proton: RenderUtils.cpp Source File</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />



</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">Proton
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="dirs.html"><span>Directories</span></a></li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>File&#160;Members</span></a></li>
    </ul>
  </div>
  <div id="nav-path" class="navpath">
    <ul>
      <li class="navelem"><a class="el" href="dir_b4959094aa2649f063000bebf8111065.html">shared</a>      </li>
      <li class="navelem"><a class="el" href="dir_0c90619a56014cc4e695b3ba8d24af5c.html">util</a>      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="headertitle">
<div class="title">RenderUtils.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="RenderUtils_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre class="fragment"><a name="l00001"></a>00001 <span class="comment">/*</span>
<a name="l00002"></a>00002 <span class="comment"> *  RenderUtils.cpp</span>
<a name="l00003"></a>00003 <span class="comment"> *  </span>
<a name="l00004"></a>00004 <span class="comment"> *</span>
<a name="l00005"></a>00005 <span class="comment"> *  Created by Seth Robinson on 3/18/09.</span>
<a name="l00006"></a>00006 <span class="comment"> *  Copyright 2009 Robinson Technologies. All rights reserved.</span>
<a name="l00007"></a>00007 <span class="comment"> *</span>
<a name="l00008"></a>00008 <span class="comment"> */</span>
<a name="l00009"></a>00009 
<a name="l00010"></a>00010 <span class="preprocessor">#include &quot;<a class="code" href="PlatformPrecomp_8h.html">PlatformPrecomp.h</a>&quot;</span>
<a name="l00011"></a>00011 <span class="preprocessor">#include &quot;<a class="code" href="RenderUtils_8h.html">RenderUtils.h</a>&quot;</span>
<a name="l00012"></a>00012 <span class="preprocessor">#include &quot;<a class="code" href="BaseApp_8h.html">BaseApp.h</a>&quot;</span>
<a name="l00013"></a>00013 
<a name="l00014"></a>00014 <span class="comment">//defaults</span>
<a name="l00015"></a><a class="code" href="RenderUtils_8cpp.html#a29018a8eafaae21025d9b09d39ef2740">00015</a> <span class="keywordtype">int</span> <a class="code" href="RenderUtils_8cpp.html#a29018a8eafaae21025d9b09d39ef2740">g_screenSizeY</a> = <a class="code" href="AndroidUtils_8cpp.html#ac274a49195455502331eb617bce938e3">GetPrimaryGLY</a>();
<a name="l00016"></a><a class="code" href="RenderUtils_8cpp.html#a8805ddbb21195169d1feae1768691b9f">00016</a> <span class="keywordtype">int</span> <a class="code" href="RenderUtils_8cpp.html#a8805ddbb21195169d1feae1768691b9f">g_screenSizeX</a> = <a class="code" href="AndroidUtils_8cpp.html#a2f0e58aac06a13b950cef03dcc3e7267">GetPrimaryGLX</a>();
<a name="l00017"></a><a class="code" href="RenderUtils_8cpp.html#ad7be9d9913557f7a51de1fba34818995">00017</a> <span class="keywordtype">int</span> <a class="code" href="RenderUtils_8cpp.html#ad7be9d9913557f7a51de1fba34818995">g_fakePrimaryScreenSizeX</a> = 0;
<a name="l00018"></a><a class="code" href="RenderUtils_8cpp.html#ae6bd9b4b02a317bfa8dc69ef75ba9f9f">00018</a> <span class="keywordtype">int</span> <a class="code" href="RenderUtils_8cpp.html#ae6bd9b4b02a317bfa8dc69ef75ba9f9f">g_fakePrimaryScreenSizeY</a> = 0;
<a name="l00019"></a><a class="code" href="RenderUtils_8cpp.html#a3b90898ec57defcde351fa39ed3eacab">00019</a> <span class="keywordtype">int</span> <a class="code" href="RenderUtils_8cpp.html#a3b90898ec57defcde351fa39ed3eacab">g_originalScreenSizeX</a> = 0;
<a name="l00020"></a><a class="code" href="RenderUtils_8cpp.html#a4b10169c604df1ce7323a9e52ccb3dd9">00020</a> <span class="keywordtype">int</span> <a class="code" href="RenderUtils_8cpp.html#a4b10169c604df1ce7323a9e52ccb3dd9">g_originalScreenSizeY</a> = 0;
<a name="l00021"></a><a class="code" href="RenderUtils_8cpp.html#a21625ea22b5fdb970e4fed35e238e829">00021</a> <span class="keywordtype">float</span> <a class="code" href="RenderUtils_8cpp.html#a21625ea22b5fdb970e4fed35e238e829">g_deviceDiagonalSizeInInches</a> = 0;
<a name="l00022"></a>00022 
<a name="l00023"></a>00023 
<a name="l00024"></a><a class="code" href="RenderUtils_8cpp.html#aa483b1395dff180a945f71c640e91960">00024</a> <span class="keywordtype">float</span> <a class="code" href="RenderUtils_8cpp.html#aa483b1395dff180a945f71c640e91960">g_protonPixelScaleFactor</a> = 1.0f; <span class="comment">//only used by iOS</span>
<a name="l00025"></a>00025 
<a name="l00026"></a><a class="code" href="RenderUtils_8cpp.html#a8704bd3044fb12df29a643c99cf5dd5e">00026</a> <a class="code" href="PlatformEnums_8h.html#a02ed901e93e9d5ffb22fc6a2f0284f3d">eOrientationMode</a> <a class="code" href="RenderUtils_8cpp.html#a8704bd3044fb12df29a643c99cf5dd5e">g_forcedOrientation</a> = <a class="code" href="PlatformEnums_8h.html#a02ed901e93e9d5ffb22fc6a2f0284f3dac86fcbdd8a443ba2731a871a5daf31bc">ORIENTATION_DONT_CARE</a>;
<a name="l00027"></a><a class="code" href="RenderUtils_8cpp.html#a85cf675cfb52a2e9025dc3f49ba2d0fe">00027</a> <span class="keywordtype">int</span> <a class="code" href="RenderUtils_8cpp.html#a85cf675cfb52a2e9025dc3f49ba2d0fe">g_orientation</a> = <a class="code" href="PlatformEnums_8h.html#a02ed901e93e9d5ffb22fc6a2f0284f3dacd00a965397a558275015a84f2f22dd5">ORIENTATION_PORTRAIT</a>;
<a name="l00028"></a><a class="code" href="RenderUtils_8cpp.html#a64478affd05aa6dcad3f9cdea56c89a2">00028</a> <span class="keywordtype">bool</span> <a class="code" href="RenderUtils_8cpp.html#a64478affd05aa6dcad3f9cdea56c89a2">g_lockedLandscape</a> = <span class="keyword">false</span>;
<a name="l00029"></a>00029 
<a name="l00030"></a><a class="code" href="RenderUtils_8h.html#a7079164b40bddba9a033641696ce8820">00030</a> <a class="code" href="PlatformEnums_8h.html#a02ed901e93e9d5ffb22fc6a2f0284f3d">eOrientationMode</a> <a class="code" href="RenderUtils_8cpp.html#a7079164b40bddba9a033641696ce8820">GetForcedOrientation</a>() {<span class="keywordflow">return</span> <a class="code" href="RenderUtils_8cpp.html#a8704bd3044fb12df29a643c99cf5dd5e">g_forcedOrientation</a>;}
<a name="l00031"></a><a class="code" href="RenderUtils_8h.html#a2ae17fea4da3282e7ddb395aa3e28602">00031</a> <span class="keywordtype">void</span> <a class="code" href="RenderUtils_8cpp.html#a2ae17fea4da3282e7ddb395aa3e28602">SetForcedOrientation</a>(<a class="code" href="PlatformEnums_8h.html#a02ed901e93e9d5ffb22fc6a2f0284f3d">eOrientationMode</a> orientation) {<a class="code" href="RenderUtils_8cpp.html#a8704bd3044fb12df29a643c99cf5dd5e">g_forcedOrientation</a> = orientation;}
<a name="l00032"></a>00032 
<a name="l00033"></a><a class="code" href="RenderUtils_8h.html#af506e951c16aef083b9133f62163a44f">00033</a> <span class="keywordtype">void</span> <a class="code" href="RenderUtils_8cpp.html#af506e951c16aef083b9133f62163a44f">SetProtonPixelScaleFactor</a>(<span class="keywordtype">float</span> <a class="code" href="Renderer_2GL_2glext_8h.html#a281421b881aa7a1266842b73a3bc7655">scale</a>)
<a name="l00034"></a>00034 {
<a name="l00035"></a>00035 <span class="preprocessor">        #ifdef RT_DISABLE_RETINA_ON_IPAD</span>
<a name="l00036"></a>00036 <span class="preprocessor"></span>                <span class="keywordflow">if</span> (<a class="code" href="AndroidUtils_8cpp.html#a626d2605494373d6732d56ef74b01ea7">IsIPAD</a>() &amp;&amp; scale == 2.0<a class="code" href="Renderer_2GL_2glext_8h.html#aba8ad56949f59242bc167b073dae3715">f</a>)
<a name="l00037"></a>00037                 {
<a name="l00038"></a>00038                         <span class="comment">//it&#39;s an ipad3 actually.  Do we want retina or not?</span>
<a name="l00039"></a>00039                         scale = 1.0f;
<a name="l00040"></a>00040                 }
<a name="l00041"></a>00041 <span class="preprocessor">        #endif</span>
<a name="l00042"></a>00042 <span class="preprocessor"></span>    <a class="code" href="RenderUtils_8cpp.html#aa483b1395dff180a945f71c640e91960">g_protonPixelScaleFactor</a> = <a class="code" href="Renderer_2GL_2glext_8h.html#a281421b881aa7a1266842b73a3bc7655">scale</a>;
<a name="l00043"></a>00043 }
<a name="l00044"></a>00044 
<a name="l00045"></a><a class="code" href="RenderUtils_8h.html#a3e7e066af80a6eba953b00912e268c42">00045</a> <span class="keywordtype">float</span> <a class="code" href="RenderUtils_8cpp.html#a3e7e066af80a6eba953b00912e268c42">GetProtonPixelScaleFactor</a>()
<a name="l00046"></a>00046 {
<a name="l00047"></a>00047     <span class="keywordflow">return</span> <a class="code" href="RenderUtils_8cpp.html#aa483b1395dff180a945f71c640e91960">g_protonPixelScaleFactor</a>;
<a name="l00048"></a>00048 }
<a name="l00049"></a>00049 
<a name="l00050"></a><a class="code" href="RenderUtils_8h.html#ab5d9c04703690d69ac39977c8912cb72">00050</a> <span class="keywordtype">void</span> <a class="code" href="RenderUtils_8cpp.html#ab5d9c04703690d69ac39977c8912cb72">InitBaseScreenSizeFromPrimary</a>()
<a name="l00051"></a>00051 {
<a name="l00052"></a>00052     <span class="comment">//to be called after GetPrimaryGLY() is valid (Only needed on iOS?)</span>
<a name="l00053"></a>00053     <a class="code" href="RenderUtils_8cpp.html#a29018a8eafaae21025d9b09d39ef2740">g_screenSizeY</a> = <a class="code" href="AndroidUtils_8cpp.html#ac274a49195455502331eb617bce938e3">GetPrimaryGLY</a>();
<a name="l00054"></a>00054     <a class="code" href="RenderUtils_8cpp.html#a8805ddbb21195169d1feae1768691b9f">g_screenSizeX</a> = <a class="code" href="AndroidUtils_8cpp.html#a2f0e58aac06a13b950cef03dcc3e7267">GetPrimaryGLX</a>();
<a name="l00055"></a>00055 }
<a name="l00056"></a>00056 
<a name="l00057"></a><a class="code" href="RenderUtils_8h.html#a6df8b9b70e4d558730279af52bce901e">00057</a> <span class="keywordtype">float</span> <a class="code" href="RenderUtils_8cpp.html#a6df8b9b70e4d558730279af52bce901e">GetDeviceSizeDiagonalInInches</a>()
<a name="l00058"></a>00058 {
<a name="l00059"></a>00059         <span class="keywordflow">return</span> <a class="code" href="RenderUtils_8cpp.html#a21625ea22b5fdb970e4fed35e238e829">g_deviceDiagonalSizeInInches</a>;
<a name="l00060"></a>00060 }
<a name="l00061"></a>00061 
<a name="l00062"></a><a class="code" href="RenderUtils_8h.html#a1c22c5df1a3a51d19344f1fe7d75b738">00062</a> <span class="keywordtype">void</span> <a class="code" href="RenderUtils_8cpp.html#a1c22c5df1a3a51d19344f1fe7d75b738">SetDeviceSizeDiagonalInInches</a>(<span class="keywordtype">float</span> sizeInInches)
<a name="l00063"></a>00063 {
<a name="l00064"></a>00064         <a class="code" href="RenderUtils_8cpp.html#a21625ea22b5fdb970e4fed35e238e829">g_deviceDiagonalSizeInInches</a> = sizeInInches;
<a name="l00065"></a>00065 }
<a name="l00066"></a>00066 
<a name="l00067"></a><a class="code" href="RenderUtils_8h.html#aa6679641f6d2bbfcc4acf68ac4de9f31">00067</a> <span class="keywordtype">int</span> <a class="code" href="RenderUtils_8cpp.html#aa6679641f6d2bbfcc4acf68ac4de9f31">GetDevicePixelsPerInchDiagonal</a>()
<a name="l00068"></a>00068 {
<a name="l00069"></a>00069         <span class="keyword">static</span> <span class="keywordtype">int</span> cachedPixelsPerInch = 0;
<a name="l00070"></a>00070 
<a name="l00071"></a>00071         <span class="keywordflow">if</span> (cachedPixelsPerInch == 0)
<a name="l00072"></a>00072         {
<a name="l00073"></a>00073                 <span class="comment">//one time look up</span>
<a name="l00074"></a>00074                 
<a name="l00075"></a>00075                 <span class="comment">//First, if SetDeviceSizeDiagonalInInches() was used earlier by the native side, we&#39;re good to go.  If not, we&#39;ll</span>
<a name="l00076"></a>00076                 <span class="comment">//guess.</span>
<a name="l00077"></a>00077 
<a name="l00078"></a>00078                 <span class="keywordflow">if</span> (<a class="code" href="RenderUtils_8cpp.html#a21625ea22b5fdb970e4fed35e238e829">g_deviceDiagonalSizeInInches</a> == 0)
<a name="l00079"></a>00079                 {
<a name="l00080"></a>00080                         <span class="comment">//guess.</span>
<a name="l00081"></a>00081                         <span class="keywordflow">if</span> (IsIphone4Size || IsIphone5Size) cachedPixelsPerInch = 326;
<a name="l00082"></a>00082                         <span class="keywordflow">if</span> (IsIPADSize) cachedPixelsPerInch = 132;
<a name="l00083"></a>00083                         <span class="keywordflow">if</span> (IsIPADRetinaSize) cachedPixelsPerInch = 264;
<a name="l00084"></a>00084                         <span class="keywordflow">if</span> (IsIphoneSize) cachedPixelsPerInch = 163;
<a name="l00085"></a>00085                         <span class="keywordflow">if</span> (IsXoomSize) cachedPixelsPerInch = 149;
<a name="l00086"></a>00086                         <span class="keywordflow">if</span> (IsDroidSize) cachedPixelsPerInch = 265;
<a name="l00087"></a>00087                         <span class="keywordflow">if</span> (IsNexusOneSize) cachedPixelsPerInch = 235;
<a name="l00088"></a>00088                         <span class="keywordflow">if</span> (IsPlaybookSize) cachedPixelsPerInch = 169;
<a name="l00089"></a>00089 
<a name="l00090"></a>00090                         <span class="keywordflow">if</span> (cachedPixelsPerInch == 0)
<a name="l00091"></a>00091                         {
<a name="l00092"></a>00092                                 <span class="comment">//we really have no clue</span>
<a name="l00093"></a>00093                                 cachedPixelsPerInch = 163;
<a name="l00094"></a>00094                         }
<a name="l00095"></a>00095                 } <span class="keywordflow">else</span>
<a name="l00096"></a>00096                 {
<a name="l00097"></a>00097                         cachedPixelsPerInch = (int) (<a class="code" href="RenderUtils_8cpp.html#aee5b3b778353e2e1c7f33b894c0dfaf8" title="Constructs a vector from the values returned by GetScreenSizeXf() and GetScreenSizeYf().">GetScreenSize</a>().length() / <a class="code" href="RenderUtils_8cpp.html#a21625ea22b5fdb970e4fed35e238e829">g_deviceDiagonalSizeInInches</a>);
<a name="l00098"></a>00098                 }
<a name="l00099"></a>00099         }
<a name="l00100"></a>00100 
<a name="l00101"></a>00101         <span class="keywordflow">return</span> cachedPixelsPerInch;     
<a name="l00102"></a>00102 }
<a name="l00103"></a>00103 
<a name="l00104"></a><a class="code" href="RenderUtils_8h.html#a2b4c4a05728b579769e3aef19b271a2d">00104</a> <span class="keywordtype">void</span> <a class="code" href="RenderUtils_8cpp.html#a2b4c4a05728b579769e3aef19b271a2d">RenderGLTriangle</a>()
<a name="l00105"></a>00105 {
<a name="l00106"></a>00106         <span class="comment">//let&#39;s draw a simple triangle </span>
<a name="l00107"></a>00107         <span class="comment">/*</span>
<a name="l00108"></a>00108 <span class="comment">         2</span>
<a name="l00109"></a>00109 <span class="comment">        0 1</span>
<a name="l00110"></a>00110 <span class="comment">        */</span>
<a name="l00111"></a>00111 
<a name="l00112"></a>00112         <span class="keyword">const</span> <span class="keywordtype">float</span> triSize = 0.4f;
<a name="l00113"></a>00113 
<a name="l00114"></a>00114         <a class="code" href="flash_2GLES_2gl_8h.html#a836cf6377099e88abf24c255b5b0ac52">GLfloat</a> vVertices[] = 
<a name="l00115"></a>00115         {
<a name="l00116"></a>00116                 -triSize, -triSize, 0.0f,
<a name="l00117"></a>00117                 triSize, -triSize, 0.0f,
<a name="l00118"></a>00118                 0.0f, triSize, 0.0f
<a name="l00119"></a>00119         };
<a name="l00120"></a>00120         <a class="code" href="GLFlashAdaptor_8cpp.html#a80fb7c3b62fc0b18c40424cf3bc22d13">glDisable</a>(GL_BLEND);
<a name="l00121"></a>00121         <a class="code" href="GLFlashAdaptor_8cpp.html#a80fb7c3b62fc0b18c40424cf3bc22d13">glDisable</a>(GL_ALPHA_TEST);
<a name="l00122"></a>00122 
<a name="l00123"></a>00123         <a class="code" href="GLFlashAdaptor_8cpp.html#a80fb7c3b62fc0b18c40424cf3bc22d13">glDisable</a>(GL_TEXTURE_2D);
<a name="l00124"></a>00124         <a class="code" href="GLFlashAdaptor_8cpp.html#ad4d5af9621c6fd6339889bdb295e11c8">glEnableClientState</a>(GL_VERTEX_ARRAY);
<a name="l00125"></a>00125         <a class="code" href="GLFlashAdaptor_8cpp.html#ae706b283dab261d2212bccd9bf30fc32">glVertexPointer</a>(3, GL_FLOAT,  0, vVertices);
<a name="l00126"></a>00126 
<a name="l00127"></a>00127         <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> rgba = MAKE_RGBA(255,0,0,255);
<a name="l00128"></a>00128         <a class="code" href="GLFlashAdaptor_8cpp.html#aeed45e81d121fa686b8286a2855d655c">glColor4x</a>( (rgba &gt;&gt;8 &amp; 0xFF)*256,  (rgba&gt;&gt;16&amp; 0xFF)*256, (rgba&gt;&gt;24&amp; 0xFF)*256, (rgba&amp;0xFF)*256);
<a name="l00129"></a>00129         <a class="code" href="GLFlashAdaptor_8cpp.html#a90fb252b1dfce3a2c9a96d605693450b">glDisableClientState</a>( GL_TEXTURE_COORD_ARRAY );
<a name="l00130"></a>00130 
<a name="l00131"></a>00131         <a class="code" href="GLFlashAdaptor_8cpp.html#a0e3de4d267f017c28a03fc4375a4b40e">glDrawArrays</a>(GL_TRIANGLES, 0, 3);
<a name="l00132"></a>00132         <span class="comment">//fix the color back to white</span>
<a name="l00133"></a>00133         <a class="code" href="GLFlashAdaptor_8cpp.html#aeed45e81d121fa686b8286a2855d655c">glColor4x</a>(1 &lt;&lt; 16, 1 &lt;&lt; 16, 1 &lt;&lt; 16, 1 &lt;&lt; 16);
<a name="l00134"></a>00134 
<a name="l00135"></a>00135 
<a name="l00136"></a>00136         <a class="code" href="GLFlashAdaptor_8cpp.html#ad4d5af9621c6fd6339889bdb295e11c8">glEnableClientState</a>( GL_TEXTURE_COORD_ARRAY );
<a name="l00137"></a>00137         <a class="code" href="GLFlashAdaptor_8cpp.html#a408bccf3c3cf0419446bf36c64a3adc0">glEnable</a>(GL_TEXTURE_2D);
<a name="l00138"></a>00138         CHECK_GL_ERROR();
<a name="l00139"></a>00139 }
<a name="l00140"></a>00140 
<a name="l00141"></a>00141 
<a name="l00142"></a><a class="code" href="RenderUtils_8h.html#a5ba9beb0df8a68b13c5571a6f0e676e9">00142</a> <span class="keywordtype">void</span> <a class="code" href="RenderUtils_8cpp.html#a5ba9beb0df8a68b13c5571a6f0e676e9">RenderSpinningTriangle</a>()
<a name="l00143"></a>00143 {
<a name="l00144"></a>00144 
<a name="l00145"></a>00145         <a class="code" href="GLFlashAdaptor_8cpp.html#a5b2a1a17e595774a852426a5ed64c023">glPushMatrix</a>();
<a name="l00146"></a>00146         
<a name="l00147"></a>00147     <a class="code" href="GLFlashAdaptor_8cpp.html#a77d245cb8a1701a1dedc8c1d5796a836">glLoadIdentity</a>();
<a name="l00148"></a>00148         <a class="code" href="GLFlashAdaptor_8cpp.html#ae9636873ef091fbb322604d8b97b4e4e">glTranslatef</a>(0,0,-2);
<a name="l00149"></a>00149         <a class="code" href="GLFlashAdaptor_8cpp.html#a47507478dc599b4b4fd9619a7a6aec45">glRotatef</a>(<span class="keywordtype">float</span>( (<a class="code" href="BaseApp_8h.html#a72086b48d24daf0a65dd20189a16bd16">GetBaseApp</a>()-&gt;GetGameTick()/10) %360) , 0, 1, 0); <span class="comment">//rotate it</span>
<a name="l00150"></a>00150         <a class="code" href="GLFlashAdaptor_8cpp.html#a80fb7c3b62fc0b18c40424cf3bc22d13">glDisable</a>(GL_CULL_FACE); <span class="comment">//so we can see the back of the triangle too</span>
<a name="l00151"></a>00151         <a class="code" href="RenderUtils_8cpp.html#a2b4c4a05728b579769e3aef19b271a2d">RenderGLTriangle</a>();
<a name="l00152"></a>00152         <a class="code" href="GLFlashAdaptor_8cpp.html#a408bccf3c3cf0419446bf36c64a3adc0">glEnable</a>(GL_CULL_FACE); <span class="comment">//so we can see the back of the triangle too</span>
<a name="l00153"></a>00153         <a class="code" href="GLFlashAdaptor_8cpp.html#aa7108f2235d7790ff4e9b20a53306625">glPopMatrix</a>();
<a name="l00154"></a>00154         CHECK_GL_ERROR();
<a name="l00155"></a>00155 }
<a name="l00156"></a>00156 
<a name="l00157"></a><a class="code" href="RenderUtils_8h.html#a0201bbc91614bfeda96ec2e275ee2ef8">00157</a> <span class="keywordtype">void</span> <a class="code" href="RenderUtils_8cpp.html#a0201bbc91614bfeda96ec2e275ee2ef8">RenderTexturedGLTriangle</a>()
<a name="l00158"></a>00158 {
<a name="l00159"></a>00159 
<a name="l00160"></a>00160 
<a name="l00161"></a>00161         <a class="code" href="GLFlashAdaptor_8cpp.html#a5b2a1a17e595774a852426a5ed64c023">glPushMatrix</a>();
<a name="l00162"></a>00162         <span class="comment">//glLoadIdentity();</span>
<a name="l00163"></a>00163         <span class="comment">//glTranslatef(0,0,-2);</span>
<a name="l00164"></a>00164         <a class="code" href="GLFlashAdaptor_8cpp.html#a47507478dc599b4b4fd9619a7a6aec45">glRotatef</a>(<span class="keywordtype">float</span>( (<a class="code" href="BaseApp_8h.html#a72086b48d24daf0a65dd20189a16bd16">GetBaseApp</a>()-&gt;GetGameTick()/10) %360) , 0, 1, 0); <span class="comment">//rotate it</span>
<a name="l00165"></a>00165         <a class="code" href="GLFlashAdaptor_8cpp.html#a80fb7c3b62fc0b18c40424cf3bc22d13">glDisable</a>(GL_CULL_FACE); <span class="comment">//so we can see the back of the triangle too</span>
<a name="l00166"></a>00166 
<a name="l00167"></a>00167 
<a name="l00168"></a>00168 
<a name="l00169"></a>00169         <span class="comment">//let&#39;s draw a simple triangle </span>
<a name="l00170"></a>00170         <span class="comment">/*</span>
<a name="l00171"></a>00171 <span class="comment">         2</span>
<a name="l00172"></a>00172 <span class="comment">        0 1</span>
<a name="l00173"></a>00173 <span class="comment">        */</span>
<a name="l00174"></a>00174 
<a name="l00175"></a>00175         <span class="keyword">const</span> <span class="keywordtype">float</span> triSize = 0.4f;
<a name="l00176"></a>00176 
<a name="l00177"></a>00177         <a class="code" href="flash_2GLES_2gl_8h.html#a836cf6377099e88abf24c255b5b0ac52">GLfloat</a> vVertices[] = 
<a name="l00178"></a>00178         {
<a name="l00179"></a>00179                 -triSize, -triSize, 0.0f,
<a name="l00180"></a>00180                 triSize, -triSize, 0.0f,
<a name="l00181"></a>00181                 0.0f, triSize, 0.0f
<a name="l00182"></a>00182         };
<a name="l00183"></a>00183 
<a name="l00184"></a>00184         <a class="code" href="flash_2GLES_2gl_8h.html#a836cf6377099e88abf24c255b5b0ac52">GLfloat</a> vTexCoords[] = 
<a name="l00185"></a>00185         {
<a name="l00186"></a>00186                 0,0,
<a name="l00187"></a>00187                 1, 0,
<a name="l00188"></a>00188                 0.5,1
<a name="l00189"></a>00189         };
<a name="l00190"></a>00190         <span class="comment">//unsigned int rgba = MAKE_RGBA(255,255,255,255);</span>
<a name="l00191"></a>00191         <span class="comment">//glColor4x( (rgba &gt;&gt;8 &amp; 0xFF)*256,  (rgba&gt;&gt;16&amp; 0xFF)*256, (rgba&gt;&gt;24&amp; 0xFF)*256, (rgba&amp;0xFF)*256);</span>
<a name="l00192"></a>00192         
<a name="l00193"></a>00193         <a class="code" href="GLFlashAdaptor_8cpp.html#ae706b283dab261d2212bccd9bf30fc32">glVertexPointer</a>(3, GL_FLOAT,  0, vVertices);
<a name="l00194"></a>00194         <a class="code" href="GLFlashAdaptor_8cpp.html#a908d9972fc3b4d93a9e71cce50c91fe6">glTexCoordPointer</a>(2, GL_FLOAT,  0, vTexCoords);
<a name="l00195"></a>00195 
<a name="l00196"></a>00196         <a class="code" href="GLFlashAdaptor_8cpp.html#ad4d5af9621c6fd6339889bdb295e11c8">glEnableClientState</a>(GL_VERTEX_ARRAY);
<a name="l00197"></a>00197         <a class="code" href="GLFlashAdaptor_8cpp.html#ad4d5af9621c6fd6339889bdb295e11c8">glEnableClientState</a>(GL_TEXTURE_COORD_ARRAY);
<a name="l00198"></a>00198         
<a name="l00199"></a>00199         <a class="code" href="GLFlashAdaptor_8cpp.html#a408bccf3c3cf0419446bf36c64a3adc0">glEnable</a>(GL_BLEND);
<a name="l00200"></a>00200         <a class="code" href="GLFlashAdaptor_8cpp.html#a408bccf3c3cf0419446bf36c64a3adc0">glEnable</a>(GL_ALPHA_TEST);
<a name="l00201"></a>00201         <a class="code" href="GLFlashAdaptor_8cpp.html#a80fb7c3b62fc0b18c40424cf3bc22d13">glDisable</a>(GL_CULL_FACE); <span class="comment">//so we can see the back of the triangle too</span>
<a name="l00202"></a>00202 
<a name="l00203"></a>00203         <a class="code" href="GLFlashAdaptor_8cpp.html#a0e3de4d267f017c28a03fc4375a4b40e">glDrawArrays</a>(GL_TRIANGLES, 0, 3);
<a name="l00204"></a>00204         <a class="code" href="GLFlashAdaptor_8cpp.html#a408bccf3c3cf0419446bf36c64a3adc0">glEnable</a>(GL_CULL_FACE);
<a name="l00205"></a>00205         <a class="code" href="GLFlashAdaptor_8cpp.html#a80fb7c3b62fc0b18c40424cf3bc22d13">glDisable</a>(GL_BLEND);
<a name="l00206"></a>00206         <a class="code" href="GLFlashAdaptor_8cpp.html#a80fb7c3b62fc0b18c40424cf3bc22d13">glDisable</a>(GL_ALPHA_TEST);
<a name="l00207"></a>00207         CHECK_GL_ERROR();
<a name="l00208"></a>00208 
<a name="l00209"></a>00209         <a class="code" href="GLFlashAdaptor_8cpp.html#a408bccf3c3cf0419446bf36c64a3adc0">glEnable</a>(GL_CULL_FACE); <span class="comment">//so we can see the back of the triangle too</span>
<a name="l00210"></a>00210         <a class="code" href="GLFlashAdaptor_8cpp.html#aa7108f2235d7790ff4e9b20a53306625">glPopMatrix</a>();
<a name="l00211"></a>00211         CHECK_GL_ERROR();
<a name="l00212"></a>00212 }
<a name="l00213"></a>00213 
<a name="l00214"></a>00214 
<a name="l00215"></a>00215 
<a name="l00216"></a><a class="code" href="RenderUtils_8h.html#a2e26509348b87e44799cf564e6289cf1">00216</a> <span class="keywordtype">void</span> <a class="code" href="RenderUtils_8cpp.html#a2e26509348b87e44799cf564e6289cf1">RenderTexturedGLTriangleWithDrawElements</a>()
<a name="l00217"></a>00217 {
<a name="l00218"></a>00218 
<a name="l00219"></a>00219         <a class="code" href="GLFlashAdaptor_8cpp.html#a5b2a1a17e595774a852426a5ed64c023">glPushMatrix</a>();
<a name="l00220"></a>00220         <a class="code" href="GLFlashAdaptor_8cpp.html#a77d245cb8a1701a1dedc8c1d5796a836">glLoadIdentity</a>();
<a name="l00221"></a>00221         <a class="code" href="GLFlashAdaptor_8cpp.html#ae9636873ef091fbb322604d8b97b4e4e">glTranslatef</a>(0,0,-2);
<a name="l00222"></a>00222         <a class="code" href="GLFlashAdaptor_8cpp.html#a47507478dc599b4b4fd9619a7a6aec45">glRotatef</a>(<span class="keywordtype">float</span>( (<a class="code" href="BaseApp_8h.html#a72086b48d24daf0a65dd20189a16bd16">GetBaseApp</a>()-&gt;GetGameTick()/10) %360) , 0, 1, 0); <span class="comment">//rotate it</span>
<a name="l00223"></a>00223         <a class="code" href="GLFlashAdaptor_8cpp.html#a80fb7c3b62fc0b18c40424cf3bc22d13">glDisable</a>(GL_CULL_FACE); <span class="comment">//so we can see the back of the triangle too</span>
<a name="l00224"></a>00224 
<a name="l00225"></a>00225 
<a name="l00226"></a>00226         <span class="comment">//let&#39;s draw a simple triangle </span>
<a name="l00227"></a>00227         <span class="comment">/*</span>
<a name="l00228"></a>00228 <span class="comment">         2</span>
<a name="l00229"></a>00229 <span class="comment">        0 1</span>
<a name="l00230"></a>00230 <span class="comment">        */</span>
<a name="l00231"></a>00231 
<a name="l00232"></a>00232         <span class="keyword">const</span> <span class="keywordtype">float</span> triSize = 0.4f;
<a name="l00233"></a>00233 
<a name="l00234"></a>00234         <a class="code" href="flash_2GLES_2gl_8h.html#a836cf6377099e88abf24c255b5b0ac52">GLfloat</a> vVertices[] = 
<a name="l00235"></a>00235         {
<a name="l00236"></a>00236                 4000,4000,4000,
<a name="l00237"></a>00237                 4000,4000,4000,
<a name="l00238"></a>00238 
<a name="l00239"></a>00239                 -triSize, -triSize, 0.0f,
<a name="l00240"></a>00240                 triSize, -triSize, 0.0f,
<a name="l00241"></a>00241                 0.0f, triSize, 0.0f
<a name="l00242"></a>00242         };
<a name="l00243"></a>00243 
<a name="l00244"></a>00244         <a class="code" href="flash_2GLES_2gl_8h.html#a836cf6377099e88abf24c255b5b0ac52">GLfloat</a> vTexCoords[] = 
<a name="l00245"></a>00245         {
<a name="l00246"></a>00246                 0,0,
<a name="l00247"></a>00247                 0,0,
<a name="l00248"></a>00248                 0,0,
<a name="l00249"></a>00249                 1, 0,
<a name="l00250"></a>00250                 0.5,1
<a name="l00251"></a>00251         };
<a name="l00252"></a>00252         <span class="comment">//unsigned int rgba = MAKE_RGBA(255,255,255,255);</span>
<a name="l00253"></a>00253         <span class="comment">//glColor4x( (rgba &gt;&gt;8 &amp; 0xFF)*256,  (rgba&gt;&gt;16&amp; 0xFF)*256, (rgba&gt;&gt;24&amp; 0xFF)*256, (rgba&amp;0xFF)*256);</span>
<a name="l00254"></a>00254         
<a name="l00255"></a>00255 <span class="preprocessor">#ifdef RT_GLES_ADAPTOR_MODE</span>
<a name="l00256"></a>00256 <span class="preprocessor"></span>        <span class="comment">//glVertexPointerEx(3, GL_FLOAT,  0, vVertices, 5);</span>
<a name="l00257"></a>00257 
<a name="l00258"></a>00258         <span class="comment">//make sure doing it the dumb way still works too</span>
<a name="l00259"></a>00259         <a class="code" href="GLFlashAdaptor_8cpp.html#ae706b283dab261d2212bccd9bf30fc32">glVertexPointer</a>(3, GL_FLOAT,  0, vVertices);
<a name="l00260"></a>00260 <span class="preprocessor">#else</span>
<a name="l00261"></a>00261 <span class="preprocessor"></span>        <a class="code" href="GLFlashAdaptor_8cpp.html#ae706b283dab261d2212bccd9bf30fc32">glVertexPointer</a>(3, GL_FLOAT,  0, vVertices);
<a name="l00262"></a>00262 <span class="preprocessor">#endif</span>
<a name="l00263"></a>00263 <span class="preprocessor"></span>        <a class="code" href="GLFlashAdaptor_8cpp.html#a908d9972fc3b4d93a9e71cce50c91fe6">glTexCoordPointer</a>(2, GL_FLOAT,  0, vTexCoords);
<a name="l00264"></a>00264 
<a name="l00265"></a>00265         <a class="code" href="GLFlashAdaptor_8cpp.html#ad4d5af9621c6fd6339889bdb295e11c8">glEnableClientState</a>(GL_VERTEX_ARRAY);
<a name="l00266"></a>00266         <a class="code" href="GLFlashAdaptor_8cpp.html#ad4d5af9621c6fd6339889bdb295e11c8">glEnableClientState</a>(GL_TEXTURE_COORD_ARRAY);
<a name="l00267"></a>00267         
<a name="l00268"></a>00268         <a class="code" href="GLFlashAdaptor_8cpp.html#a408bccf3c3cf0419446bf36c64a3adc0">glEnable</a>(GL_BLEND);
<a name="l00269"></a>00269         <a class="code" href="GLFlashAdaptor_8cpp.html#a408bccf3c3cf0419446bf36c64a3adc0">glEnable</a>(GL_ALPHA_TEST);
<a name="l00270"></a>00270         <a class="code" href="GLFlashAdaptor_8cpp.html#a80fb7c3b62fc0b18c40424cf3bc22d13">glDisable</a>(GL_CULL_FACE); <span class="comment">//so we can see the back of the triangle too</span>
<a name="l00271"></a>00271 
<a name="l00272"></a>00272         <span class="comment">//glDrawArrays(GL_TRIANGLES, 0, 3);</span>
<a name="l00273"></a>00273         
<a name="l00274"></a>00274         <a class="code" href="PlatformSetupAndroid_8h.html#ac2a9e79eb120216f855626495b7bd18a">uint16</a> <a class="code" href="Renderer_2GL_2glext_8h.html#a57f14e05b1900f16a2da82ade47d0c6d">index</a>[5];
<a name="l00275"></a>00275         index[0] = 0;
<a name="l00276"></a>00276         index[1] = 1;
<a name="l00277"></a>00277         index[2] = 2;
<a name="l00278"></a>00278         index[3] = 3;
<a name="l00279"></a>00279         index[4] = 4;
<a name="l00280"></a>00280 
<a name="l00281"></a>00281         <span class="comment">//setup to start at an offset, needed this to test something</span>
<a name="l00282"></a>00282         <a class="code" href="GLFlashAdaptor_8cpp.html#a4c803d4bb0ea98960162485dded73d9c">glDrawElements</a>(GL_TRIANGLES, 3, GL_UNSIGNED_SHORT, &amp;index[2]);
<a name="l00283"></a>00283         
<a name="l00284"></a>00284         <a class="code" href="GLFlashAdaptor_8cpp.html#a408bccf3c3cf0419446bf36c64a3adc0">glEnable</a>(GL_CULL_FACE);
<a name="l00285"></a>00285         <a class="code" href="GLFlashAdaptor_8cpp.html#a80fb7c3b62fc0b18c40424cf3bc22d13">glDisable</a>(GL_BLEND);
<a name="l00286"></a>00286         <a class="code" href="GLFlashAdaptor_8cpp.html#a80fb7c3b62fc0b18c40424cf3bc22d13">glDisable</a>(GL_ALPHA_TEST);
<a name="l00287"></a>00287         CHECK_GL_ERROR();
<a name="l00288"></a>00288 
<a name="l00289"></a>00289         <a class="code" href="GLFlashAdaptor_8cpp.html#a408bccf3c3cf0419446bf36c64a3adc0">glEnable</a>(GL_CULL_FACE); <span class="comment">//so we can see the back of the triangle too</span>
<a name="l00290"></a>00290         <a class="code" href="GLFlashAdaptor_8cpp.html#aa7108f2235d7790ff4e9b20a53306625">glPopMatrix</a>();
<a name="l00291"></a>00291         CHECK_GL_ERROR();
<a name="l00292"></a>00292 }
<a name="l00293"></a>00293 
<a name="l00294"></a><a class="code" href="RenderUtils_8h.html#aeca4128ce8278bac58b14b1dcfd2f382">00294</a> <span class="keywordtype">void</span> <a class="code" href="RenderUtils_8cpp.html#a1c980d6ad9674b011d6f00e75d777796">RenderTexturedRectangle</a>(<span class="keywordtype">float</span> RectSize)
<a name="l00295"></a>00295 {
<a name="l00296"></a>00296         <span class="comment">//let&#39;s draw a simple rectangle</span>
<a name="l00297"></a>00297         <span class="comment">/*</span>
<a name="l00298"></a>00298 <span class="comment">        3 2</span>
<a name="l00299"></a>00299 <span class="comment">        0 1</span>
<a name="l00300"></a>00300 <span class="comment">        */</span>
<a name="l00301"></a>00301 
<a name="l00302"></a>00302         <a class="code" href="flash_2GLES_2gl_8h.html#a836cf6377099e88abf24c255b5b0ac52">GLfloat</a> vVertices[] = 
<a name="l00303"></a>00303         {
<a name="l00304"></a>00304                 -RectSize, -RectSize, 0.0f,
<a name="l00305"></a>00305                 RectSize, -RectSize, 0.0f,
<a name="l00306"></a>00306                 RectSize, RectSize, 0.0f,
<a name="l00307"></a>00307                 -RectSize, RectSize, 0.0f
<a name="l00308"></a>00308         };
<a name="l00309"></a>00309 
<a name="l00310"></a>00310         <a class="code" href="flash_2GLES_2gl_8h.html#a836cf6377099e88abf24c255b5b0ac52">GLfloat</a> vTexCoords[] = 
<a name="l00311"></a>00311         {
<a name="l00312"></a>00312                 0,0,
<a name="l00313"></a>00313                 1,0,
<a name="l00314"></a>00314                 1, 1,
<a name="l00315"></a>00315                 0, 1
<a name="l00316"></a>00316         };
<a name="l00317"></a>00317         <span class="comment">//unsigned int rgba = MAKE_RGBA(255,255,255,255);</span>
<a name="l00318"></a>00318         <span class="comment">//glColor4x( (rgba &gt;&gt;8 &amp; 0xFF)*256,  (rgba&gt;&gt;16&amp; 0xFF)*256, (rgba&gt;&gt;24&amp; 0xFF)*256, (rgba&amp;0xFF)*256);</span>
<a name="l00319"></a>00319         <a class="code" href="GLFlashAdaptor_8cpp.html#ae706b283dab261d2212bccd9bf30fc32">glVertexPointer</a>(3, GL_FLOAT,  0, vVertices);
<a name="l00320"></a>00320         <a class="code" href="GLFlashAdaptor_8cpp.html#a908d9972fc3b4d93a9e71cce50c91fe6">glTexCoordPointer</a>(2, GL_FLOAT,  0, vTexCoords);
<a name="l00321"></a>00321 
<a name="l00322"></a>00322         <a class="code" href="GLFlashAdaptor_8cpp.html#ad4d5af9621c6fd6339889bdb295e11c8">glEnableClientState</a>(GL_VERTEX_ARRAY);
<a name="l00323"></a>00323         <a class="code" href="GLFlashAdaptor_8cpp.html#ad4d5af9621c6fd6339889bdb295e11c8">glEnableClientState</a>(GL_TEXTURE_COORD_ARRAY);
<a name="l00324"></a>00324 
<a name="l00325"></a>00325         <a class="code" href="GLFlashAdaptor_8cpp.html#a408bccf3c3cf0419446bf36c64a3adc0">glEnable</a>(GL_BLEND);
<a name="l00326"></a>00326         <a class="code" href="GLFlashAdaptor_8cpp.html#a408bccf3c3cf0419446bf36c64a3adc0">glEnable</a>(GL_ALPHA_TEST);
<a name="l00327"></a>00327         
<a name="l00328"></a>00328         <a class="code" href="GLFlashAdaptor_8cpp.html#a0e3de4d267f017c28a03fc4375a4b40e">glDrawArrays</a>(GL_TRIANGLE_FAN, 0, 4);
<a name="l00329"></a>00329         
<a name="l00330"></a>00330         <a class="code" href="GLFlashAdaptor_8cpp.html#a80fb7c3b62fc0b18c40424cf3bc22d13">glDisable</a>(GL_BLEND);
<a name="l00331"></a>00331         <a class="code" href="GLFlashAdaptor_8cpp.html#a80fb7c3b62fc0b18c40424cf3bc22d13">glDisable</a>(GL_ALPHA_TEST);
<a name="l00332"></a>00332 }
<a name="l00333"></a>00333 
<a name="l00334"></a>00334 
<a name="l00335"></a><a class="code" href="RenderUtils_8h.html#aa7f61260ed3794b0beea956464839626">00335</a> <span class="keywordtype">void</span> <a class="code" href="RenderUtils_8cpp.html#aa7f61260ed3794b0beea956464839626">SetupFakePrimaryScreenSize</a>(<span class="keywordtype">int</span> <a class="code" href="flash_2GLES_2glext_8h.html#a0cdec8e97a75ee9458b23d152bf962d4">x</a>, <span class="keywordtype">int</span> <a class="code" href="flash_2GLES_2glext_8h.html#a2532a9f8ed3a10a63f5e3c484fbfdb9b">y</a>)
<a name="l00336"></a>00336 {
<a name="l00337"></a>00337         <a class="code" href="RenderUtils_8cpp.html#ad7be9d9913557f7a51de1fba34818995">g_fakePrimaryScreenSizeX</a> = <a class="code" href="flash_2GLES_2glext_8h.html#a0cdec8e97a75ee9458b23d152bf962d4">x</a>;
<a name="l00338"></a>00338         <a class="code" href="RenderUtils_8cpp.html#ae6bd9b4b02a317bfa8dc69ef75ba9f9f">g_fakePrimaryScreenSizeY</a> = <a class="code" href="flash_2GLES_2glext_8h.html#a2532a9f8ed3a10a63f5e3c484fbfdb9b">y</a>;
<a name="l00339"></a>00339         
<a name="l00340"></a>00340         <span class="comment">//recompute it</span>
<a name="l00341"></a>00341         <a class="code" href="RenderUtils_8cpp.html#adf9bef99a628dbdecbdec63b7695ff86">SetupScreenInfo</a>(<a class="code" href="PlatformSetup_8cpp.html#a777ab76cf51e23c407a3b4af05864224" title="Returns the current width of the scene viewport.">GetScreenSizeX</a>(), <a class="code" href="PlatformSetup_8cpp.html#a36f6d11d4206b53c2b078e68c07bbf72" title="Returns the current height of the scene viewport.">GetScreenSizeY</a>(), <a class="code" href="RenderUtils_8cpp.html#a23d7ec03c9dd69ce0af19858d1c4ff79">GetOrientation</a>());
<a name="l00342"></a>00342 };
<a name="l00343"></a>00343 
<a name="l00344"></a>00344 
<a name="l00345"></a><a class="code" href="RenderUtils_8cpp.html#a96c0da463bd5670c07c40e3d2d276b07">00345</a> <span class="keywordtype">void</span> <a class="code" href="RenderUtils_8cpp.html#a96c0da463bd5670c07c40e3d2d276b07">SetupOriginalScreenSize</a>(<span class="keywordtype">int</span> <a class="code" href="flash_2GLES_2glext_8h.html#a0cdec8e97a75ee9458b23d152bf962d4">x</a>, <span class="keywordtype">int</span> <a class="code" href="flash_2GLES_2glext_8h.html#a2532a9f8ed3a10a63f5e3c484fbfdb9b">y</a>)
<a name="l00346"></a>00346 {
<a name="l00347"></a>00347         <a class="code" href="RenderUtils_8cpp.html#a3b90898ec57defcde351fa39ed3eacab">g_originalScreenSizeX</a> = <a class="code" href="flash_2GLES_2glext_8h.html#a0cdec8e97a75ee9458b23d152bf962d4">x</a>;
<a name="l00348"></a>00348         <a class="code" href="RenderUtils_8cpp.html#a4b10169c604df1ce7323a9e52ccb3dd9">g_originalScreenSizeY</a> = <a class="code" href="flash_2GLES_2glext_8h.html#a2532a9f8ed3a10a63f5e3c484fbfdb9b">y</a>;
<a name="l00349"></a>00349 
<a name="l00350"></a>00350 };
<a name="l00351"></a>00351 
<a name="l00352"></a><a class="code" href="RenderUtils_8h.html#ae45d5b731d966b26bb3084d02a26f52f">00352</a> <span class="keywordtype">int</span> <a class="code" href="RenderUtils_8cpp.html#ae45d5b731d966b26bb3084d02a26f52f">GetOriginalScreenSizeX</a>()
<a name="l00353"></a>00353 {
<a name="l00354"></a>00354         <span class="keywordflow">return</span> <a class="code" href="RenderUtils_8cpp.html#a3b90898ec57defcde351fa39ed3eacab">g_originalScreenSizeX</a>;
<a name="l00355"></a>00355 }
<a name="l00356"></a>00356 
<a name="l00357"></a><a class="code" href="RenderUtils_8h.html#a81abf98e820587f565885aed5afa787c">00357</a> <span class="keywordtype">int</span> <a class="code" href="RenderUtils_8cpp.html#a81abf98e820587f565885aed5afa787c">GetOriginalScreenSizeY</a>()
<a name="l00358"></a>00358 {
<a name="l00359"></a>00359         <span class="keywordflow">return</span> <a class="code" href="RenderUtils_8cpp.html#a4b10169c604df1ce7323a9e52ccb3dd9">g_originalScreenSizeY</a>;
<a name="l00360"></a>00360 }
<a name="l00361"></a>00361 
<a name="l00362"></a><a class="code" href="RenderUtils_8h.html#a83c3f5c13f3df84f49039f43f7aaad3c">00362</a> <span class="keywordtype">int</span> <a class="code" href="RenderUtils_8cpp.html#a83c3f5c13f3df84f49039f43f7aaad3c">GetFakePrimaryScreenSizeX</a>()
<a name="l00363"></a>00363 {
<a name="l00364"></a>00364         <span class="keywordflow">return</span> <a class="code" href="RenderUtils_8cpp.html#ad7be9d9913557f7a51de1fba34818995">g_fakePrimaryScreenSizeX</a>;
<a name="l00365"></a>00365 }
<a name="l00366"></a>00366 
<a name="l00367"></a><a class="code" href="RenderUtils_8h.html#a5aa95ad79520615ad77c797f7adf8cf2">00367</a> <span class="keywordtype">int</span> <a class="code" href="RenderUtils_8cpp.html#a5aa95ad79520615ad77c797f7adf8cf2">GetFakePrimaryScreenSizeY</a>()
<a name="l00368"></a>00368 {
<a name="l00369"></a>00369         <span class="keywordflow">return</span> <a class="code" href="RenderUtils_8cpp.html#ae6bd9b4b02a317bfa8dc69ef75ba9f9f">g_fakePrimaryScreenSizeY</a>;
<a name="l00370"></a>00370 }
<a name="l00371"></a>00371 
<a name="l00372"></a><a class="code" href="RenderUtils_8cpp.html#a9a9d77147751e048148da4048540b3c3">00372</a> <span class="keywordtype">int</span> <a class="code" href="RenderUtils_8cpp.html#a9a9d77147751e048148da4048540b3c3">g_undoFakeScreenSizeX</a> = 0;
<a name="l00373"></a><a class="code" href="RenderUtils_8cpp.html#aabbc0fbc9f5257779e9a370378634f0d">00373</a> <span class="keywordtype">int</span> <a class="code" href="RenderUtils_8cpp.html#aabbc0fbc9f5257779e9a370378634f0d">g_undoFakeScreenSizeY</a> = 0;
<a name="l00374"></a>00374 
<a name="l00375"></a><a class="code" href="RenderUtils_8h.html#abc7f81de912db99e43640031b5b6b330">00375</a> <span class="keywordtype">bool</span> <a class="code" href="RenderUtils_8cpp.html#abc7f81de912db99e43640031b5b6b330">NeedToUseFakeScreenSize</a>()
<a name="l00376"></a>00376 {
<a name="l00377"></a>00377         <span class="keywordflow">if</span> (<a class="code" href="RenderUtils_8cpp.html#ad7be9d9913557f7a51de1fba34818995">g_fakePrimaryScreenSizeX</a> == 0) <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00378"></a>00378         <span class="keywordflow">if</span> (<a class="code" href="RenderUtils_8cpp.html#ad7be9d9913557f7a51de1fba34818995">g_fakePrimaryScreenSizeX</a> == <a class="code" href="AndroidUtils_8cpp.html#a2f0e58aac06a13b950cef03dcc3e7267">GetPrimaryGLX</a>()
<a name="l00379"></a>00379                 &amp;&amp; <a class="code" href="RenderUtils_8cpp.html#ae6bd9b4b02a317bfa8dc69ef75ba9f9f">g_fakePrimaryScreenSizeY</a> == <a class="code" href="AndroidUtils_8cpp.html#ac274a49195455502331eb617bce938e3">GetPrimaryGLY</a>())  <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00380"></a>00380         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00381"></a>00381 }
<a name="l00382"></a><a class="code" href="RenderUtils_8h.html#a577e27bc741bce7700de55c0de6e09d1">00382</a> <span class="keywordtype">void</span> <a class="code" href="RenderUtils_8cpp.html#a577e27bc741bce7700de55c0de6e09d1">UndoFakeScreenSize</a>()
<a name="l00383"></a>00383 {
<a name="l00384"></a>00384         <span class="keywordflow">if</span> (<a class="code" href="RenderUtils_8cpp.html#a83c3f5c13f3df84f49039f43f7aaad3c">GetFakePrimaryScreenSizeX</a>() == 0) <span class="keywordflow">return</span>; <span class="comment">//not used</span>
<a name="l00385"></a>00385 
<a name="l00386"></a>00386         <a class="code" href="RenderUtils_8cpp.html#a9a9d77147751e048148da4048540b3c3">g_undoFakeScreenSizeX</a> = <a class="code" href="RenderUtils_8cpp.html#ad7be9d9913557f7a51de1fba34818995">g_fakePrimaryScreenSizeX</a>;
<a name="l00387"></a>00387         <a class="code" href="RenderUtils_8cpp.html#aabbc0fbc9f5257779e9a370378634f0d">g_undoFakeScreenSizeY</a> = <a class="code" href="RenderUtils_8cpp.html#ae6bd9b4b02a317bfa8dc69ef75ba9f9f">g_fakePrimaryScreenSizeY</a>;
<a name="l00388"></a>00388 
<a name="l00389"></a>00389         <a class="code" href="RenderUtils_8cpp.html#ad7be9d9913557f7a51de1fba34818995">g_fakePrimaryScreenSizeX</a> = 0;
<a name="l00390"></a>00390         <a class="code" href="RenderUtils_8cpp.html#ae6bd9b4b02a317bfa8dc69ef75ba9f9f">g_fakePrimaryScreenSizeY</a> = 0;
<a name="l00391"></a>00391 
<a name="l00392"></a>00392         <a class="code" href="RenderUtils_8cpp.html#a8805ddbb21195169d1feae1768691b9f">g_screenSizeX</a> = <a class="code" href="RenderUtils_8cpp.html#ae45d5b731d966b26bb3084d02a26f52f">GetOriginalScreenSizeX</a>();
<a name="l00393"></a>00393         <a class="code" href="RenderUtils_8cpp.html#a29018a8eafaae21025d9b09d39ef2740">g_screenSizeY</a> = <a class="code" href="RenderUtils_8cpp.html#a81abf98e820587f565885aed5afa787c">GetOriginalScreenSizeY</a>();
<a name="l00394"></a>00394         
<a name="l00395"></a>00395         <a class="code" href="RenderUtils_8cpp.html#a96c0da463bd5670c07c40e3d2d276b07">SetupOriginalScreenSize</a>(0,0);
<a name="l00396"></a>00396 
<a name="l00397"></a>00397         <a class="code" href="RenderUtils_8cpp.html#adf9bef99a628dbdecbdec63b7695ff86">SetupScreenInfo</a>(<a class="code" href="RenderUtils_8cpp.html#a8805ddbb21195169d1feae1768691b9f">g_screenSizeX</a>,<a class="code" href="RenderUtils_8cpp.html#a29018a8eafaae21025d9b09d39ef2740">g_screenSizeY</a>, <a class="code" href="RenderUtils_8cpp.html#a23d7ec03c9dd69ce0af19858d1c4ff79">GetOrientation</a>());
<a name="l00398"></a>00398         <a class="code" href="GLESUtils_8cpp.html#ac6c3f6a87dbfa09bbcc20c6c4dbe7c20">PrepareForGL</a>(); <span class="comment">//make sure any ortho settings are also updated</span>
<a name="l00399"></a>00399 }
<a name="l00400"></a>00400 
<a name="l00401"></a>00401 
<a name="l00402"></a><a class="code" href="RenderUtils_8h.html#a463a89f0098e75a899e2f43e2ccf4976">00402</a> <span class="keywordtype">void</span> <a class="code" href="RenderUtils_8cpp.html#a463a89f0098e75a899e2f43e2ccf4976">RedoFakeScreenSize</a>()
<a name="l00403"></a>00403 {
<a name="l00404"></a>00404 
<a name="l00405"></a>00405         <span class="keywordflow">if</span> (<a class="code" href="RenderUtils_8cpp.html#a9a9d77147751e048148da4048540b3c3">g_undoFakeScreenSizeX</a>)
<a name="l00406"></a>00406         {
<a name="l00407"></a>00407                 <a class="code" href="RenderUtils_8cpp.html#aa7f61260ed3794b0beea956464839626">SetupFakePrimaryScreenSize</a>(<a class="code" href="RenderUtils_8cpp.html#a9a9d77147751e048148da4048540b3c3">g_undoFakeScreenSizeX</a>, <a class="code" href="RenderUtils_8cpp.html#aabbc0fbc9f5257779e9a370378634f0d">g_undoFakeScreenSizeY</a>);
<a name="l00408"></a>00408                 <a class="code" href="RenderUtils_8cpp.html#adf9bef99a628dbdecbdec63b7695ff86">SetupScreenInfo</a>(<a class="code" href="RenderUtils_8cpp.html#ae45d5b731d966b26bb3084d02a26f52f">GetOriginalScreenSizeX</a>(), <a class="code" href="RenderUtils_8cpp.html#a81abf98e820587f565885aed5afa787c">GetOriginalScreenSizeY</a>(), <a class="code" href="RenderUtils_8cpp.html#a23d7ec03c9dd69ce0af19858d1c4ff79">GetOrientation</a>());
<a name="l00409"></a>00409 
<a name="l00410"></a>00410                 <a class="code" href="RenderUtils_8cpp.html#a9a9d77147751e048148da4048540b3c3">g_undoFakeScreenSizeX</a> = 0;
<a name="l00411"></a>00411                 <a class="code" href="RenderUtils_8cpp.html#aabbc0fbc9f5257779e9a370378634f0d">g_undoFakeScreenSizeY</a> = 0;
<a name="l00412"></a>00412         
<a name="l00413"></a>00413                 <a class="code" href="GLESUtils_8cpp.html#ac6c3f6a87dbfa09bbcc20c6c4dbe7c20">PrepareForGL</a>(); <span class="comment">//make sure any ortho settings are also updated</span>
<a name="l00414"></a>00414         }
<a name="l00415"></a>00415 
<a name="l00416"></a>00416 }
<a name="l00417"></a>00417 
<a name="l00418"></a>00418 
<a name="l00419"></a><a class="code" href="RenderUtils_8cpp.html#a36f6d11d4206b53c2b078e68c07bbf72">00419</a> <span class="keywordtype">int</span> <a class="code" href="PlatformSetup_8cpp.html#a36f6d11d4206b53c2b078e68c07bbf72" title="Returns the current height of the scene viewport.">GetScreenSizeY</a>()
<a name="l00420"></a>00420 {
<a name="l00421"></a>00421         <span class="keywordflow">return</span> <a class="code" href="RenderUtils_8cpp.html#a29018a8eafaae21025d9b09d39ef2740">g_screenSizeY</a>;
<a name="l00422"></a>00422 }
<a name="l00423"></a>00423 
<a name="l00424"></a><a class="code" href="RenderUtils_8cpp.html#a777ab76cf51e23c407a3b4af05864224">00424</a> <span class="keywordtype">int</span> <a class="code" href="PlatformSetup_8cpp.html#a777ab76cf51e23c407a3b4af05864224" title="Returns the current width of the scene viewport.">GetScreenSizeX</a>()
<a name="l00425"></a>00425 {
<a name="l00426"></a>00426         <span class="keywordflow">return</span> <a class="code" href="RenderUtils_8cpp.html#a8805ddbb21195169d1feae1768691b9f">g_screenSizeX</a>;
<a name="l00427"></a>00427 }
<a name="l00428"></a>00428 
<a name="l00429"></a><a class="code" href="RenderUtils_8cpp.html#a94a0deb0a111cc46d8f7285fd3f83838">00429</a> <span class="keywordtype">float</span> <a class="code" href="PlatformSetup_8cpp.html#a94a0deb0a111cc46d8f7285fd3f83838" title="Returns the same as GetScreenSizeY() but as a float.">GetScreenSizeYf</a>()
<a name="l00430"></a>00430 {
<a name="l00431"></a>00431         <span class="keywordflow">return</span> (<span class="keywordtype">float</span>)<a class="code" href="RenderUtils_8cpp.html#a29018a8eafaae21025d9b09d39ef2740">g_screenSizeY</a>;
<a name="l00432"></a>00432 }
<a name="l00433"></a>00433 
<a name="l00434"></a><a class="code" href="RenderUtils_8cpp.html#a3b38aaa65dfcae39c0700887f36f1521">00434</a> <span class="keywordtype">float</span> <a class="code" href="PlatformSetup_8cpp.html#a3b38aaa65dfcae39c0700887f36f1521" title="Returns the same as GetScreenSizeX() but as a float.">GetScreenSizeXf</a>()
<a name="l00435"></a>00435 {
<a name="l00436"></a>00436         <span class="keywordflow">return</span> (<span class="keywordtype">float</span>)<a class="code" href="RenderUtils_8cpp.html#a8805ddbb21195169d1feae1768691b9f">g_screenSizeX</a>;
<a name="l00437"></a>00437 }
<a name="l00438"></a>00438 
<a name="l00439"></a><a class="code" href="RenderUtils_8h.html#aee5b3b778353e2e1c7f33b894c0dfaf8">00439</a> CL_Vec2f <a class="code" href="RenderUtils_8cpp.html#aee5b3b778353e2e1c7f33b894c0dfaf8" title="Constructs a vector from the values returned by GetScreenSizeXf() and GetScreenSizeYf().">GetScreenSize</a>()
<a name="l00440"></a>00440 {
<a name="l00441"></a>00441         <span class="keywordflow">return</span> CL_Vec2f((<span class="keywordtype">float</span>)<a class="code" href="RenderUtils_8cpp.html#a8805ddbb21195169d1feae1768691b9f">g_screenSizeX</a>, (<span class="keywordtype">float</span>)<a class="code" href="RenderUtils_8cpp.html#a29018a8eafaae21025d9b09d39ef2740">g_screenSizeY</a>);
<a name="l00442"></a>00442 }
<a name="l00443"></a>00443 
<a name="l00444"></a><a class="code" href="RenderUtils_8h.html#ad67f3482e8054c649e44474f4d9243ec">00444</a> CL_Rectf <a class="code" href="RenderUtils_8cpp.html#ad67f3482e8054c649e44474f4d9243ec">GetScreenRect</a>()
<a name="l00445"></a>00445 {
<a name="l00446"></a>00446         <span class="keywordflow">return</span> CL_Rectf(0,0, (<span class="keywordtype">float</span>)<a class="code" href="RenderUtils_8cpp.html#a8805ddbb21195169d1feae1768691b9f">g_screenSizeX</a>, (<span class="keywordtype">float</span>)<a class="code" href="RenderUtils_8cpp.html#a29018a8eafaae21025d9b09d39ef2740">g_screenSizeY</a>);
<a name="l00447"></a>00447 }
<a name="l00448"></a>00448 
<a name="l00449"></a>00449 <span class="comment">//true for anything larger than an iPhone</span>
<a name="l00450"></a><a class="code" href="RenderUtils_8cpp.html#a6e3c1d3d5d78acd3bcb38a3970cd51b8">00450</a> <span class="keywordtype">bool</span> <a class="code" href="main_8cpp.html#a6e3c1d3d5d78acd3bcb38a3970cd51b8">IsLargeScreen</a>()
<a name="l00451"></a>00451 {
<a name="l00452"></a>00452         <span class="keywordflow">return</span> <a class="code" href="RenderUtils_8cpp.html#a8805ddbb21195169d1feae1768691b9f">g_screenSizeX</a>&gt;480 || <a class="code" href="RenderUtils_8cpp.html#a29018a8eafaae21025d9b09d39ef2740">g_screenSizeY</a> &gt; 480;
<a name="l00453"></a>00453 }
<a name="l00454"></a>00454 
<a name="l00455"></a><a class="code" href="RenderUtils_8cpp.html#a2d3bee3e0d314663920bf4abd62ead04">00455</a> <span class="keywordtype">bool</span> <a class="code" href="main_8cpp.html#a2d3bee3e0d314663920bf4abd62ead04">IsTabletSize</a>()
<a name="l00456"></a>00456 {
<a name="l00457"></a>00457         <span class="keywordflow">if</span> (<a class="code" href="RenderUtils_8cpp.html#a8805ddbb21195169d1feae1768691b9f">g_screenSizeX</a>&gt;=1024 || <a class="code" href="RenderUtils_8cpp.html#a29018a8eafaae21025d9b09d39ef2740">g_screenSizeY</a> &gt;= 1024)
<a name="l00458"></a>00458         {
<a name="l00459"></a>00459                 <span class="comment">//it&#39;s big, but if the pixel density is high enough, it still counts</span>
<a name="l00460"></a>00460                 <span class="comment">//as small</span>
<a name="l00461"></a>00461                 <span class="keywordflow">if</span> (<a class="code" href="RenderUtils_8cpp.html#aa6679641f6d2bbfcc4acf68ac4de9f31">GetDevicePixelsPerInchDiagonal</a>() &gt; 270) <span class="comment">//comon, even the ipad3 doesn&#39;t have that, must be a phone</span>
<a name="l00462"></a>00462                 {
<a name="l00463"></a>00463                         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00464"></a>00464                 }
<a name="l00465"></a>00465                 <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00466"></a>00466         }
<a name="l00467"></a>00467         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00468"></a>00468 
<a name="l00469"></a>00469 }
<a name="l00470"></a>00470 
<a name="l00471"></a><a class="code" href="RenderUtils_8h.html#a23d7ec03c9dd69ce0af19858d1c4ff79">00471</a> <span class="keywordtype">int</span> <a class="code" href="RenderUtils_8cpp.html#a23d7ec03c9dd69ce0af19858d1c4ff79">GetOrientation</a>() {<span class="keywordflow">return</span> <a class="code" href="RenderUtils_8cpp.html#a85cf675cfb52a2e9025dc3f49ba2d0fe">g_orientation</a>;}
<a name="l00472"></a>00472 
<a name="l00473"></a><a class="code" href="RenderUtils_8h.html#a7bd88908c4ef868e971e324ccaad6e56">00473</a> <span class="keywordtype">bool</span> <a class="code" href="RenderUtils_8cpp.html#a7bd88908c4ef868e971e324ccaad6e56">GetLockedLandscape</a>() {<span class="keywordflow">return</span> <a class="code" href="RenderUtils_8cpp.html#a64478affd05aa6dcad3f9cdea56c89a2">g_lockedLandscape</a>;}
<a name="l00474"></a>00474 
<a name="l00475"></a><a class="code" href="RenderUtils_8h.html#a4ec85e386459c74ac063a638b13dc529">00475</a> <span class="keywordtype">void</span> <a class="code" href="RenderUtils_8cpp.html#a4ec85e386459c74ac063a638b13dc529">SetLockedLandscape</a>(<span class="keywordtype">bool</span> bNew)
<a name="l00476"></a>00476 {
<a name="l00477"></a>00477 
<a name="l00478"></a>00478         <span class="keywordflow">if</span> (<a class="code" href="RenderUtils_8cpp.html#a64478affd05aa6dcad3f9cdea56c89a2">g_lockedLandscape</a> != bNew)
<a name="l00479"></a>00479         {
<a name="l00480"></a>00480                 <a class="code" href="RenderUtils_8cpp.html#a64478affd05aa6dcad3f9cdea56c89a2">g_lockedLandscape</a> = bNew;
<a name="l00481"></a>00481                 
<a name="l00482"></a>00482         
<a name="l00483"></a>00483         <span class="keywordflow">if</span> (!<a class="code" href="BaseApp_8h.html#a72086b48d24daf0a65dd20189a16bd16">GetBaseApp</a>()-&gt;GetManualRotationMode())
<a name="l00484"></a>00484         {
<a name="l00485"></a>00485             <span class="comment">//the system handles rotation, we don&#39;t need to get fancy here</span>
<a name="l00486"></a>00486             <span class="keywordflow">return</span>;
<a name="l00487"></a>00487         }
<a name="l00488"></a>00488         
<a name="l00489"></a>00489         <span class="keywordflow">if</span> (<a class="code" href="RenderUtils_8cpp.html#a23d7ec03c9dd69ce0af19858d1c4ff79">GetOrientation</a>() == <a class="code" href="PlatformEnums_8h.html#a02ed901e93e9d5ffb22fc6a2f0284f3dacd00a965397a558275015a84f2f22dd5">ORIENTATION_PORTRAIT</a> || <a class="code" href="RenderUtils_8cpp.html#a23d7ec03c9dd69ce0af19858d1c4ff79">GetOrientation</a>() == <a class="code" href="PlatformEnums_8h.html#a02ed901e93e9d5ffb22fc6a2f0284f3dae06d63ec66f90a060ad29dc2987f991f">ORIENTATION_PORTRAIT_UPSIDE_DOWN</a>)
<a name="l00490"></a>00490                 {
<a name="l00491"></a>00491 
<a name="l00492"></a>00492             <span class="keywordflow">if</span> (<a class="code" href="AndroidUtils_8cpp.html#a2f0e58aac06a13b950cef03dcc3e7267">GetPrimaryGLX</a>() == 0) <span class="keywordflow">return</span>; <span class="comment">//not initted yet</span>
<a name="l00493"></a>00493                         <span class="keywordflow">if</span> (<a class="code" href="RenderUtils_8cpp.html#a7079164b40bddba9a033641696ce8820">GetForcedOrientation</a>() != <a class="code" href="PlatformEnums_8h.html#a02ed901e93e9d5ffb22fc6a2f0284f3dac86fcbdd8a443ba2731a871a5daf31bc">ORIENTATION_DONT_CARE</a>)
<a name="l00494"></a>00494                         {
<a name="l00495"></a>00495                                 <span class="keywordflow">if</span> (<a class="code" href="RenderUtils_8cpp.html#a7079164b40bddba9a033641696ce8820">GetForcedOrientation</a>() == <a class="code" href="PlatformEnums_8h.html#a02ed901e93e9d5ffb22fc6a2f0284f3dacd00a965397a558275015a84f2f22dd5">ORIENTATION_PORTRAIT</a> || <a class="code" href="RenderUtils_8cpp.html#a7079164b40bddba9a033641696ce8820">GetForcedOrientation</a>() == <a class="code" href="PlatformEnums_8h.html#a02ed901e93e9d5ffb22fc6a2f0284f3dae06d63ec66f90a060ad29dc2987f991f">ORIENTATION_PORTRAIT_UPSIDE_DOWN</a> )
<a name="l00496"></a>00496                                 {
<a name="l00497"></a>00497                                         <span class="comment">//can&#39;t lock landscape, pretending we&#39;re portrait mode, hack for emulating screens that require we manually</span>
<a name="l00498"></a>00498                                         <span class="comment">//rotate (usually for speed on certain devices)</span>
<a name="l00499"></a>00499                                         <a class="code" href="RenderUtils_8cpp.html#adf9bef99a628dbdecbdec63b7695ff86">SetupScreenInfo</a>(<a class="code" href="AndroidUtils_8cpp.html#a2f0e58aac06a13b950cef03dcc3e7267">GetPrimaryGLX</a>(),<a class="code" href="AndroidUtils_8cpp.html#ac274a49195455502331eb617bce938e3">GetPrimaryGLY</a>(), <a class="code" href="PlatformEnums_8h.html#a02ed901e93e9d5ffb22fc6a2f0284f3daaf02c443f5209ec2e93a624b17d8ff62">ORIENTATION_LANDSCAPE_LEFT</a>);
<a name="l00500"></a>00500                                         <span class="keywordflow">return</span>;
<a name="l00501"></a>00501 
<a name="l00502"></a>00502                                 }
<a name="l00503"></a>00503                         }
<a name="l00504"></a>00504 
<a name="l00505"></a>00505                         <span class="comment">//flip &#39;er around</span>
<a name="l00506"></a>00506                         <a class="code" href="RenderUtils_8cpp.html#adf9bef99a628dbdecbdec63b7695ff86">SetupScreenInfo</a>(<a class="code" href="AndroidUtils_8cpp.html#ac274a49195455502331eb617bce938e3">GetPrimaryGLY</a>(),<a class="code" href="AndroidUtils_8cpp.html#a2f0e58aac06a13b950cef03dcc3e7267">GetPrimaryGLX</a>(), <a class="code" href="PlatformEnums_8h.html#a02ed901e93e9d5ffb22fc6a2f0284f3daaf02c443f5209ec2e93a624b17d8ff62">ORIENTATION_LANDSCAPE_LEFT</a>);
<a name="l00507"></a>00507                 }
<a name="l00508"></a>00508         }
<a name="l00509"></a>00509 }
<a name="l00510"></a>00510 
<a name="l00511"></a><a class="code" href="RenderUtils_8cpp.html#a0519bb797f1659eb1c5358b5275a8c6c">00511</a> <span class="keywordtype">bool</span> <a class="code" href="RenderUtils_8cpp.html#a0519bb797f1659eb1c5358b5275a8c6c">g_usingNativeUI</a> = <span class="keyword">false</span>;
<a name="l00512"></a><a class="code" href="RenderUtils_8cpp.html#ab3f6cb00134f6eec9c525b587c71f06f">00512</a> <a class="code" href="classEntity.html">Entity</a> *<a class="code" href="RenderUtils_8cpp.html#ab3f6cb00134f6eec9c525b587c71f06f">g_pGUIWithGUIFocus</a> = NULL;
<a name="l00513"></a>00513 
<a name="l00514"></a><a class="code" href="RenderUtils_8h.html#a9b659f82b574d9616f26bb3131b66e09">00514</a> <a class="code" href="classEntity.html">Entity</a> * <a class="code" href="RenderUtils_8cpp.html#a9b659f82b574d9616f26bb3131b66e09">GetEntityWithNativeUIFocus</a>()
<a name="l00515"></a>00515 {
<a name="l00516"></a>00516         <span class="keywordflow">return</span> <a class="code" href="RenderUtils_8cpp.html#ab3f6cb00134f6eec9c525b587c71f06f">g_pGUIWithGUIFocus</a>;
<a name="l00517"></a>00517 }
<a name="l00518"></a>00518 
<a name="l00519"></a><a class="code" href="RenderUtils_8h.html#a4c909ebe0154f8e0c2b4a8b0072776f8">00519</a> <span class="keywordtype">void</span> <a class="code" href="RenderUtils_8cpp.html#a7a53c6ee901e27e494c5dabd5545e0c8">SetEntityWithNativeUIFocus</a>(<a class="code" href="classEntity.html">Entity</a> *pEnt, <span class="keywordtype">bool</span> bSendLosingFocusMessage)
<a name="l00520"></a>00520 {
<a name="l00521"></a>00521         
<a name="l00522"></a>00522         <span class="keywordflow">if</span> (pEnt == g_pGUIWithGUIFocus) <span class="keywordflow">return</span>;
<a name="l00523"></a>00523 
<a name="l00524"></a>00524         <span class="keywordflow">if</span> (bSendLosingFocusMessage &amp;&amp; pEnt)
<a name="l00525"></a>00525         {
<a name="l00526"></a>00526                 <span class="keywordflow">if</span> (g_pGUIWithGUIFocus)
<a name="l00527"></a>00527                 {
<a name="l00528"></a>00528                         g_pGUIWithGUIFocus-&gt;<a class="code" href="classEntity.html#a217a6fab86840a45d94ce3694fe6b211">GetShared</a>()-&gt;<a class="code" href="classVariantDB.html#aba705e2ef34a5056b1ac00e0d7d57ff7">CallFunctionIfExists</a>(<span class="stringliteral">&quot;OnLosingNativeGUIFocus&quot;</span>, NULL);
<a name="l00529"></a>00529                 }
<a name="l00530"></a>00530         }
<a name="l00531"></a>00531         
<a name="l00532"></a>00532         g_pGUIWithGUIFocus = pEnt;
<a name="l00533"></a>00533 }
<a name="l00534"></a>00534 
<a name="l00535"></a><a class="code" href="RenderUtils_8h.html#aed0a0b710950a1a867d83377921b1235">00535</a> <span class="keywordtype">bool</span> <a class="code" href="RenderUtils_8cpp.html#aed0a0b710950a1a867d83377921b1235">GetIsUsingNativeUI</a>() {<span class="keywordflow">return</span> <a class="code" href="RenderUtils_8cpp.html#a0519bb797f1659eb1c5358b5275a8c6c">g_usingNativeUI</a>;}
<a name="l00536"></a>00536 
<a name="l00537"></a><a class="code" href="RenderUtils_8h.html#a51e15055160b774712bf5085fac88780">00537</a> <span class="keywordtype">void</span> <a class="code" href="RenderUtils_8cpp.html#a51e15055160b774712bf5085fac88780">SetIsUsingNativeUI</a>(<span class="keywordtype">bool</span> bNew) 
<a name="l00538"></a>00538 {
<a name="l00539"></a>00539         <span class="keywordflow">if</span> (bNew == <a class="code" href="RenderUtils_8cpp.html#a0519bb797f1659eb1c5358b5275a8c6c">g_usingNativeUI</a>) <span class="keywordflow">return</span>;
<a name="l00540"></a>00540         <a class="code" href="RenderUtils_8cpp.html#a0519bb797f1659eb1c5358b5275a8c6c">g_usingNativeUI</a> = bNew;
<a name="l00541"></a>00541 
<a name="l00542"></a>00542         <span class="comment">//broadcast it via a signal incase anybody cares</span>
<a name="l00543"></a>00543         <a class="code" href="classVariantList.html">VariantList</a> <a class="code" href="Renderer_2GL_2glext_8h.html#a4568fc090febc136eed4577a600739ca">v</a>((<a class="code" href="PlatformSetupAndroid_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a>)bNew);
<a name="l00544"></a>00544         <a class="code" href="BaseApp_8h.html#a72086b48d24daf0a65dd20189a16bd16">GetBaseApp</a>()-&gt;<a class="code" href="classBaseApp.html#a8299ca9006d9ef8140fe207916304ca8">m_sig_native_input_state_changed</a>(&amp;v);
<a name="l00545"></a>00545 }
<a name="l00546"></a>00546 
<a name="l00547"></a>00547 
<a name="l00548"></a><a class="code" href="RenderUtils_8h.html#aa06331387040fa5cd6610ba9064928e0">00548</a> <span class="keywordtype">bool</span> <a class="code" href="RenderUtils_8cpp.html#aa06331387040fa5cd6610ba9064928e0">CanRotateTo</a>(<span class="keywordtype">int</span> orientation)
<a name="l00549"></a>00549 {
<a name="l00550"></a>00550         <span class="keywordflow">if</span> (orientation ==  4 || orientation == 3)
<a name="l00551"></a>00551         {
<a name="l00552"></a>00552                 <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00553"></a>00553         }
<a name="l00554"></a>00554         <span class="keywordflow">if</span> (<a class="code" href="RenderUtils_8cpp.html#a7bd88908c4ef868e971e324ccaad6e56">GetLockedLandscape</a>()) <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00555"></a>00555 
<a name="l00556"></a>00556         <span class="keywordflow">return</span> <span class="keyword">true</span>;
<a name="l00557"></a>00557 }
<a name="l00558"></a>00558 
<a name="l00559"></a><a class="code" href="RenderUtils_8h.html#a9f156bb2da3f5efb5e25bbe0febdcd03">00559</a> <span class="keywordtype">bool</span> <a class="code" href="RenderUtils_8cpp.html#a9f156bb2da3f5efb5e25bbe0febdcd03">SetupScreenInfoIPhone</a>(<span class="keywordtype">int</span> interfaceOrientation)
<a name="l00560"></a>00560 {
<a name="l00561"></a>00561         
<a name="l00562"></a>00562         <span class="keywordflow">if</span> (<a class="code" href="RenderUtils_8cpp.html#a7079164b40bddba9a033641696ce8820">GetForcedOrientation</a>() != <a class="code" href="PlatformEnums_8h.html#a02ed901e93e9d5ffb22fc6a2f0284f3dac86fcbdd8a443ba2731a871a5daf31bc">ORIENTATION_DONT_CARE</a>)
<a name="l00563"></a>00563         {
<a name="l00564"></a>00564                 interfaceOrientation = <a class="code" href="RenderUtils_8cpp.html#a7079164b40bddba9a033641696ce8820">GetForcedOrientation</a>();
<a name="l00565"></a>00565         }
<a name="l00566"></a>00566         <span class="comment">//note, this is slightly different from our usual orientation (UIDeviceOrientation) so let&#39;s convert it first</span>
<a name="l00567"></a>00567         <span class="keywordtype">int</span> orientation = interfaceOrientation;
<a name="l00568"></a>00568         
<a name="l00569"></a>00569         <span class="keywordflow">if</span> (!<a class="code" href="RenderUtils_8cpp.html#aa06331387040fa5cd6610ba9064928e0">CanRotateTo</a>(orientation)) <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00570"></a>00570         
<a name="l00571"></a>00571         <a class="code" href="RenderUtils_8cpp.html#adf9bef99a628dbdecbdec63b7695ff86">SetupScreenInfo</a>(<a class="code" href="RenderUtils_8cpp.html#a8805ddbb21195169d1feae1768691b9f">g_screenSizeX</a>,<a class="code" href="RenderUtils_8cpp.html#a29018a8eafaae21025d9b09d39ef2740">g_screenSizeY</a>,orientation);       
<a name="l00572"></a>00572         
<a name="l00573"></a>00573         <span class="keywordflow">return</span> <span class="keyword">false</span>;
<a name="l00574"></a>00574 }
<a name="l00575"></a>00575 
<a name="l00576"></a><a class="code" href="RenderUtils_8h.html#adf9bef99a628dbdecbdec63b7695ff86">00576</a> <span class="keywordtype">void</span> <a class="code" href="RenderUtils_8cpp.html#adf9bef99a628dbdecbdec63b7695ff86">SetupScreenInfo</a>(<span class="keywordtype">int</span> <a class="code" href="flash_2GLES_2glext_8h.html#a0cdec8e97a75ee9458b23d152bf962d4">x</a>, <span class="keywordtype">int</span> <a class="code" href="flash_2GLES_2glext_8h.html#a2532a9f8ed3a10a63f5e3c484fbfdb9b">y</a>, <span class="keywordtype">int</span> orientation)
<a name="l00577"></a>00577 {
<a name="l00578"></a>00578         <span class="keywordflow">if</span> (<a class="code" href="RenderUtils_8cpp.html#a7079164b40bddba9a033641696ce8820">GetForcedOrientation</a>() != <a class="code" href="PlatformEnums_8h.html#a02ed901e93e9d5ffb22fc6a2f0284f3dac86fcbdd8a443ba2731a871a5daf31bc">ORIENTATION_DONT_CARE</a>)
<a name="l00579"></a>00579         {
<a name="l00580"></a>00580                 orientation = <a class="code" href="RenderUtils_8cpp.html#a7079164b40bddba9a033641696ce8820">GetForcedOrientation</a>();
<a name="l00581"></a>00581         }
<a name="l00582"></a>00582 
<a name="l00583"></a>00583         <a class="code" href="RenderUtils_8cpp.html#a96c0da463bd5670c07c40e3d2d276b07">SetupOriginalScreenSize</a>(<a class="code" href="AndroidUtils_8cpp.html#a2f0e58aac06a13b950cef03dcc3e7267">GetPrimaryGLX</a>(), <a class="code" href="AndroidUtils_8cpp.html#ac274a49195455502331eb617bce938e3">GetPrimaryGLY</a>());
<a name="l00584"></a>00584 
<a name="l00585"></a>00585 <span class="preprocessor">#ifdef _DEBUG</span>
<a name="l00586"></a>00586 <span class="preprocessor"></span>                <a class="code" href="AndroidUtils_8cpp.html#aaa5c9bf2289dec09f59ef2b7ba6c66ae">LogMsg</a>(<span class="stringliteral">&quot;Setting screen info to %d, %d, mode %d.  Original is %d, %d&quot;</span>, x, y, orientation, <a class="code" href="RenderUtils_8cpp.html#ae45d5b731d966b26bb3084d02a26f52f">GetOriginalScreenSizeX</a>(), <a class="code" href="RenderUtils_8cpp.html#a81abf98e820587f565885aed5afa787c">GetOriginalScreenSizeY</a>());
<a name="l00587"></a>00587 <span class="preprocessor">#endif</span>
<a name="l00588"></a>00588 <span class="preprocessor"></span>
<a name="l00589"></a>00589                 <a class="code" href="RenderUtils_8cpp.html#a8805ddbb21195169d1feae1768691b9f">g_screenSizeX</a> = <a class="code" href="flash_2GLES_2glext_8h.html#a0cdec8e97a75ee9458b23d152bf962d4">x</a>;
<a name="l00590"></a>00590                 <a class="code" href="RenderUtils_8cpp.html#a29018a8eafaae21025d9b09d39ef2740">g_screenSizeY</a> = <a class="code" href="flash_2GLES_2glext_8h.html#a2532a9f8ed3a10a63f5e3c484fbfdb9b">y</a>;
<a name="l00591"></a>00591                 <a class="code" href="RenderUtils_8cpp.html#a85cf675cfb52a2e9025dc3f49ba2d0fe">g_orientation</a> = orientation;
<a name="l00592"></a>00592         
<a name="l00593"></a>00593                 <span class="keywordflow">if</span> (<a class="code" href="RenderUtils_8cpp.html#a83c3f5c13f3df84f49039f43f7aaad3c">GetFakePrimaryScreenSizeX</a>())
<a name="l00594"></a>00594                 {
<a name="l00595"></a>00595                         <span class="comment">//recompute it using our fake information</span>
<a name="l00596"></a>00596                         x = <a class="code" href="RenderUtils_8cpp.html#a83c3f5c13f3df84f49039f43f7aaad3c">GetFakePrimaryScreenSizeX</a>();
<a name="l00597"></a>00597                         y = <a class="code" href="RenderUtils_8cpp.html#a5aa95ad79520615ad77c797f7adf8cf2">GetFakePrimaryScreenSizeY</a>();
<a name="l00598"></a>00598                 
<a name="l00599"></a>00599                         <a class="code" href="RenderUtils_8cpp.html#a8805ddbb21195169d1feae1768691b9f">g_screenSizeX</a> = <a class="code" href="flash_2GLES_2glext_8h.html#a0cdec8e97a75ee9458b23d152bf962d4">x</a>;
<a name="l00600"></a>00600                         <a class="code" href="RenderUtils_8cpp.html#a29018a8eafaae21025d9b09d39ef2740">g_screenSizeY</a> = <a class="code" href="flash_2GLES_2glext_8h.html#a2532a9f8ed3a10a63f5e3c484fbfdb9b">y</a>;
<a name="l00601"></a>00601 
<a name="l00602"></a>00602                 }
<a name="l00603"></a>00603 
<a name="l00604"></a>00604                 <a class="code" href="AndroidUtils_8cpp.html#ac465c34ba2c31698c800b10b345d0db5">NotifyOSOfOrientationPreference</a>(<a class="code" href="PlatformEnums_8h.html#a02ed901e93e9d5ffb22fc6a2f0284f3d">eOrientationMode</a>(orientation));
<a name="l00605"></a>00605                 <span class="keywordflow">if</span> (<a class="code" href="BaseApp_8cpp.html#aef043c38b21bf52ff43fbca27a6cadb0">IsBaseAppInitted</a>())
<a name="l00606"></a>00606                 {
<a name="l00607"></a>00607                         <a class="code" href="BaseApp_8h.html#a72086b48d24daf0a65dd20189a16bd16">GetBaseApp</a>()-&gt;<a class="code" href="classBaseApp.html#a35a9a8c9a69a37339d8cb84a108b2cd6">OnScreenSizeChange</a>();
<a name="l00608"></a>00608                 }
<a name="l00609"></a>00609 }
<a name="l00610"></a>00610 
<a name="l00611"></a><a class="code" href="RenderUtils_8h.html#aefb4995d0b8dcf2f2f19ba6994f7a7f7">00611</a> <span class="keywordtype">void</span> <a class="code" href="RenderUtils_8cpp.html#aefb4995d0b8dcf2f2f19ba6994f7a7f7">ConvertCoordinatesIfRequired</a>(<span class="keywordtype">int</span> &amp;xPos, <span class="keywordtype">int</span> &amp;yPos)
<a name="l00612"></a>00612 {
<a name="l00613"></a>00613         <span class="keywordtype">float</span> <a class="code" href="flash_2GLES_2glext_8h.html#a0cdec8e97a75ee9458b23d152bf962d4">x</a> = (float)xPos;
<a name="l00614"></a>00614         <span class="keywordtype">float</span> <a class="code" href="flash_2GLES_2glext_8h.html#a2532a9f8ed3a10a63f5e3c484fbfdb9b">y</a> = (float)yPos;
<a name="l00615"></a>00615         <a class="code" href="RenderUtils_8cpp.html#aefb4995d0b8dcf2f2f19ba6994f7a7f7">ConvertCoordinatesIfRequired</a>(x, y);
<a name="l00616"></a>00616         xPos = (int)x;
<a name="l00617"></a>00617         yPos = (int)y;
<a name="l00618"></a>00618 }
<a name="l00619"></a>00619 
<a name="l00620"></a><a class="code" href="RenderUtils_8h.html#ac3e8b139699f1930ef0e2ef6348471bf">00620</a> <span class="keywordtype">void</span> <a class="code" href="RenderUtils_8cpp.html#aefb4995d0b8dcf2f2f19ba6994f7a7f7">ConvertCoordinatesIfRequired</a>(<span class="keywordtype">float</span> &amp;xPos, <span class="keywordtype">float</span> &amp;yPos)
<a name="l00621"></a>00621 {
<a name="l00622"></a>00622 <span class="comment">//      LogMsg(&quot;Before converting, coords are %d, %d&quot;, int(xPos), int(yPos));   </span>
<a name="l00623"></a>00623 
<a name="l00624"></a>00624         xPos *= <a class="code" href="RenderUtils_8cpp.html#a3e7e066af80a6eba953b00912e268c42">GetProtonPixelScaleFactor</a>();
<a name="l00625"></a>00625         yPos *= <a class="code" href="RenderUtils_8cpp.html#a3e7e066af80a6eba953b00912e268c42">GetProtonPixelScaleFactor</a>();
<a name="l00626"></a>00626 
<a name="l00627"></a>00627         <span class="keywordflow">if</span> (<a class="code" href="BaseApp_8h.html#a72086b48d24daf0a65dd20189a16bd16">GetBaseApp</a>()-&gt;GetManualRotationMode())
<a name="l00628"></a>00628         {
<a name="l00629"></a>00629                 <span class="keywordflow">switch</span> (<a class="code" href="RenderUtils_8cpp.html#a23d7ec03c9dd69ce0af19858d1c4ff79">GetOrientation</a>())
<a name="l00630"></a>00630                 {
<a name="l00631"></a>00631 
<a name="l00632"></a>00632                 <span class="keywordflow">case</span> <a class="code" href="PlatformEnums_8h.html#a02ed901e93e9d5ffb22fc6a2f0284f3dacd00a965397a558275015a84f2f22dd5">ORIENTATION_PORTRAIT</a>:
<a name="l00633"></a>00633                         <span class="keywordflow">break</span>;
<a name="l00634"></a>00634 
<a name="l00635"></a>00635                 <span class="keywordflow">case</span> <a class="code" href="PlatformEnums_8h.html#a02ed901e93e9d5ffb22fc6a2f0284f3dae06d63ec66f90a060ad29dc2987f991f">ORIENTATION_PORTRAIT_UPSIDE_DOWN</a>:
<a name="l00636"></a>00636                         yPos = float(<a class="code" href="RenderUtils_8cpp.html#a81abf98e820587f565885aed5afa787c">GetOriginalScreenSizeY</a>())-yPos;
<a name="l00637"></a>00637                         xPos = float(<a class="code" href="RenderUtils_8cpp.html#ae45d5b731d966b26bb3084d02a26f52f">GetOriginalScreenSizeX</a>())-xPos;
<a name="l00638"></a>00638                         <span class="keywordflow">break</span>;
<a name="l00639"></a>00639 
<a name="l00640"></a>00640                 <span class="keywordflow">case</span> <a class="code" href="PlatformEnums_8h.html#a02ed901e93e9d5ffb22fc6a2f0284f3daaf02c443f5209ec2e93a624b17d8ff62">ORIENTATION_LANDSCAPE_LEFT</a>:
<a name="l00641"></a>00641                         swap(xPos, yPos);
<a name="l00642"></a>00642                         yPos = float(<a class="code" href="RenderUtils_8cpp.html#ae45d5b731d966b26bb3084d02a26f52f">GetOriginalScreenSizeX</a>())-yPos;
<a name="l00643"></a>00643                         <span class="keywordflow">break</span>;
<a name="l00644"></a>00644 
<a name="l00645"></a>00645                 <span class="keywordflow">case</span> <a class="code" href="PlatformEnums_8h.html#a02ed901e93e9d5ffb22fc6a2f0284f3dad7139ae64e316779a0190d875de24a5e">ORIENTATION_LANDSCAPE_RIGHT</a>:
<a name="l00646"></a>00646                         yPos = float(<a class="code" href="RenderUtils_8cpp.html#a81abf98e820587f565885aed5afa787c">GetOriginalScreenSizeY</a>())-yPos;
<a name="l00647"></a>00647                         swap(xPos, yPos);
<a name="l00648"></a>00648                         <span class="keywordflow">break</span>;
<a name="l00649"></a>00649 
<a name="l00650"></a>00650                 }
<a name="l00651"></a>00651         }
<a name="l00652"></a>00652         <span class="keywordflow">if</span> (<a class="code" href="RenderUtils_8cpp.html#a83c3f5c13f3df84f49039f43f7aaad3c">GetFakePrimaryScreenSizeX</a>() != 0)
<a name="l00653"></a>00653         {
<a name="l00654"></a>00654                 <span class="comment">//remap to correct values</span>
<a name="l00655"></a>00655                 <span class="comment">//LogMsg(&quot;CurY: %.2f - old y: %.2f&quot;,  GetScreenSizeYf(), float(GetOriginalScreenSizeY()));</span>
<a name="l00656"></a>00656                 <span class="comment">//LogMsg(&quot;CurX: %.2f - old x: %.2f&quot;,  GetScreenSizeXf(), float(GetOriginalScreenSizeX()) );</span>
<a name="l00657"></a>00657                 
<a name="l00658"></a>00658                 <span class="keywordtype">float</span> OriginalX = (float)<a class="code" href="RenderUtils_8cpp.html#ae45d5b731d966b26bb3084d02a26f52f">GetOriginalScreenSizeX</a>();
<a name="l00659"></a>00659                 <span class="keywordtype">float</span> OriginalY = (float)<a class="code" href="RenderUtils_8cpp.html#a81abf98e820587f565885aed5afa787c">GetOriginalScreenSizeY</a>();
<a name="l00660"></a>00660                 
<a name="l00661"></a>00661                 <span class="keywordflow">if</span> (<a class="code" href="BaseApp_8h.html#a72086b48d24daf0a65dd20189a16bd16">GetBaseApp</a>()-&gt;<a class="code" href="classBaseApp.html#afdba51e6f0f3b31990d7f15392a57ff5">GetManualRotationMode</a>())
<a name="l00662"></a>00662         {
<a name="l00663"></a>00663             <span class="keywordflow">if</span> (<a class="code" href="RenderUtils_8cpp.html#a034372040b8104c0b6536a2ed0dd46cc">InLandscapeGUIMode</a>())
<a name="l00664"></a>00664             {
<a name="l00665"></a>00665                 swap(OriginalX, OriginalY);
<a name="l00666"></a>00666             }
<a name="l00667"></a>00667         }
<a name="l00668"></a>00668                 
<a name="l00669"></a>00669                 xPos = (float(xPos) * (<a class="code" href="PlatformSetup_8cpp.html#a3b38aaa65dfcae39c0700887f36f1521" title="Returns the same as GetScreenSizeX() but as a float.">GetScreenSizeXf</a>()/OriginalX));
<a name="l00670"></a>00670                 yPos = (float(yPos) * (<a class="code" href="PlatformSetup_8cpp.html#a94a0deb0a111cc46d8f7285fd3f83838" title="Returns the same as GetScreenSizeY() but as a float.">GetScreenSizeYf</a>()/OriginalY));
<a name="l00671"></a>00671         }
<a name="l00672"></a>00672         
<a name="l00673"></a>00673 <span class="comment">//      LogMsg(&quot;Converted coords to %d, %d&quot;, int(xPos), int(yPos));</span>
<a name="l00674"></a>00674 }
<a name="l00675"></a>00675 
<a name="l00676"></a><a class="code" href="RenderUtils_8cpp.html#ae38312970017bf19fa9825d252038c81">00676</a> <span class="keywordtype">bool</span> <a class="code" href="RenderUtils_8cpp.html#ae38312970017bf19fa9825d252038c81">g_needsOrthoModeSet</a> = <span class="keyword">true</span>;
<a name="l00677"></a>00677 
<a name="l00678"></a><a class="code" href="RenderUtils_8h.html#adcf9eeda4c715bd581aaad4d71d35a97">00678</a> <span class="keywordtype">bool</span> <a class="code" href="RenderUtils_8cpp.html#adcf9eeda4c715bd581aaad4d71d35a97">NeedsOrthoSet</a>() 
<a name="l00679"></a>00679 {
<a name="l00680"></a>00680         <span class="keywordflow">return</span> <a class="code" href="RenderUtils_8cpp.html#ae38312970017bf19fa9825d252038c81">g_needsOrthoModeSet</a>;
<a name="l00681"></a>00681 }
<a name="l00682"></a>00682 
<a name="l00683"></a><a class="code" href="RenderUtils_8h.html#a79f1ff4acf23c5d2253de96999dc2f61">00683</a> <span class="keywordtype">void</span> <a class="code" href="RenderUtils_8cpp.html#a79f1ff4acf23c5d2253de96999dc2f61">ResetOrthoFlag</a>()
<a name="l00684"></a>00684 {
<a name="l00685"></a>00685         
<a name="l00686"></a>00686         <a class="code" href="RenderUtils_8cpp.html#ae38312970017bf19fa9825d252038c81">g_needsOrthoModeSet</a> = <span class="keyword">true</span>;
<a name="l00687"></a>00687 }
<a name="l00688"></a>00688 
<a name="l00689"></a><a class="code" href="RenderUtils_8h.html#a11aabb34b86114eca7586c18310e9028">00689</a> <span class="keywordtype">void</span> <a class="code" href="RenderUtils_8cpp.html#a11aabb34b86114eca7586c18310e9028">SetOrthoModeFlag</a>()
<a name="l00690"></a>00690 {
<a name="l00691"></a>00691         <a class="code" href="RenderUtils_8cpp.html#ae38312970017bf19fa9825d252038c81">g_needsOrthoModeSet</a> = <span class="keyword">false</span>;
<a name="l00692"></a>00692 }
<a name="l00693"></a>00693 
<a name="l00694"></a><a class="code" href="RenderUtils_8h.html#a034372040b8104c0b6536a2ed0dd46cc">00694</a> <span class="keywordtype">bool</span> <a class="code" href="RenderUtils_8cpp.html#a034372040b8104c0b6536a2ed0dd46cc">InLandscapeGUIMode</a>()
<a name="l00695"></a>00695 {
<a name="l00696"></a>00696         <span class="keywordflow">return</span> <a class="code" href="RenderUtils_8cpp.html#a23d7ec03c9dd69ce0af19858d1c4ff79">GetOrientation</a>() == 3 || <a class="code" href="RenderUtils_8cpp.html#a23d7ec03c9dd69ce0af19858d1c4ff79">GetOrientation</a>() == 4;
<a name="l00697"></a>00697 }
<a name="l00698"></a>00698 
<a name="l00699"></a>00699 <span class="comment">//returns a range of -1 to 1 with the cycle matching the MS sent in, based on a sin wave</span>
<a name="l00700"></a><a class="code" href="RenderUtils_8h.html#a16da0d063d5f1b04ea0787849ff48fe8">00700</a> <span class="keywordtype">float</span> <a class="code" href="RenderUtils_8cpp.html#a16da0d063d5f1b04ea0787849ff48fe8">SinPulseByMS</a>(<span class="keywordtype">int</span> ms)
<a name="l00701"></a>00701 {
<a name="l00702"></a>00702         <span class="keywordtype">int</span> tick = <a class="code" href="BaseApp_8h.html#a72086b48d24daf0a65dd20189a16bd16">GetBaseApp</a>()-&gt;<a class="code" href="classBaseApp.html#a26200ecd79b553644c596611504994b9">GetTick</a>()%ms;
<a name="l00703"></a>00703         <span class="keywordflow">return</span> (<span class="keywordtype">float</span>)(sin (   (<span class="keywordtype">float</span>(tick)/<span class="keywordtype">float</span>(ms))  *M_PI*2   ));
<a name="l00704"></a>00704 }
<a name="l00705"></a>00705 
<a name="l00706"></a><a class="code" href="RenderUtils_8h.html#acce9ea70526f6c1eb4c61fe7cdfe3f1c">00706</a> <span class="keywordtype">float</span> <a class="code" href="RenderUtils_8cpp.html#acce9ea70526f6c1eb4c61fe7cdfe3f1c">SinPulseByCustomTimerMS</a>(<span class="keywordtype">int</span> ms, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> timerMS)
<a name="l00707"></a>00707 {
<a name="l00708"></a>00708         <span class="keywordtype">int</span> tick = timerMS%ms;
<a name="l00709"></a>00709         <span class="keywordflow">return</span> (<span class="keywordtype">float</span>)(sin (   (<span class="keywordtype">float</span>(tick)/<span class="keywordtype">float</span>(ms))  *M_PI*2   ));
<a name="l00710"></a>00710 }
<a name="l00711"></a>00711 
<a name="l00712"></a><a class="code" href="RenderUtils_8h.html#a251338ca8ff6e5fde9517308189d866b">00712</a> <span class="keywordtype">float</span> <a class="code" href="RenderUtils_8cpp.html#a251338ca8ff6e5fde9517308189d866b">SinGamePulseByMS</a>(<span class="keywordtype">int</span> ms)
<a name="l00713"></a>00713 {
<a name="l00714"></a>00714         <span class="keywordtype">int</span> tick = <a class="code" href="BaseApp_8h.html#a72086b48d24daf0a65dd20189a16bd16">GetBaseApp</a>()-&gt;<a class="code" href="classBaseApp.html#ab1b4cc3dc94e3dfd16b8fbb21823fbcd">GetGameTick</a>()%ms;
<a name="l00715"></a>00715         <span class="keywordflow">return</span> (<span class="keywordtype">float</span>)(sin (   (<span class="keywordtype">float</span>(tick)/<span class="keywordtype">float</span>(ms))  *M_PI*2   ));
<a name="l00716"></a>00716 }
<a name="l00717"></a>00717 
<a name="l00718"></a>00718 <span class="comment">//a helper to use with the above functions when you just want 0-1 range</span>
<a name="l00719"></a><a class="code" href="RenderUtils_8h.html#a2c65f0b4cba1af8dc9e9f203819162dc">00719</a> <span class="keywordtype">float</span> <a class="code" href="RenderUtils_8cpp.html#a2c65f0b4cba1af8dc9e9f203819162dc">SinToZeroToOneRange</a>(<span class="keywordtype">float</span> sinIn)
<a name="l00720"></a>00720 {
<a name="l00721"></a>00721         <span class="keywordflow">return</span> (sinIn+1.0<a class="code" href="Renderer_2GL_2glext_8h.html#aba8ad56949f59242bc167b073dae3715">f</a>)/2;
<a name="l00722"></a>00722 }
<a name="l00723"></a>00723 
<a name="l00724"></a>00724 <span class="comment">//just makes a random brightish color</span>
<a name="l00725"></a><a class="code" href="RenderUtils_8h.html#a22586a4d116d66b8e33db69f9d95d62d">00725</a> <a class="code" href="PlatformSetupAndroid_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a> <a class="code" href="RenderUtils_8cpp.html#a22586a4d116d66b8e33db69f9d95d62d">GetBrightColor</a>()
<a name="l00726"></a>00726 {
<a name="l00727"></a>00727         <span class="keywordtype">int</span> <a class="code" href="Renderer_2GL_2glext_8h.html#a3ea846f998d64f079b86052b6c4193a8">color</a>[3];
<a name="l00728"></a>00728 
<a name="l00729"></a>00729         <span class="keywordtype">int</span> <a class="code" href="Renderer_2GL_2glext_8h.html#ab63d454b0ac4842ab53ff3ca9926436c">num</a> = <a class="code" href="MiscUtils_8cpp.html#a3029ced890b5dcf50698bedaa24d107c" title="Returns a random number limited by range.">Random</a>(2);
<a name="l00730"></a>00730 
<a name="l00731"></a>00731         <span class="keywordflow">if</span> (<a class="code" href="MiscUtils_8cpp.html#a3029ced890b5dcf50698bedaa24d107c" title="Returns a random number limited by range.">Random</a>(3))
<a name="l00732"></a>00732         {
<a name="l00733"></a>00733                 color[num%3] = <a class="code" href="MiscUtils_8cpp.html#a3029ced890b5dcf50698bedaa24d107c" title="Returns a random number limited by range.">Random</a>(80)+ (255-80); 
<a name="l00734"></a>00734 
<a name="l00735"></a>00735         } <span class="keywordflow">else</span>
<a name="l00736"></a>00736         {
<a name="l00737"></a>00737                 color[num%3] = <a class="code" href="MiscUtils_8cpp.html#a3029ced890b5dcf50698bedaa24d107c" title="Returns a random number limited by range.">Random</a>(150)+ (255-150); 
<a name="l00738"></a>00738 
<a name="l00739"></a>00739         }
<a name="l00740"></a>00740         color[(num+1)%3] = rt_min(255, <a class="code" href="MiscUtils_8cpp.html#a3029ced890b5dcf50698bedaa24d107c" title="Returns a random number limited by range.">Random</a>(355 - (color[num%3])));
<a name="l00741"></a>00741         color[(num+2)%3] =  rt_min(255,<a class="code" href="MiscUtils_8cpp.html#a3029ced890b5dcf50698bedaa24d107c" title="Returns a random number limited by range.">Random</a>(455 - (color[num%3] +color[(num+1)%3] )));
<a name="l00742"></a>00742         <span class="keywordflow">return</span> MAKE_RGBA(color[0], color[1], color[2], 255);
<a name="l00743"></a>00743 }
<a name="l00744"></a>00744 
<a name="l00745"></a>00745 <span class="comment">//mix between c1 and c2 based on progress, which should be 0 to 1</span>
<a name="l00746"></a><a class="code" href="RenderUtils_8h.html#a9d16bf7dc90b56e64b040a1754ba935c">00746</a> <a class="code" href="PlatformSetupAndroid_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a> <a class="code" href="RenderUtils_8cpp.html#a9d16bf7dc90b56e64b040a1754ba935c">ColorCombineMix</a>(<a class="code" href="PlatformSetupAndroid_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a> c1, <a class="code" href="PlatformSetupAndroid_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a> c2, <span class="keywordtype">float</span> progress)
<a name="l00747"></a>00747 {
<a name="l00748"></a>00748         <span class="keywordtype">int</span> <a class="code" href="flash_2GLES_2glext_8h.html#abe08814c2f72843fde4d8df41440d5a0">r</a>,<a class="code" href="Renderer_2GL_2glext_8h.html#a9cd653b1648845554169fbc3a3f6d37a">g</a>,<a class="code" href="Renderer_2GL_2glext_8h.html#a6eba317e3cf44d6d26c04a5a8f197dcb">b</a>,<a class="code" href="Renderer_2GL_2glext_8h.html#ac8729153468b5dcf13f971b21d84d4e5">a</a>;
<a name="l00749"></a>00749 
<a name="l00750"></a>00750         <span class="comment">//OPTIMIZE oh come on, optimize this - Seth</span>
<a name="l00751"></a>00751 
<a name="l00752"></a>00752         r = int (<span class="keywordtype">float</span>(GET_RED(c1)) + ((  <span class="keywordtype">float</span>(GET_RED(c2)) - <span class="keywordtype">float</span>(GET_RED(c1))  ) * progress));
<a name="l00753"></a>00753         g = int (<span class="keywordtype">float</span>(GET_GREEN(c1)) + ((  <span class="keywordtype">float</span>(GET_GREEN(c2)) - <span class="keywordtype">float</span>(GET_GREEN(c1))  ) * progress));
<a name="l00754"></a>00754         b = int (<span class="keywordtype">float</span>(GET_BLUE(c1)) + ((  <span class="keywordtype">float</span>(GET_BLUE(c2)) - <span class="keywordtype">float</span>(GET_BLUE(c1))  ) * progress));
<a name="l00755"></a>00755         a = int (<span class="keywordtype">float</span>(GET_ALPHA(c1)) + ((  <span class="keywordtype">float</span>(GET_ALPHA(c2)) - <span class="keywordtype">float</span>(GET_ALPHA(c1))  ) * progress));
<a name="l00756"></a>00756 
<a name="l00757"></a>00757 
<a name="l00758"></a>00758         <span class="comment">//LogMsg(PrintColor(MAKE_RGBA(r,g,b,a)).c_str());</span>
<a name="l00759"></a>00759         <span class="keywordflow">return</span> MAKE_RGBA(r,g,b,a);
<a name="l00760"></a>00760 }
<a name="l00761"></a>00761 
<a name="l00762"></a><a class="code" href="RenderUtils_8h.html#ab9368d9ebb16155de16a276b5fd0ead1">00762</a> <a class="code" href="PlatformSetupAndroid_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a> <a class="code" href="RenderUtils_8cpp.html#a444dc2512a095df169e9c7b1aa49648b" title="Performs a &quot;linear burn&quot; operation for the colors c1 and c2.">ColorCombine</a>(<a class="code" href="PlatformSetupAndroid_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a> c1, <a class="code" href="PlatformSetupAndroid_8h.html#acbd4acd0d29e2d6c43104827f77d9cd2">uint32</a> c2, <span class="keywordtype">float</span> alphaMod)
<a name="l00763"></a>00763 {
<a name="l00764"></a>00764         <span class="keywordtype">int</span> <a class="code" href="flash_2GLES_2glext_8h.html#abe08814c2f72843fde4d8df41440d5a0">r</a>,<a class="code" href="Renderer_2GL_2glext_8h.html#a9cd653b1648845554169fbc3a3f6d37a">g</a>,<a class="code" href="Renderer_2GL_2glext_8h.html#a6eba317e3cf44d6d26c04a5a8f197dcb">b</a>,<a class="code" href="Renderer_2GL_2glext_8h.html#ac8729153468b5dcf13f971b21d84d4e5">a</a>;
<a name="l00765"></a>00765 
<a name="l00766"></a>00766         <span class="keywordflow">if</span> (c2 != MAKE_RGBA(255,255,255,255))
<a name="l00767"></a>00767         {
<a name="l00768"></a>00768                 r = GET_RED(c1) - (255- GET_RED(c2));
<a name="l00769"></a>00769                 g = GET_GREEN(c1) - (255-  GET_GREEN(c2));
<a name="l00770"></a>00770                 b = GET_BLUE(c1) - (255-  GET_BLUE(c2));
<a name="l00771"></a>00771                 a = GET_ALPHA(c1) - (255-  GET_ALPHA(c2));
<a name="l00772"></a>00772 
<a name="l00773"></a>00773                 r = rt_max(0, r); r = rt_min(255,r);
<a name="l00774"></a>00774                 g = rt_max(0, g); g = rt_min(255,g);
<a name="l00775"></a>00775                 b = rt_max(0, b); b = rt_min(255,b);
<a name="l00776"></a>00776                 a = rt_max(0, a); a = rt_min(255,a);
<a name="l00777"></a>00777         } <span class="keywordflow">else</span>
<a name="l00778"></a>00778         {
<a name="l00779"></a>00779                 <span class="keywordflow">if</span> (alphaMod == 1) <span class="keywordflow">return</span> c1;
<a name="l00780"></a>00780                 r = GET_RED(c1);
<a name="l00781"></a>00781                 g = GET_GREEN(c1);
<a name="l00782"></a>00782                 b = GET_BLUE(c1); 
<a name="l00783"></a>00783                 a = GET_ALPHA(c1);
<a name="l00784"></a>00784         }
<a name="l00785"></a>00785 
<a name="l00786"></a>00786         <span class="comment">//LogMsg(&quot;%s and %s make %s&quot;, PrintColor(c1).c_str(), PrintColor(c2).c_str(), PrintColor(MAKE_RGBA(r,g,b, byte(float(a)*alphaMod))).c_str());</span>
<a name="l00787"></a>00787         <span class="keywordflow">return</span> MAKE_RGBA(r,g,b, <a class="code" href="PlatformSetupAndroid_8h.html#ab8ef12fab634c171394422d0ee8baf94">byte</a>(<span class="keywordtype">float</span>(a)*alphaMod)) ;
<a name="l00788"></a>00788 }
<a name="l00789"></a>00789 
<a name="l00790"></a><a class="code" href="RenderUtils_8h.html#a033cbb0846c14539a5c235ab6fef3887">00790</a> <span class="keywordtype">void</span>  <a class="code" href="RenderUtils_8cpp.html#a033cbb0846c14539a5c235ab6fef3887">ScreenToWorld</a>(CL_Vec2f pt, CL_Vec3f *pReturnA, <span class="keywordtype">float</span> dist)
<a name="l00791"></a>00791 {
<a name="l00792"></a>00792         <span class="keywordtype">float</span> aspect = <a class="code" href="PlatformSetup_8cpp.html#a94a0deb0a111cc46d8f7285fd3f83838" title="Returns the same as GetScreenSizeY() but as a float.">GetScreenSizeYf</a>()/<a class="code" href="PlatformSetup_8cpp.html#a3b38aaa65dfcae39c0700887f36f1521" title="Returns the same as GetScreenSizeX() but as a float.">GetScreenSizeXf</a>();
<a name="l00793"></a>00793 
<a name="l00794"></a>00794         <span class="keyword">const</span> <span class="keywordtype">float</span> tanffov =  tanf((<span class="keywordtype">float</span>(C_APP_FOV) * M_PI) / 360.0<a class="code" href="Renderer_2GL_2glext_8h.html#aba8ad56949f59242bc167b073dae3715">f</a>);
<a name="l00795"></a>00795 
<a name="l00796"></a>00796         <span class="keywordtype">float</span> <a class="code" href="flash_2GLES_2glext_8h.html#a0cdec8e97a75ee9458b23d152bf962d4">x</a> =  pt.x / (<a class="code" href="PlatformSetup_8cpp.html#a3b38aaa65dfcae39c0700887f36f1521" title="Returns the same as GetScreenSizeX() but as a float.">GetScreenSizeXf</a>()/2)-1.0<a class="code" href="Renderer_2GL_2glext_8h.html#aba8ad56949f59242bc167b073dae3715">f</a>;
<a name="l00797"></a>00797         <span class="keywordtype">float</span> <a class="code" href="flash_2GLES_2glext_8h.html#a2532a9f8ed3a10a63f5e3c484fbfdb9b">y</a> = 1.0f- (pt.y / (<a class="code" href="PlatformSetup_8cpp.html#a94a0deb0a111cc46d8f7285fd3f83838" title="Returns the same as GetScreenSizeY() but as a float.">GetScreenSizeYf</a>()/2));
<a name="l00798"></a>00798 
<a name="l00799"></a>00799         x = tanffov * (<a class="code" href="flash_2GLES_2glext_8h.html#a0cdec8e97a75ee9458b23d152bf962d4">x</a>) / aspect;
<a name="l00800"></a>00800         y =  tanffov * <a class="code" href="flash_2GLES_2glext_8h.html#a2532a9f8ed3a10a63f5e3c484fbfdb9b">y</a>;
<a name="l00801"></a>00801 
<a name="l00802"></a>00802         CL_Mat4f mat16, projMat16;
<a name="l00803"></a>00803         <a class="code" href="GLFlashAdaptor_8cpp.html#a7dc0777ecea8b90ee903bdc1852f2915">glGetFloatv</a>(GL_MODELVIEW_MATRIX, mat16);
<a name="l00804"></a>00804         <a class="code" href="GLFlashAdaptor_8cpp.html#a7dc0777ecea8b90ee903bdc1852f2915">glGetFloatv</a>(GL_PROJECTION_MATRIX, projMat16);
<a name="l00805"></a>00805 
<a name="l00806"></a>00806         mat16.inverse();
<a name="l00807"></a>00807         
<a name="l00808"></a>00808         projMat16.inverse();
<a name="l00809"></a>00809 
<a name="l00810"></a>00810         *pReturnA = CL_Vec3f(x,y,dist);
<a name="l00811"></a>00811         
<a name="l00812"></a>00812         CL_Vec4f vTemp4 = CL_Vec4f(    pReturnA-&gt;x,    pReturnA-&gt;y,  pReturnA-&gt;z, 1)*mat16;
<a name="l00813"></a>00813         vTemp4 = vTemp4*projMat16;
<a name="l00814"></a>00814 
<a name="l00815"></a>00815         *pReturnA = CL_Vec3f(  vTemp4.x,  vTemp4.y, vTemp4.z);
<a name="l00816"></a>00816 }
<a name="l00817"></a>00817 
<a name="l00818"></a><a class="code" href="RenderUtils_8h.html#af719ccd50003b061f5eb01621c629cfa">00818</a> CL_Vec3f <a class="code" href="RenderUtils_8cpp.html#a259e2b7dffccf6d4752bbd12460736f6">GetOGLPos</a>(<span class="keywordtype">int</span> <a class="code" href="flash_2GLES_2glext_8h.html#a0cdec8e97a75ee9458b23d152bf962d4">x</a>, <span class="keywordtype">int</span> <a class="code" href="flash_2GLES_2glext_8h.html#a2532a9f8ed3a10a63f5e3c484fbfdb9b">y</a>, <span class="keywordtype">float</span> <a class="code" href="flash_2GLES_2glext_8h.html#afbd8e4152e83f10b9242ae1e7a71cb0b">z</a>, CL_Vec3f *pNormalOut, CL_Mat4f *pModelMatrix, CL_Mat4f *pModelProjectionMatrix)
<a name="l00819"></a>00819 {
<a name="l00820"></a>00820                 
<a name="l00821"></a>00821         <span class="comment">//this xmod/ymod handles some things we do with auto screen stretching if &quot;fake screensize&quot; is used</span>
<a name="l00822"></a>00822 
<a name="l00823"></a>00823         <span class="keywordtype">float</span> xmod = (float(<a class="code" href="RenderUtils_8cpp.html#ae45d5b731d966b26bb3084d02a26f52f">GetOriginalScreenSizeX</a>())/<a class="code" href="PlatformSetup_8cpp.html#a3b38aaa65dfcae39c0700887f36f1521" title="Returns the same as GetScreenSizeX() but as a float.">GetScreenSizeXf</a>());
<a name="l00824"></a>00824         <span class="keywordtype">float</span> ymod = (float(<a class="code" href="RenderUtils_8cpp.html#a81abf98e820587f565885aed5afa787c">GetOriginalScreenSizeY</a>())/<a class="code" href="PlatformSetup_8cpp.html#a94a0deb0a111cc46d8f7285fd3f83838" title="Returns the same as GetScreenSizeY() but as a float.">GetScreenSizeYf</a>());
<a name="l00825"></a>00825 
<a name="l00826"></a>00826         <span class="keywordflow">if</span> (<a class="code" href="BaseApp_8h.html#a72086b48d24daf0a65dd20189a16bd16">GetBaseApp</a>()-&gt;<a class="code" href="classBaseApp.html#afdba51e6f0f3b31990d7f15392a57ff5">GetManualRotationMode</a>())
<a name="l00827"></a>00827         {
<a name="l00828"></a>00828                 
<a name="l00829"></a>00829                 <span class="keywordflow">switch</span> (<a class="code" href="RenderUtils_8cpp.html#a23d7ec03c9dd69ce0af19858d1c4ff79">GetOrientation</a>())
<a name="l00830"></a>00830                 {
<a name="l00831"></a>00831                 <span class="keywordflow">case</span> <a class="code" href="PlatformEnums_8h.html#a02ed901e93e9d5ffb22fc6a2f0284f3daaf02c443f5209ec2e93a624b17d8ff62">ORIENTATION_LANDSCAPE_LEFT</a>:
<a name="l00832"></a>00832                         y = <a class="code" href="PlatformSetup_8cpp.html#a36f6d11d4206b53c2b078e68c07bbf72" title="Returns the current height of the scene viewport.">GetScreenSizeY</a>()-<a class="code" href="flash_2GLES_2glext_8h.html#a2532a9f8ed3a10a63f5e3c484fbfdb9b">y</a>;
<a name="l00833"></a>00833                         swap(x,y);
<a name="l00834"></a>00834                         swap(xmod,ymod);
<a name="l00835"></a>00835                         <span class="keywordflow">break</span>;
<a name="l00836"></a>00836 
<a name="l00837"></a>00837                 <span class="keywordflow">case</span> <a class="code" href="PlatformEnums_8h.html#a02ed901e93e9d5ffb22fc6a2f0284f3dad7139ae64e316779a0190d875de24a5e">ORIENTATION_LANDSCAPE_RIGHT</a>:
<a name="l00838"></a>00838                         x = <a class="code" href="PlatformSetup_8cpp.html#a777ab76cf51e23c407a3b4af05864224" title="Returns the current width of the scene viewport.">GetScreenSizeX</a>()-<a class="code" href="flash_2GLES_2glext_8h.html#a0cdec8e97a75ee9458b23d152bf962d4">x</a>;
<a name="l00839"></a>00839                         swap(x,y);
<a name="l00840"></a>00840                         swap(xmod,ymod);
<a name="l00841"></a>00841                         <span class="keywordflow">break</span>;
<a name="l00842"></a>00842 
<a name="l00843"></a>00843                 <span class="keywordflow">case</span> <a class="code" href="PlatformEnums_8h.html#a02ed901e93e9d5ffb22fc6a2f0284f3dacd00a965397a558275015a84f2f22dd5">ORIENTATION_PORTRAIT</a>:
<a name="l00844"></a>00844                         <span class="keywordflow">break</span>;
<a name="l00845"></a>00845 
<a name="l00846"></a>00846                 <span class="keywordflow">case</span> <a class="code" href="PlatformEnums_8h.html#a02ed901e93e9d5ffb22fc6a2f0284f3dae06d63ec66f90a060ad29dc2987f991f">ORIENTATION_PORTRAIT_UPSIDE_DOWN</a>:
<a name="l00847"></a>00847                         y = <a class="code" href="PlatformSetup_8cpp.html#a36f6d11d4206b53c2b078e68c07bbf72" title="Returns the current height of the scene viewport.">GetScreenSizeY</a>()-<a class="code" href="flash_2GLES_2glext_8h.html#a2532a9f8ed3a10a63f5e3c484fbfdb9b">y</a>;
<a name="l00848"></a>00848                         x = <a class="code" href="PlatformSetup_8cpp.html#a777ab76cf51e23c407a3b4af05864224" title="Returns the current width of the scene viewport.">GetScreenSizeX</a>()-<a class="code" href="flash_2GLES_2glext_8h.html#a0cdec8e97a75ee9458b23d152bf962d4">x</a>;
<a name="l00849"></a>00849                         <span class="keywordflow">break</span>;
<a name="l00850"></a>00850                 }
<a name="l00851"></a>00851         }
<a name="l00852"></a>00852         
<a name="l00853"></a>00853         <span class="comment">//convert back into real screen coordinates if needed</span>
<a name="l00854"></a>00854 
<a name="l00855"></a>00855         <span class="keywordflow">if</span> (<a class="code" href="RenderUtils_8cpp.html#a83c3f5c13f3df84f49039f43f7aaad3c">GetFakePrimaryScreenSizeX</a>() != 0)
<a name="l00856"></a>00856         {
<a name="l00857"></a>00857                 <span class="comment">//remap to correct values</span>
<a name="l00858"></a>00858                 x = (int) (<span class="keywordtype">float</span>(x) * xmod);
<a name="l00859"></a>00859                 y = (int) (<span class="keywordtype">float</span>(y) * ymod);
<a name="l00860"></a>00860 
<a name="l00861"></a>00861                 <span class="keywordflow">switch</span> (<a class="code" href="RenderUtils_8cpp.html#a23d7ec03c9dd69ce0af19858d1c4ff79">GetOrientation</a>())
<a name="l00862"></a>00862                 {
<a name="l00863"></a>00863                 <span class="keywordflow">case</span> <a class="code" href="PlatformEnums_8h.html#a02ed901e93e9d5ffb22fc6a2f0284f3daaf02c443f5209ec2e93a624b17d8ff62">ORIENTATION_LANDSCAPE_LEFT</a>:
<a name="l00864"></a>00864                 <span class="keywordflow">case</span> <a class="code" href="PlatformEnums_8h.html#a02ed901e93e9d5ffb22fc6a2f0284f3dad7139ae64e316779a0190d875de24a5e">ORIENTATION_LANDSCAPE_RIGHT</a>:
<a name="l00865"></a>00865                         <span class="comment">//I have no idea what I&#39;m doing but this fixes a problem with fake scaling and rotation</span>
<a name="l00866"></a>00866                         swap(x,y);
<a name="l00867"></a>00867                         <span class="keywordflow">break</span>;
<a name="l00868"></a>00868                 }
<a name="l00869"></a>00869 
<a name="l00870"></a>00870         }
<a name="l00871"></a>00871 
<a name="l00872"></a>00872         <a class="code" href="flash_2GLES_2gl_8h.html#acebcc1c5663f14ebde1d16831e5fed94">GLint</a> viewport[4];
<a name="l00873"></a>00873         <a class="code" href="flash_2GLES_2gl_8h.html#a836cf6377099e88abf24c255b5b0ac52">GLfloat</a> modelview[16];
<a name="l00874"></a>00874         <a class="code" href="flash_2GLES_2gl_8h.html#a836cf6377099e88abf24c255b5b0ac52">GLfloat</a> projection[16];
<a name="l00875"></a>00875         <a class="code" href="flash_2GLES_2gl_8h.html#a836cf6377099e88abf24c255b5b0ac52">GLfloat</a> winX, winY;
<a name="l00876"></a>00876         <a class="code" href="flash_2GLES_2gl_8h.html#a836cf6377099e88abf24c255b5b0ac52">GLfloat</a> posX, posY, posZ;
<a name="l00877"></a>00877 
<a name="l00878"></a>00878         *((CL_Mat4f*)modelview) = *pModelMatrix;
<a name="l00879"></a>00879         
<a name="l00880"></a>00880         <span class="keywordflow">if</span> (pModelProjectionMatrix)
<a name="l00881"></a>00881         {
<a name="l00882"></a>00882                 *((CL_Mat4f*)projection) = *pModelProjectionMatrix;
<a name="l00883"></a>00883         } <span class="keywordflow">else</span>
<a name="l00884"></a>00884         {
<a name="l00885"></a>00885                 *((CL_Mat4f*)projection) = *<a class="code" href="BaseApp_8h.html#a72086b48d24daf0a65dd20189a16bd16">GetBaseApp</a>()-&gt;<a class="code" href="classBaseApp.html#a4b42d197e4bedda46a3230dc4e1a4a98">GetProjectionMatrix</a>();
<a name="l00886"></a>00886         }
<a name="l00887"></a>00887         <span class="comment">//glGetFloatv( GL_PROJECTION_MATRIX, projection );</span>
<a name="l00888"></a>00888         
<a name="l00889"></a>00889         
<a name="l00890"></a>00890         viewport[0] = 0;
<a name="l00891"></a>00891         viewport[1] = 0;
<a name="l00892"></a>00892         viewport[2] = <a class="code" href="AndroidUtils_8cpp.html#a2f0e58aac06a13b950cef03dcc3e7267">GetPrimaryGLX</a>();
<a name="l00893"></a>00893         viewport[3] = <a class="code" href="AndroidUtils_8cpp.html#ac274a49195455502331eb617bce938e3">GetPrimaryGLY</a>();
<a name="l00894"></a>00894         <span class="comment">//glGetIntegerv( GL_VIEWPORT, viewport ); //doesn&#39;t work on android</span>
<a name="l00895"></a>00895 
<a name="l00896"></a>00896         <span class="comment">//Read the window z co-ordinate </span>
<a name="l00897"></a>00897         <span class="comment">//(the z value on that point in unit cube)              </span>
<a name="l00898"></a>00898         
<a name="l00899"></a>00899         CL_Vec3f <a class="code" href="Renderer_2GL_2glext_8h.html#ac8729153468b5dcf13f971b21d84d4e5">a</a>,<a class="code" href="Renderer_2GL_2glext_8h.html#a6eba317e3cf44d6d26c04a5a8f197dcb">b</a>;
<a name="l00900"></a>00900         winX = (float)x;
<a name="l00901"></a>00901         winY = (float)viewport[3] - (<span class="keywordtype">float</span>)<a class="code" href="flash_2GLES_2glext_8h.html#a2532a9f8ed3a10a63f5e3c484fbfdb9b">y</a>;
<a name="l00902"></a>00902         <a class="code" href="GLESUtils_8cpp.html#aef0980daf29dfe0e66a46ebb11984542">gluUnProject</a>( winX, winY, 0, modelview, projection, viewport, &amp;posX, &amp;posY, &amp;posZ);
<a name="l00903"></a>00903         a = CL_Vec3f(posX, posY, posZ);
<a name="l00904"></a>00904 
<a name="l00905"></a>00905         <a class="code" href="GLESUtils_8cpp.html#aef0980daf29dfe0e66a46ebb11984542">gluUnProject</a>( winX, winY, 1, modelview, projection, viewport, &amp;posX, &amp;posY, &amp;posZ);
<a name="l00906"></a>00906         b = CL_Vec3f(posX, posY, posZ);
<a name="l00907"></a>00907 
<a name="l00908"></a>00908         CL_Vec3f <a class="code" href="Renderer_2GL_2glext_8h.html#a0788d3762d0c3c76e4c094d8078b4c27">n</a> = b-<a class="code" href="Renderer_2GL_2glext_8h.html#ac8729153468b5dcf13f971b21d84d4e5">a</a>;
<a name="l00909"></a>00909         n.normalize();
<a name="l00910"></a>00910         <span class="keywordflow">if</span> (pNormalOut)
<a name="l00911"></a>00911         {
<a name="l00912"></a>00912                 *pNormalOut = <a class="code" href="Renderer_2GL_2glext_8h.html#a0788d3762d0c3c76e4c094d8078b4c27">n</a>;
<a name="l00913"></a>00913         }
<a name="l00914"></a>00914         <span class="keywordflow">return</span> a + (n* <a class="code" href="flash_2GLES_2glext_8h.html#afbd8e4152e83f10b9242ae1e7a71cb0b">z</a>);
<a name="l00915"></a>00915 }
<a name="l00916"></a>00916 
<a name="l00917"></a>00917 
<a name="l00918"></a>00918 <span class="comment">//I see I&#39;m truncating the floats to ints here, but I can&#39;t remember if I had a decent reason.  Oh well, this stuff</span>
<a name="l00919"></a>00919 <span class="comment">//is rather old don&#39;t use it</span>
<a name="l00920"></a>00920 
<a name="l00921"></a><a class="code" href="RenderUtils_8h.html#a3e07eae4d7b94c924ff0ff3ae9043f89">00921</a> <span class="keywordtype">float</span> <a class="code" href="RenderUtils_8cpp.html#a3e07eae4d7b94c924ff0ff3ae9043f89">iPhoneMapY</a>( <span class="keywordtype">float</span> <a class="code" href="flash_2GLES_2glext_8h.html#a2532a9f8ed3a10a63f5e3c484fbfdb9b">y</a> )
<a name="l00922"></a>00922 {
<a name="l00923"></a>00923         <span class="keywordflow">return</span> (<span class="keywordtype">int</span>)(y*<a class="code" href="PlatformSetup_8cpp.html#a94a0deb0a111cc46d8f7285fd3f83838" title="Returns the same as GetScreenSizeY() but as a float.">GetScreenSizeYf</a>())/320.0<a class="code" href="Renderer_2GL_2glext_8h.html#aba8ad56949f59242bc167b073dae3715">f</a>; <span class="comment">//I cast to int because it helps with &quot;middle of the pixel&quot; jaggies</span>
<a name="l00924"></a>00924 }
<a name="l00925"></a>00925 
<a name="l00926"></a><a class="code" href="RenderUtils_8h.html#ab87487f19ea79f3a76b4eeb1c4e4f61f">00926</a> <span class="keywordtype">float</span> <a class="code" href="RenderUtils_8cpp.html#ab87487f19ea79f3a76b4eeb1c4e4f61f">iPhoneMapX</a>( <span class="keywordtype">float</span> <a class="code" href="flash_2GLES_2glext_8h.html#a0cdec8e97a75ee9458b23d152bf962d4">x</a> )
<a name="l00927"></a>00927 {
<a name="l00928"></a>00928         <span class="keywordflow">return</span> (<span class="keywordtype">int</span>)(x*<a class="code" href="PlatformSetup_8cpp.html#a3b38aaa65dfcae39c0700887f36f1521" title="Returns the same as GetScreenSizeX() but as a float.">GetScreenSizeXf</a>())/480.0<a class="code" href="Renderer_2GL_2glext_8h.html#aba8ad56949f59242bc167b073dae3715">f</a>;  <span class="comment">//I cast to int because it helps with &quot;middle of the pixel&quot; jaggies</span>
<a name="l00929"></a>00929 }
<a name="l00930"></a>00930 
<a name="l00931"></a><a class="code" href="RenderUtils_8h.html#a14da72bde7f56fabe4b9dd26829f2ded">00931</a> CL_Vec2f <a class="code" href="RenderUtils_8cpp.html#a14da72bde7f56fabe4b9dd26829f2ded">iPhoneMap</a>( CL_Vec2f vPos )
<a name="l00932"></a>00932 {
<a name="l00933"></a>00933         <span class="keywordflow">return</span> CL_Vec2f((<span class="keywordtype">float</span>)(<span class="keywordtype">int</span>) (vPos.x*<a class="code" href="PlatformSetup_8cpp.html#a3b38aaa65dfcae39c0700887f36f1521" title="Returns the same as GetScreenSizeX() but as a float.">GetScreenSizeXf</a>()/480.0<a class="code" href="Renderer_2GL_2glext_8h.html#aba8ad56949f59242bc167b073dae3715">f</a>), (<span class="keywordtype">float</span>)(<span class="keywordtype">int</span>) (vPos.y*<a class="code" href="PlatformSetup_8cpp.html#a94a0deb0a111cc46d8f7285fd3f83838" title="Returns the same as GetScreenSizeY() but as a float.">GetScreenSizeYf</a>()/320.0<a class="code" href="Renderer_2GL_2glext_8h.html#aba8ad56949f59242bc167b073dae3715">f</a>));
<a name="l00934"></a>00934 }
<a name="l00935"></a>00935 
<a name="l00936"></a>00936 
<a name="l00937"></a><a class="code" href="RenderUtils_8h.html#a99cd9e2db829c58d4f7c4b36ecfd7f1d">00937</a> CL_Vec2f <a class="code" href="RenderUtils_8cpp.html#a14da72bde7f56fabe4b9dd26829f2ded">iPhoneMap</a>( <span class="keywordtype">float</span> <a class="code" href="flash_2GLES_2glext_8h.html#a0cdec8e97a75ee9458b23d152bf962d4">x</a>, <span class="keywordtype">float</span> <a class="code" href="flash_2GLES_2glext_8h.html#a2532a9f8ed3a10a63f5e3c484fbfdb9b">y</a> )
<a name="l00938"></a>00938 {
<a name="l00939"></a>00939         <span class="keywordflow">return</span> CL_Vec2f((<span class="keywordtype">float</span>)(<span class="keywordtype">int</span>) (x*<a class="code" href="PlatformSetup_8cpp.html#a3b38aaa65dfcae39c0700887f36f1521" title="Returns the same as GetScreenSizeX() but as a float.">GetScreenSizeXf</a>()/480.0<a class="code" href="Renderer_2GL_2glext_8h.html#aba8ad56949f59242bc167b073dae3715">f</a>), (<span class="keywordtype">float</span>)(<span class="keywordtype">int</span>) (y*<a class="code" href="PlatformSetup_8cpp.html#a94a0deb0a111cc46d8f7285fd3f83838" title="Returns the same as GetScreenSizeY() but as a float.">GetScreenSizeYf</a>()/320.0<a class="code" href="Renderer_2GL_2glext_8h.html#aba8ad56949f59242bc167b073dae3715">f</a>));
<a name="l00940"></a>00940 }
<a name="l00941"></a>00941 
<a name="l00942"></a><a class="code" href="RenderUtils_8h.html#a047675f7dc02029c30bc06bc05bb8176">00942</a> <span class="keywordtype">float</span> <a class="code" href="RenderUtils_8cpp.html#a047675f7dc02029c30bc06bc05bb8176">iPadMapY</a>( <span class="keywordtype">float</span> <a class="code" href="flash_2GLES_2glext_8h.html#a2532a9f8ed3a10a63f5e3c484fbfdb9b">y</a> )
<a name="l00943"></a>00943 {
<a name="l00944"></a>00944         <span class="keywordflow">return</span> (<span class="keywordtype">float</span>)(int)(y*<a class="code" href="PlatformSetup_8cpp.html#a94a0deb0a111cc46d8f7285fd3f83838" title="Returns the same as GetScreenSizeY() but as a float.">GetScreenSizeYf</a>())/768.0<a class="code" href="Renderer_2GL_2glext_8h.html#aba8ad56949f59242bc167b073dae3715">f</a>; <span class="comment">//I cast to int because it helps with &quot;middle of the pixel&quot; jaggies</span>
<a name="l00945"></a>00945 }
<a name="l00946"></a>00946 
<a name="l00947"></a><a class="code" href="RenderUtils_8h.html#a000a149d02e65a82f43f8f4a7fa1413a">00947</a> <span class="keywordtype">float</span> <a class="code" href="RenderUtils_8cpp.html#a000a149d02e65a82f43f8f4a7fa1413a">iPadMapX</a>( <span class="keywordtype">float</span> <a class="code" href="flash_2GLES_2glext_8h.html#a0cdec8e97a75ee9458b23d152bf962d4">x</a> )
<a name="l00948"></a>00948 {
<a name="l00949"></a>00949         <span class="keywordflow">return</span>(<span class="keywordtype">float</span>) (int)(x*<a class="code" href="PlatformSetup_8cpp.html#a3b38aaa65dfcae39c0700887f36f1521" title="Returns the same as GetScreenSizeX() but as a float.">GetScreenSizeXf</a>())/1024.0<a class="code" href="Renderer_2GL_2glext_8h.html#aba8ad56949f59242bc167b073dae3715">f</a>;  <span class="comment">//I cast to int because it helps with &quot;middle of the pixel&quot; jaggies</span>
<a name="l00950"></a>00950 }
<a name="l00951"></a>00951 
<a name="l00952"></a><a class="code" href="RenderUtils_8h.html#a6c28c73ef71b5c93e4e06d7cd9d48878">00952</a> CL_Vec2f <a class="code" href="RenderUtils_8cpp.html#a6c28c73ef71b5c93e4e06d7cd9d48878">iPadMap</a>( CL_Vec2f vPos )
<a name="l00953"></a>00953 {
<a name="l00954"></a>00954         <span class="keywordflow">return</span> CL_Vec2f((<span class="keywordtype">float</span>)(<span class="keywordtype">int</span>) (vPos.x*<a class="code" href="PlatformSetup_8cpp.html#a3b38aaa65dfcae39c0700887f36f1521" title="Returns the same as GetScreenSizeX() but as a float.">GetScreenSizeXf</a>()/1024.0<a class="code" href="Renderer_2GL_2glext_8h.html#aba8ad56949f59242bc167b073dae3715">f</a>), (<span class="keywordtype">float</span>)(<span class="keywordtype">int</span>) (vPos.y*<a class="code" href="PlatformSetup_8cpp.html#a94a0deb0a111cc46d8f7285fd3f83838" title="Returns the same as GetScreenSizeY() but as a float.">GetScreenSizeYf</a>()/768.0<a class="code" href="Renderer_2GL_2glext_8h.html#aba8ad56949f59242bc167b073dae3715">f</a>));
<a name="l00955"></a>00955 }
<a name="l00956"></a>00956 
<a name="l00957"></a><a class="code" href="RenderUtils_8h.html#a45a63f04268ebda7900abe7207684758">00957</a> CL_Vec2f <a class="code" href="RenderUtils_8cpp.html#a6c28c73ef71b5c93e4e06d7cd9d48878">iPadMap</a>( <span class="keywordtype">float</span> <a class="code" href="flash_2GLES_2glext_8h.html#a0cdec8e97a75ee9458b23d152bf962d4">x</a>, <span class="keywordtype">float</span> <a class="code" href="flash_2GLES_2glext_8h.html#a2532a9f8ed3a10a63f5e3c484fbfdb9b">y</a> )
<a name="l00958"></a>00958 {
<a name="l00959"></a>00959         <span class="keywordflow">return</span> CL_Vec2f((<span class="keywordtype">float</span>)(<span class="keywordtype">int</span>) (x*<a class="code" href="PlatformSetup_8cpp.html#a3b38aaa65dfcae39c0700887f36f1521" title="Returns the same as GetScreenSizeX() but as a float.">GetScreenSizeXf</a>()/1024.0<a class="code" href="Renderer_2GL_2glext_8h.html#aba8ad56949f59242bc167b073dae3715">f</a>), (<span class="keywordtype">float</span>)(<span class="keywordtype">int</span>) (y*<a class="code" href="PlatformSetup_8cpp.html#a94a0deb0a111cc46d8f7285fd3f83838" title="Returns the same as GetScreenSizeY() but as a float.">GetScreenSizeYf</a>()/768.0<a class="code" href="Renderer_2GL_2glext_8h.html#aba8ad56949f59242bc167b073dae3715">f</a>));
<a name="l00960"></a>00960 }
<a name="l00961"></a>00961 
<a name="l00962"></a>00962 
<a name="l00963"></a><a class="code" href="RenderUtils_8h.html#aee8f17ea398fb64a0c69b6d7c1f6e785">00963</a> <span class="keywordtype">float</span> <a class="code" href="RenderUtils_8cpp.html#aee8f17ea398fb64a0c69b6d7c1f6e785">iPhoneMapX2X</a>( <span class="keywordtype">float</span> <a class="code" href="flash_2GLES_2glext_8h.html#a0cdec8e97a75ee9458b23d152bf962d4">x</a> )
<a name="l00964"></a>00964 {
<a name="l00965"></a>00965         <span class="keywordflow">if</span> (!<a class="code" href="main_8cpp.html#a6e3c1d3d5d78acd3bcb38a3970cd51b8">IsLargeScreen</a>()) <span class="keywordflow">return</span> <a class="code" href="flash_2GLES_2glext_8h.html#a0cdec8e97a75ee9458b23d152bf962d4">x</a>;
<a name="l00966"></a>00966         <span class="keywordflow">return</span> (<span class="keywordtype">float</span>)(int)(x*960)/480;
<a name="l00967"></a>00967 }
<a name="l00968"></a>00968 
<a name="l00969"></a>00969 
<a name="l00970"></a><a class="code" href="RenderUtils_8h.html#a96a57a7d76ee82c2e78a65b007edcf2f">00970</a> <span class="keywordtype">float</span> <a class="code" href="RenderUtils_8cpp.html#a96a57a7d76ee82c2e78a65b007edcf2f">iPhoneMapY2X</a>( <span class="keywordtype">float</span> <a class="code" href="flash_2GLES_2glext_8h.html#a2532a9f8ed3a10a63f5e3c484fbfdb9b">y</a> )
<a name="l00971"></a>00971 {
<a name="l00972"></a>00972         <span class="keywordflow">if</span> (!<a class="code" href="main_8cpp.html#a6e3c1d3d5d78acd3bcb38a3970cd51b8">IsLargeScreen</a>()) <span class="keywordflow">return</span> <a class="code" href="flash_2GLES_2glext_8h.html#a2532a9f8ed3a10a63f5e3c484fbfdb9b">y</a>;
<a name="l00973"></a>00973         <span class="keywordflow">return</span> (<span class="keywordtype">float</span>)(int)(y*649)/320;
<a name="l00974"></a>00974 }
<a name="l00975"></a>00975 
<a name="l00976"></a><a class="code" href="RenderUtils_8h.html#a9930b8b7035173eb5fd151d0dd0a915e">00976</a> CL_Vec2f <a class="code" href="RenderUtils_8cpp.html#a9930b8b7035173eb5fd151d0dd0a915e">iPhoneMap2X</a>( CL_Vec2f vPos )
<a name="l00977"></a>00977 {
<a name="l00978"></a>00978         <span class="keywordflow">if</span> (!<a class="code" href="main_8cpp.html#a6e3c1d3d5d78acd3bcb38a3970cd51b8">IsLargeScreen</a>()) <span class="keywordflow">return</span> vPos;
<a name="l00979"></a>00979         
<a name="l00980"></a>00980         <span class="keywordflow">return</span> CL_Vec2f((<span class="keywordtype">float</span>)(<span class="keywordtype">int</span>) (vPos.x*960/480), (<span class="keywordtype">float</span>)(<span class="keywordtype">int</span>) (vPos.y*640/320));
<a name="l00981"></a>00981 }
<a name="l00982"></a>00982 
<a name="l00983"></a><a class="code" href="RenderUtils_8h.html#ad6af72f05650f90a732322583c38c684">00983</a> CL_Vec2f <a class="code" href="RenderUtils_8cpp.html#a9930b8b7035173eb5fd151d0dd0a915e">iPhoneMap2X</a>( <span class="keywordtype">float</span> <a class="code" href="flash_2GLES_2glext_8h.html#a0cdec8e97a75ee9458b23d152bf962d4">x</a>, <span class="keywordtype">float</span> <a class="code" href="flash_2GLES_2glext_8h.html#a2532a9f8ed3a10a63f5e3c484fbfdb9b">y</a> )
<a name="l00984"></a>00984 {
<a name="l00985"></a>00985         <span class="keywordflow">if</span> (!<a class="code" href="main_8cpp.html#a6e3c1d3d5d78acd3bcb38a3970cd51b8">IsLargeScreen</a>()) <span class="keywordflow">return</span> CL_Vec2f(x, y);
<a name="l00986"></a>00986         <span class="keywordflow">return</span> CL_Vec2f((<span class="keywordtype">float</span>)(<span class="keywordtype">int</span>) (x*960/480), (<span class="keywordtype">float</span>)(<span class="keywordtype">int</span>) (y*640/320));
<a name="l00987"></a>00987 }
<a name="l00988"></a>00988 
<a name="l00989"></a>00989 <span class="comment">/*</span>
<a name="l00990"></a>00990 <span class="comment">rtRectf ConvertFakeScreenRectToReal(rtRectf r)</span>
<a name="l00991"></a>00991 <span class="comment">{</span>
<a name="l00992"></a>00992 <span class="comment">        if (GetFakePrimaryScreenSizeX() == 0) return r;</span>
<a name="l00993"></a>00993 <span class="comment"></span>
<a name="l00994"></a>00994 <span class="comment">        float ratioy = ((float)GetPrimaryGLY()/(float)GetFakePrimaryScreenSizeY());</span>
<a name="l00995"></a>00995 <span class="comment">        float ratiox = ((float)GetPrimaryGLX()/(float)GetFakePrimaryScreenSizeX());</span>
<a name="l00996"></a>00996 <span class="comment"></span>
<a name="l00997"></a>00997 <span class="comment">        float widthHold = r.GetWidth();</span>
<a name="l00998"></a>00998 <span class="comment">        float heightHold = r.GetHeight();</span>
<a name="l00999"></a>00999 <span class="comment"></span>
<a name="l01000"></a>01000 <span class="comment">        r.top *= ratioy;</span>
<a name="l01001"></a>01001 <span class="comment">        r.left *= ratiox;</span>
<a name="l01002"></a>01002 <span class="comment"></span>
<a name="l01003"></a>01003 <span class="comment">        r.right = widthHold*ratiox+r.left;</span>
<a name="l01004"></a>01004 <span class="comment">        r.bottom = heightHold*ratioy+r.top;</span>
<a name="l01005"></a>01005 <span class="comment"></span>
<a name="l01006"></a>01006 <span class="comment">        return r;</span>
<a name="l01007"></a>01007 <span class="comment">}</span>
<a name="l01008"></a>01008 <span class="comment">*/</span>
<a name="l01009"></a>01009 
<a name="l01010"></a>01010 <span class="comment">//old version.. looks wrong!</span>
<a name="l01011"></a>01011 
<a name="l01012"></a>01012 
<a name="l01013"></a>01013 
<a name="l01014"></a><a class="code" href="RenderUtils_8h.html#aa35d9d31116bfcb26e80e4a7a90ff555">01014</a> <a class="code" href="structrtRectf.html">rtRectf</a> <a class="code" href="RenderUtils_8cpp.html#aa35d9d31116bfcb26e80e4a7a90ff555">ConvertFakeScreenRectToReal</a>(<a class="code" href="structrtRectf.html">rtRectf</a> <a class="code" href="flash_2GLES_2glext_8h.html#abe08814c2f72843fde4d8df41440d5a0">r</a>)
<a name="l01015"></a>01015 {
<a name="l01016"></a>01016         <span class="keywordflow">if</span> (<a class="code" href="RenderUtils_8cpp.html#a83c3f5c13f3df84f49039f43f7aaad3c">GetFakePrimaryScreenSizeX</a>() == 0) <span class="keywordflow">return</span> <a class="code" href="flash_2GLES_2glext_8h.html#abe08814c2f72843fde4d8df41440d5a0">r</a>;
<a name="l01017"></a>01017 
<a name="l01018"></a>01018         <span class="keywordtype">float</span> primaryY = (float)<a class="code" href="AndroidUtils_8cpp.html#ac274a49195455502331eb617bce938e3">GetPrimaryGLY</a>();
<a name="l01019"></a>01019         <span class="keywordtype">float</span> primaryX = (float)<a class="code" href="AndroidUtils_8cpp.html#a2f0e58aac06a13b950cef03dcc3e7267">GetPrimaryGLX</a>();
<a name="l01020"></a>01020 
<a name="l01021"></a>01021         <span class="keywordtype">float</span> fakeX = (float)<a class="code" href="RenderUtils_8cpp.html#a83c3f5c13f3df84f49039f43f7aaad3c">GetFakePrimaryScreenSizeX</a>();
<a name="l01022"></a>01022         <span class="keywordtype">float</span> fakeY = (float)<a class="code" href="RenderUtils_8cpp.html#a5aa95ad79520615ad77c797f7adf8cf2">GetFakePrimaryScreenSizeY</a>();
<a name="l01023"></a>01023 
<a name="l01024"></a>01024         <span class="keywordflow">if</span>(<a class="code" href="BaseApp_8h.html#a72086b48d24daf0a65dd20189a16bd16">GetBaseApp</a>()-&gt;<a class="code" href="classBaseApp.html#afdba51e6f0f3b31990d7f15392a57ff5">GetManualRotationMode</a>() &amp;&amp; <a class="code" href="RenderUtils_8cpp.html#a034372040b8104c0b6536a2ed0dd46cc">InLandscapeGUIMode</a>())
<a name="l01025"></a>01025         {
<a name="l01026"></a>01026                 swap(primaryX , primaryY);
<a name="l01027"></a>01027         }
<a name="l01028"></a>01028         
<a name="l01029"></a>01029     <span class="keywordtype">float</span> ratiox = (primaryX/fakeX);
<a name="l01030"></a>01030         <span class="keywordtype">float</span> ratioy = (primaryY/fakeY);
<a name="l01031"></a>01031 
<a name="l01032"></a>01032         <span class="keywordtype">float</span> widthHold = r.<a class="code" href="structrtRectf.html#a0410aa65b3d292f46ca5b5df02a3087e">GetWidth</a>();
<a name="l01033"></a>01033         <span class="keywordtype">float</span> heightHold = r.<a class="code" href="structrtRectf.html#af5b496cf9927a066da3749ebb0c203b9">GetHeight</a>();
<a name="l01034"></a>01034 
<a name="l01035"></a>01035         r.<a class="code" href="structrtRectf.html#a9b3d0f8a066c23d58f29bf61d165f97a">top</a> *= ratioy;
<a name="l01036"></a>01036         r.<a class="code" href="structrtRectf.html#a567b9e4d9febb9bf7f338f416e94a688">left</a> *= ratiox;
<a name="l01037"></a>01037 
<a name="l01038"></a>01038         r.<a class="code" href="structrtRectf.html#a336746497039c6656a3120fc5870df94">right</a> = widthHold*ratiox+r.<a class="code" href="structrtRectf.html#a567b9e4d9febb9bf7f338f416e94a688">left</a>;
<a name="l01039"></a>01039         r.<a class="code" href="structrtRectf.html#a3e501be99ba737fa872ba2b2f46cbc22">bottom</a> = heightHold*ratioy+r.<a class="code" href="structrtRectf.html#a9b3d0f8a066c23d58f29bf61d165f97a">top</a>;
<a name="l01040"></a>01040 
<a name="l01041"></a>01041         <span class="keywordflow">return</span> <a class="code" href="flash_2GLES_2glext_8h.html#abe08814c2f72843fde4d8df41440d5a0">r</a>;
<a name="l01042"></a>01042 }
<a name="l01043"></a>01043 
<a name="l01044"></a>01044 <span class="comment">//a helper for calculating fadein/fadeout times</span>
<a name="l01045"></a>01045 
<a name="l01046"></a><a class="code" href="RenderUtils_8h.html#a5c6a5ce5d02498d928611a5786710092">01046</a> <span class="keywordtype">float</span> <a class="code" href="RenderUtils_8cpp.html#a5c6a5ce5d02498d928611a5786710092">GetFadeAlphaFromTime</a>(<span class="keywordtype">int</span> curTimeMS, <span class="keywordtype">int</span> totalTimeMS, <span class="keywordtype">int</span> fadeInMS, <span class="keywordtype">int</span> fadeOutMS)
<a name="l01047"></a>01047 {
<a name="l01048"></a>01048         <span class="comment">//LogMsg(&quot;GetFadeAlpha: curTime: %d, total %d&quot;, curTimeMS, totalTimeMS);</span>
<a name="l01049"></a>01049 
<a name="l01050"></a>01050         <span class="keywordflow">if</span> (curTimeMS &lt;= 0 || curTimeMS &gt;= totalTimeMS) <span class="keywordflow">return</span> 0;
<a name="l01051"></a>01051 
<a name="l01052"></a>01052         <span class="keywordflow">if</span> (curTimeMS &gt; totalTimeMS-fadeOutMS)
<a name="l01053"></a>01053         {
<a name="l01054"></a>01054                 <span class="keywordflow">return</span> 1.0f - ((float)( curTimeMS-(totalTimeMS-fadeOutMS))/(<span class="keywordtype">float</span>)fadeOutMS);
<a name="l01055"></a>01055         }
<a name="l01056"></a>01056 
<a name="l01057"></a>01057         <span class="keywordflow">if</span> (curTimeMS &lt; fadeInMS)
<a name="l01058"></a>01058         {
<a name="l01059"></a>01059                 <span class="keywordflow">return</span> (<span class="keywordtype">float</span>)curTimeMS/(float)fadeInMS;                
<a name="l01060"></a>01060         }
<a name="l01061"></a>01061 
<a name="l01062"></a>01062         <span class="keywordflow">return</span> 1;
<a name="l01063"></a>01063 }
<a name="l01064"></a>01064 
<a name="l01065"></a>01065 
</pre></div></div><!-- contents -->


<hr class="footer"/><address class="footer"><small>
Generated on Thu May 2 2013 17:17:12 for Proton by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
